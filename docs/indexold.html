<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<title>nfsu2-re</title>
<style>
body {
	font-family: Arial,Tahoma,sans-serif;
	background: #888;
}
table {
        border-collapse: collapse;
}
td,th {
	padding: .1em .4em;
	border: 1px solid #000;
}
th {
        background: #f5f5f5;
}
div, h1 {
	padding: 1em;
	border: 1px solid #efefef;
	outline: 1px solid #d0d0d0;
	max-width: 50em;
}
h1 {
	background:#C7C7C7;
}
h1,h2,h3,h4,h5,h6 {
        margin-top: 0.2em;
}
h2 a,h3 a,h4 a,h5 a,h6 a{
	color: #A0A0A0;
}
body > div {
	margin-bottom: 1em;
	background: #fff;
}
.center {
	text-align: center;
}
code {
	display: inline-block;
	background: #dfdfdf;
	padding: 2px .2em;
	margin: 0 .2em;
	border-radius: 2px;
}
pre {
	border:2px solid #CDCDCD;
	padding: 0.5em;
	white-space: pre-wrap;
	background: #f7f7f7;
}
pre.ida {
	color:#000080;
	font-weight: bold;
}
pre.ida span.text {
	color:#000;
}
pre.ida span.comment {
	color:#808080;
}
pre.ida span.ident {
	color:#0000FF;
}
pre.ida span.num,pre.ida span.str {
	color:#008000;
}
pre.ida span.hi {
	background:#FFFF00;
}
span.unresolved,a.funcref,a.fieldref {
        padding: 0 4px;
        border-radius: 3px;
        font-family: monospace;
}
span.unresolved {
        background: #ff5454;
}
a.funcref {
        background: #fdf;
}
a.funcref:hover {
        background: #f6f;
}
a.fieldref {
        background: #dfd;
}
a.fieldref:hover {
        background: #6f6;
}
span.func,span.field {
        display: block;
        padding: 2px 3px;
        font-family: monospace;
        font-weight: bold;
        margin: .5em 0;
}
span.func {
        background: #fdf;
        border: 1px solid #f6f;
}
span.field {
        background: #dfd;
        border: 1px solid #6f6;
}
details {
        padding: .2em .4em 0 .4em;
        margin: .5em 0;
        border: 1px solid #ccc;
        background: #eee;
}
summary {
        user-select: none;
        cursor: pointer;
}
</style>
</head>
<body>
<h1>nfsu2-re</h1>
<span id='prologue'></span><div><h2>Prologue <a href="#prologue">#</a></h2>
<p>This is just me documenting while I have fun attempting to reverse-engineer the game
Need For Speed Underground 2, otherwise knows as nfsu2.
</p><p>This normally belongs to <a href="https://github.com/yugecin/nfsu2-re">https://github.com/yugecin/nfsu2-re</a>.
</p><p>Other pages: <a href="cheatsheet.html">(fpu) cheatsheet</a>
</p><p style='margin-bottom:0'><a href='#index'>Index</a></p></div><span id='index'></span><div><h2>Index <a href="#index">#</a></h2>
<ul><li><a href="#prologue">Prologue</a></li><li><a href="#index">Index</a></li><li><a href="#injectedcode">Injected code</a></li><li><a href="#displaysettings">Display settings</a></li><li><a href="#registry">Registry</a></li><li><a href="#gameregion">Game region</a></li><li><a href="#bindata">Bin data</a></li><li><a href="#language">Language</a><ul><li><a href="#language_metadata">Language metadata</a></li><li><a href="#language_files">Language files</a></li></ul></li><li><a href="#pools">Pools</a></li><li><a href="#speedyboot">Speedy boot</a></li><li><a href="#consoleleftover">Console leftovers</a><ul><li><a href="#console_consume_key">ConsoleConsumeKey</a><ul><li><a href="#console_consume_key_check">A hardcoded key check</a></li></ul></li><li><a href="#console_move_caret">ConsoleMoveCaret</a></li></ul></li><li><a href="#hashfuncs">Hash functions</a><ul><li><a href="#hashmess">Messing with hash results</a></li></ul></li><li><a href="#debugprint">Debug print</a></li><li><a href="#ui">UI</a><ul><li><a href="#ui_dialog">Dialogs</a><ul><li><a href="#ui_dialog_getfngfordialog">GetFNGForDialog</a></li></ul></li><li><a href="#fngthings">FNG things</a></li><li><a href="#some_fng_screens">Some FNG screens</a><ul><li><a href="#replace_loading_screen">Replacing the loading screen</a></li></ul></li><li><a href="#screenprintf">ScreenPrintf.fng</a></li><li><a href="#pc_help_bar">PC help bar</a></li></ul></li><li><a href="#input">Input</a><ul><li><a href="#mouseinput">Mouse input</a></li><li><a href="#joyinput">Key (Joy) input</a></li></ul></li><li><a href="#cheats">Cheats</a></li><li><a href="#carmodeldata">Car model data</a></li><li><a href="#sound">Sound</a></li><li><a href="#career">Career</a><ul><li><a href="#markers">Markers</a></li><li><a href="#sms_stuff">SMS stuff</a></li></ul></li><li><a href="#networkstuff">LAN/OL</a></li><li><a href="#d3d9stuff">D3D9 Stuff</a></li><li><a href="#other_symbols">Other symbols</a></ul><p style='margin-bottom:0'><a href='#index'>Index</a></p></div><span id='injectedcode'></span><div><h2>Injected code <a href="#injectedcode">#</a></h2>
<p>The code for all injected things I did can be found in <code>nfsu2-re-hooks/*.c</code>.
It's configured as a VC2005 project in a VC2005 solution.
The project emits a compiled file to <code>..\NeedForSpeed U2\scripts\nfsu2-re-hooks.asi</code>.
I'm using the <a href="https://github.com/ThirteenAG/Ultimate-ASI-Loader/releases">Ultimate ASI Loader by ThirteenAG</a>,
which loads the library nicely for me (download the ZIP and place the dll in the game folder,
name it <code>dinput8.dll</code>).
</p><p style='margin-bottom:0'><a href='#index'>Index</a></p></div><span id='displaysettings'></span><div><h2>Display settings <a href="#displaysettings">#</a></h2>
<p>Display settings get saved in the windows registry. See <a href='#registry'>Registry</a>.
</p><p>TODO. I was writing this when I got distracted by the language stuff.
</p><p><strong>Symbols:</strong></p><ul><li><span class='func' id='5BE190'>5BE190 void StoreOptLightGlowSetToZero()</span>
<pre><a class='fieldref' href='#8709D4'>tempStoredOptLightGlow</a> = <a class='fieldref' href='#870CE4'>_optLightGlow</a>;
<a class='fieldref' href='#870CE4'>_optLightGlow</a> = 0;
</pre>  TODO why
</li><li><span class='func' id='5BE1B0'>5BE1B0 void RestoreOptLightGlow()</span>
<pre><a class='fieldref' href='#870CE4'>_optLightGlow</a> = <a class='fieldref' href='#8709D4'>tempStoredOptLightGlow</a>;
</pre>  TODO why
</li><li><span class='func' id='5BE1C0'>5BE1C0 int GetWorldDetailClampBetween0And2()</span>
<pre>return clamp(<a class='fieldref' href='#870CF4'>_optWorldDetail</a>, 0, 2);
</pre></li><li><span class='func' id='5BE560'>5BE560 int GetRealFilteringLevelForCurrentSetting()</span>
  Returns <code><a class='fieldref' href='#870D18'>_optTextureFiltering</a>+1</code> (<code>0-2 -&gt; 1-3</code>), but maxed to <code>2</code> if the device doesn't have
  <code>D3DDEVCAPS_RTPATCHES</code> support.
</li><li><span class='func' id='5BE200'>5BE200 void DetermineMaxDisplaySettingValuesForDevice()</span>
  Sets maximum values of various options based on the adapter info in <a class='fieldref' href='#86C120'>86C120:_d3d9AdapterIdentifier</a>.
  See all <code>_optMax*</code> fields.
  Also seems to do stuff with shaders maybe? TODO
  Called twice. TODO: where and why
</li><li><span class='func' id='5BE5A0'>5BE5A0 void DetermineSupportedResolutions()</span>
  Based on the device, for every resolution index,
  put <code>1</code> in <a class='fieldref' href='#86E880'>86E880:isSupportedResolutionIdx</a> at that index if available.
</li><li><span class='func' id='5BE690'>5BE690 void EnsureDisplayOptionsDontExceedMaxSettings()</span>
  For each option that has a maximum value field,
  set it to the maximum value if it was exceeded.
</li><li><span class='func' id='5BE870'>5BE870 void SetPresetDisplayLevelFromLevelOfDetail()</span>
</li><li><span class='func' id='5BE9F0'>5BE9F0 void SetPresetDisplayLevelFromLevelOfDetaulAndLimit()</span>
  Calls <a class='funcref' href='#5BE870'>5BE870:SetPresetDisplayLevelFromLevelOfDetail()</a>,
  sets <a class='fieldref' href='#870D08'>870D08:_optFSAALevel</a> to 0 for some specific windows version or if the device is from vendor
  <em>Advanced Micro Devices, Inc</em>, then calls <a class='funcref' href='#5BE690'>5BE690:EnsureDisplayOptionsDontExceedMaxSettings()</a>
</li><li><span class='field' id='800538'>800538 int _resolutionWidths[6]</span>
  Values <code>640, 800, 1024, 1280, 1280, 1600</code>
</li><li><span class='field' id='800550'>800550 int _resolutionHeights[6]</span>
  Values <code>480, 600, 768, 960, 1024, 1200</code>
</li><li><span class='field' id='86E880'>86E880 int isSupportedResolutionIdx[6]</span>
</li><li><span class='field' id='87099C'>87099C int _optLevelOfDetail</span>
</li><li><span class='field' id='8709D4'>8709D4 tempStoredOptLightGlow</span>
  Used as temporary store for <a class='funcref' href='#5BE190'>5BE190:StoreOptLightGlowSetToZero()</a> and <a class='funcref' href='#5BE1B0'>5BE1B0:RestoreOptLightGlow()</a>
</li><li><span class='field' id='870CB8'>870CB8 int _optCarReflectionUpdateRate</span>
</li><li><span class='field' id='870CBC'>870CBC int _optCarReflectionDetail</span>
</li><li><span class='field' id='870CC0'>870CC0 int _optCarShadowNeon</span>
</li><li><span class='field' id='870CC4'>870CC4 int _optCarHeadlight</span>
</li><li><span class='field' id='870CC8'>870CC8 int _optCarLightingEnableUNUSED</span>
  Seemingly unused.
</li><li><span class='field' id='870CCC'>870CCC int _optCarDamageEnableUNUSED</span>
  Seemingly unused.
</li><li><span class='field' id='870CD0'>870CD0 int _optCrowds</span>
</li><li><span class='field' id='870CD4'>870CD4 int _optWorldReflectionDetail</span>
</li><li><span class='field' id='870CD8'>870CD8 int _optFog</span>
</li><li><span class='field' id='870CDC'>870CDC int _optMotionBlur</span>
</li><li><span class='field' id='870CE0'>870CE0 int _optLightTrails</span>
</li><li><span class='field' id='870CE4'>870CE4 int _optLightGlow</span>
</li><li><span class='field' id='870CE8'>870CE8 int _optAnimatedTextureEnable</span>
  Doesn't seem to be in the display menu, or it's hidden due to my system config.
</li><li><span class='field' id='870CEC'>870CEC int _optParticleSystem</span>
</li><li><span class='field' id='870CF0'>870CF0 int _optDepthOfField</span>
</li><li><span class='field' id='870CF4'>870CF4 int _optWorldDetail</span>
</li><li><span class='field' id='870CF8'>870CF8 int _optCarGeometryDetail</span>
</li><li><span class='field' id='870CFC'>870CFC int _optOverBright</span>
</li><li><span class='field' id='870D00'>870D00 int _optEnchancedContrast</span>
</li><li><span class='field' id='870D04'>870D04 int _optTinting</span>
</li><li><span class='field' id='870D08'>870D08 int _optFSAALevel</span>
</li><li><span class='field' id='870D0C'>870D0C int _optHorizonFog</span>
</li><li><span class='field' id='870D10'>870D10 int _optRainSplatter</span>
</li><li><span class='field' id='870D18'>870D18 int _optTextureFiltering</span>
</li><li><span class='field' id='870D1C'>870D1C int _optRacingResolutionIdx</span>
  To be used for arrays <a class='fieldref' href='#800538'>800538:_resolutionWidths</a>,<a class='fieldref' href='#800550'>800550:_resolutionHeights</a> and <a class='fieldref' href='#86E880'>86E880:isSupportedResolutionIdx</a>.
</li><li><span class='field' id='870D24'>870D24 int _optVsync</span>
</li><li><span class='field' id='8764D0'>8764D0 int _optMaxSettingCarReflectionUpdateRate</span>
</li><li><span class='field' id='8764D4'>8764D4 int _optMaxSettingCarReflectionDetail</span>
</li><li><span class='field' id='8764D8'>8764D8 int _optMaxSettingCarShadowNeon</span>
</li><li><span class='field' id='8764DC'>8764DC int _optMaxSettingCarHeadlight</span>
</li><li><span class='field' id='8764E0'>8764E0 int _optMaxSettingCarLightingEnable</span>
</li><li><span class='field' id='8764E4'>8764E4 int _optMaxSettingCarDamageEnable</span>
</li><li><span class='field' id='8764E8'>8764E8 int _optMaxSettingCrowds</span>
</li><li><span class='field' id='8764EC'>8764EC int _optMaxSettingWorldReflectionDetail</span>
</li><li><span class='field' id='8764F0'>8764F0 int _optMaxSettingFog</span>
</li><li><span class='field' id='8764F4'>8764F4 int _optMaxSettingMotionBlur</span>
</li><li><span class='field' id='8764F8'>8764F8 int _optMaxSettingLightTrails</span>
</li><li><span class='field' id='8764FC'>8764FC int _optMaxSettingLightGlow</span>
</li><li><span class='field' id='876500'>876500 int _optMaxSettingAnimatedTextureEnable</span>
</li><li><span class='field' id='876504'>876504 int _optMaxSettingParticleSystem</span>
</li><li><span class='field' id='876508'>876508 int _optMaxSettingDepthOfField</span>
</li><li><span class='field' id='87650C'>87650C int _optMaxSettingWorldDetail</span>
</li><li><span class='field' id='876510'>876510 int _optMaxSettingCarGeometryDetail</span>
</li><li><span class='field' id='876514'>876514 int _optMaxSettingOverBright</span>
</li><li><span class='field' id='876518'>876518 int _optMaxSettingEnchancedContrast</span>
</li><li><span class='field' id='876520'>876520 int _optMaxSettingFSAALevel</span>
</li><li><span class='field' id='876524'>876524 int _optMaxSettingHorizonFog</span>
</li><li><span class='field' id='876528'>876528 int _optMaxSettingRainSplatter</span>
</li><li><span class='field' id='876530'>876530 int _optMaxSettingTextureFiltering</span>
</li></ul><p style='margin-bottom:0'><a href='#index'>Index</a></p></div><span id='registry'></span><div><h2>Registry <a href="#registry">#</a></h2>
<p>Many values (mainly display settings) are loaded/saved in procs <a class='funcref' href='#5BEA20'>5BEA20:LoadDisplaySettings()</a> and <a class='funcref' href='#5BEEA0'>5BEEA0:SaveDisplaySettings()</a>.
</p><p>They are saved in key <code>Software\EA Games\Need for Speed Underground 2</code> in <code>HKEY_CURRENT_USER</code>.
On my machine this translates to:
<code>HKEY_CURRENT_USER\Software\Classes\VirtualStore\MACHINE\SOFTWARE\Wow6432Node\EA
Games\Need for Speed Underground 2</code>.
I'm guessing the extra path in between is because of WOW64.
</p><p>Variables loaded from there:
</p><table>
<thead><tr><th>Variable</th><th>Key</th></tr></thead>
<tbody>
<tr><td><a class='fieldref' href='#870CB0'>870CB0:VERSION</a></td>     <td><code>VERSION</code></td></tr>
<tr><td><a class='fieldref' href='#870CB4'>870CB4:SIZE</a></td>     <td><code>SIZE</code></td></tr>
<tr><td><a class='fieldref' href='#870CB8'>870CB8:_optCarReflectionUpdateRate</a></td>     <td><code>g_CarEnvironmentMapEnable</code></td></tr>
<tr><td><a class='fieldref' href='#870CBC'>870CBC:_optCarReflectionDetail</a></td>     <td><code>g_CarEnvironmentMapUpdateData</code></td></tr>
<tr><td><a class='fieldref' href='#870CC0'>870CC0:_optCarShadowNeon</a></td>     <td><code>g_CarShadowEnable</code></td></tr>
<tr><td><a class='fieldref' href='#870CC4'>870CC4:_optCarHeadlight</a></td>     <td><code>g_CarHeadlightEnable</code></td></tr>
<tr><td><a class='fieldref' href='#870CC8'>870CC8:_optCarLightingEnableUNUSED</a></td>     <td><code>g_CarLightingEnable</code></td></tr>
<tr><td><a class='fieldref' href='#870CCC'>870CCC:_optCarDamageEnableUNUSED</a></td>     <td><code>g_CarDamageEnable</code></td></tr>
<tr><td><a class='fieldref' href='#870CD0'>870CD0:_optCrowds</a></td>     <td><code>g_CrowdEnable</code></td></tr>
<tr><td><a class='fieldref' href='#870CD4'>870CD4:_optWorldReflectionDetail</a></td>     <td><code>g_RoadReflectionEnable</code></td></tr>
<tr><td><a class='fieldref' href='#870CD8'>870CD8:_optFog</a></td>     <td><code>g_FogEnable</code></td></tr>
<tr><td><a class='fieldref' href='#870CDC'>870CDC:_optMotionBlur</a></td>     <td><code>g_MotionBlurEnable</code></td></tr>
<tr><td><a class='fieldref' href='#870CE0'>870CE0:_optLightTrails</a></td>     <td><code>g_LightStreaksEnable</code></td></tr>
<tr><td><a class='fieldref' href='#870CE4'>870CE4:_optLightGlow</a></td>     <td><code>g_LightGlowEnable</code></td></tr>
<tr><td><a class='fieldref' href='#870CE8'>870CE8:_optAnimatedTextureEnable</a></td>     <td><code>g_AnimatedTextureEnable</code></td></tr>
<tr><td><a class='fieldref' href='#870CEC'>870CEC:_optParticleSystem</a></td>     <td><code>g_ParticleSystemEnable</code></td></tr>
<tr><td><a class='fieldref' href='#870CF0'>870CF0:_optDepthOfField</a></td>     <td><code>g_DepthOfFieldEnable</code></td></tr>
<tr><td><a class='fieldref' href='#870CF4'>870CF4:_optWorldDetail</a></td>     <td><code>g_WorldLodLevel</code></td></tr>
<tr><td><a class='fieldref' href='#870CF8'>870CF8:_optCarGeometryDetail</a></td>     <td><code>g_CarLodLevel</code></td></tr>
<tr><td><a class='fieldref' href='#870CFC'>870CFC:_optOverBright</a></td>     <td><code>g_OverBrightEnable</code></td></tr>
<tr><td><a class='fieldref' href='#870D00'>870D00:_optEnchancedContrast</a></td>     <td><code>g_BleachByPassEnable</code></td></tr>
<tr><td><a class='fieldref' href='#870D04'>870D04:_optTinting</a></td>     <td><code>g_TintingEnable</code></td></tr>
<tr><td><a class='fieldref' href='#870D08'>870D08:_optFSAALevel</a></td>     <td><code>g_FSAALevel</code></td></tr>
<tr><td><a class='fieldref' href='#870D0C'>870D0C:_optHorizonFog</a></td>     <td><code>g_HorizonFogEnable</code></td></tr>
<tr><td><a class='fieldref' href='#870D10'>870D10:_optRainSplatter</a></td>     <td><code>g_RainEnable</code></td></tr>
<tr><td><a class='fieldref' href='#870D18'>870D18:_optTextureFiltering</a></td>     <td><code>g_TextureFiltering</code></td></tr>
<tr><td><a class='fieldref' href='#870D1C'>870D1C:_optRacingResolutionIdx</a></td>     <td><code>g_RacingResolution</code></td></tr>
<tr><td><a class='fieldref' href='#87099C'>87099C:_optLevelOfDetail</a></td>     <td><code>g_PerformanceLevel</code></td></tr>
<tr><td><a class='fieldref' href='#870D24'>870D24:_optVsync</a></td>     <td><code>g_VSyncOn</code></td></tr>
</tbody>
</table>
<p><a class='funcref' href='#5B76F0'>5B76F0:LoadOtherRegistrySettings()</a> also loads registry settings, but only once at boot.
It seems to load a special key that I haven't seen before:
<code>Software\Electronic Arts\EA Games\Need for Speed Underground 2\er</code>. This key
is not present on my system, so this seems interesting.
</p><pre>HKEY key;
DWORD type, lenData;
if (RegOpenKeyExA(HKEY_LOCAL_MACHINE, "Software\\E...2\\er", 0, KEY_READ, &amp;key)) {
	type = REG_SZ; // a null-terminated string
	lenData = 21;
	if (RegQueryValueExA(key, 0, 0, &amp;type, &amp;<a class='fieldref' href='#86FF8C'>someRegValue_er</a>, &amp;lenData)) {
		<a class='fieldref' href='#86FF8C'>someRegValue_er</a>[20] = 0;
	} else {
		<a class='fieldref' href='#86FF8C'>someRegValue_er</a>[0] = 0;
	}
}
RegCloseKey(&amp;key);
</pre><p>Then it loads more stuff from the normal key:
</p><p><code>Install Dir</code> is read. If set, passed to (winapi) <code>GetLongPathNameA</code>.
and if that succeeds, the value is copied to buffer at <a class='fieldref' href='#86E9B4'>86E9B4:installDirPath</a>.
</p><p><code>CD Drive</code> is read. If set, passed to (winapi) <code>GetLongPathNameA</code>.
passed to (winapi) <code>GetLastError</code> and if that succeeds, the value is copied to <a class='fieldref' href='#86E8B0'>86E8B0:CDDrivePath</a>.
</p><p><code>NotFirstTime</code> is read. If set, <a class='fieldref' href='#870D20'>870D20:notFirstTime</a> gets set to 1, otherwise 0.
It doesn't check the value in the register key. Then 1 is written to the register key.
</p><p><code>CacheSize</code> is read. If set, <a class='funcref' href='#75D65B'>75D65B:sub_75D65B</a> is called with the value. TODO
</p><p><code>SwapSize</code> is read. If set, proc at <a class='funcref' href='#75D65B'>75D65B:sub_75D65B</a> is called with the value. TODO
</p><p><code>Language</code> is read. Then it does something with looping through a language.
This took some deciphering but I found out that there is some struct with language
information and associated data. See <a href='#language_metadata'>Language metadata</a>.
</p><p><code>StreamingInstall</code> is read. Then something with <a class='funcref' href='#75DD6F'>75DD6F:sub_75DD6F</a>. TODO
</p><p><strong>Symbols:</strong></p><ul><li><span class='func' id='5B76F0'>5B76F0 void LoadOtherRegistrySettings()</span>
  Called once during boot, from <a class='funcref' href='#5B7A70'>5B7A70:LoadPaths()</a>
</li><li><span class='func' id='5BEA20'>5BEA20 void LoadDisplaySettings()</span>
  Loads display settings from windows registry into their variables.
  Only called once, at boot.
</li><li><span class='func' id='5BEEA0'>5BEEA0 void SaveDisplaySettings()</span>
  Stores display settings into windows registry.
  Called multiple times, TODO.
</li><li><span class='field' id='86E8B0'>86E8B0 char CDDrivePath[4]</span>
</li><li><span class='field' id='86E9B4'>86E9B4 char installDirPath[260]</span>
</li><li><span class='field' id='86FF8C'>86FF8C char someRegValue_er[20]</span>
</li><li><span class='field' id='870CB0'>870CB0 char *VERSION</span>
</li><li><span class='field' id='870CB4'>870CB4 char *SIZE</span>
</li><li><span class='field' id='870D20'>870D20 int notFirstTime</span>
</li></ul><p style='margin-bottom:0'><a href='#index'>Index</a></p></div><span id='gameregion'></span><div><h2>Game region <a href="#gameregion">#</a></h2>
<p>List by <a class='funcref' href='#571380'>571380:GetCountryCode()</a>:
</p><ul><li>region 0: US
</li><li>region 2: Korea
</li><li>region 3: Japan
</li><li>region 4: Taiwan
</li><li>region 1,5,6,7,8,9:
<ul></li><li>language 0: UK
</li><li>language 1: France
</li><li>language 2: Germany
</li><li>language 3: Italy
</li><li>language 4: Spain
</li><li>language 5: Netherlands
</li><li>language 6: Sweden
</li><li>language 7: Denmark
</li></ul><li>region 11: China
</li><li>region 12: Thailand
</li></ul><p>List by <a class='funcref' href='#5B7C40'>5B7C40:OpenPatchesWebsite()</a>:
<ul><li>0: US
</li><li>2: Korea
</li><li>3: Japan
</li><li>4: Taiwan
</li><li>5: UK/Netherlands/Sweden/Denmark
</li><li>6: France
</li><li>7: Germany
</li><li>8: Italy
</li><li>9: Spain
</li><li>11: China
</li><li>12: Thailand
</li></ul></p><p>Then some network region stuff at 7FA740 showed a 14th entry:
<ul><li>13: South America
</li></ul></p><p><strong>Symbols:</strong></p><ul><li><span class='func' id='570A30'>570A30 int GetGameRegion()</span>
  <code>return <a class='fieldref' href='#864F24'>_gameRegion</a>;</code>
</li><li><span class='func' id='570A40'>570A40 int UseCarUKNames()</span>
  <code>return <a class='fieldref' href='#864F24'>_gameRegion</a> == 1 || (4 &lt; <a class='fieldref' href='#864F24'>_gameRegion</a> &amp;&amp; <a class='fieldref' href='#864F24'>_gameRegion</a> &lt; 10);</code>
  Unsure about this name.
</li><li><span class='func' id='571380'>571380 char *GetCountryCode()</span>
</li><li><span class='func' id='5B7C40'>5B7C40 int OpenPatchesWebsite()</span>
No idea where this is used, TODO
<pre>int OpenPatchesWebsite()
{
	char *url;

	switch (GetGameRegion()) {
	case 0: url = "http://patches.ea.com/nfs_underground2/EN-US/home.html"; break;
	case 2: url = "http://patches.ea.com/nfs_underground2/KO/home.html"; break;
	case 3: url = "http://patches.ea.com/nfs_underground2/JP/home.html"; break;
	case 4: url = "http://patches.ea.com/nfs_underground2/TW/home.html"; break;
	case 5:
		switch (GetCurrentLoadedLanguage()) {
		case 0: url = "http://patches.ea.com/nfs_underground2/EN-UK/home.html"; break;
		case 5: url = "http://patches.ea.com/nfs_underground2/NL/home.html"; break;
		case 6: url = "http://patches.ea.com/nfs_underground2/SV/home.html"; break;
		case 7: url = "http://patches.ea.com/nfs_underground2/DA/home.html"; break;
		default: goto def;
		}
		break;
	case 6: url = "http://patches.ea.com/nfs_underground2/FR/home.html"; break;
	case 7: url = "http://patches.ea.com/nfs_underground2/DE/home.html"; break;
	case 8: url = "http://patches.ea.com/nfs_underground2/IT/home.html"; break;
	case 9: url = "http://patches.ea.com/nfs_underground2/ES/home.html"; break;
	case 11: url = "http://patches.ea.com/nfs_underground2/ZH/home.html"; break;
	case 12: url = "http://patches.ea.com/nfs_underground2/TH/home.html"; break;
def:
	default: /*eax??*/ break;
	}
	return ShellExecuteA(NULL, "open", url, NULL, NULL, SW_SHOWNORMAL);
}
</pre></li><li><span class='field' id='864F24'>864F24 int _gameRegion</span>
</li></ul><p style='margin-bottom:0'><a href='#index'>Index</a></p></div><span id='bindata'></span><div><h2>Bin data <a href="#bindata">#</a></h2>
<p>Lots of data is in <code>.bin</code> files. These files can contain multiple <a href='#struct_BinSection'>struct BinSection</a> entries.
</p><pre><span id='struct_BinSectionHeader'></span>struct BinSectionHeader {
        int <span id='structBinSectionHeader_0'></span>magic;
        int <span id='structBinSectionHeader_4'></span>size;
};

<span id='struct_BinSection'></span>struct BinSection {
        <a href='#struct_BinSectionHeader'>struct BinSectionHeader</a> <span id='structBinSection_0'></span>header;
        char <span id='structBinSection_8'></span>data[<a href='#structBinSectionHeader_4'>size</a>];
};

<span id='struct_BinSectionHandler'></span>struct BinSectionHandler {
        int <span id='structBinSectionHandler_0'></span>magic;
        int (*<span id='structBinSectionHandler_4'></span>loadfunc)(<a href='#struct_BinSection'>struct BinSection</a>*));
        int (*<span id='structBinSectionHandler_8'></span>unloadfunc)(<a href='#struct_BinSection'>struct BinSection</a>*));
};

<span id='struct_BinSectionMagicMapEntry'></span>struct BinSectionMagicMapEntry {
        <a href='#struct_BinSectionMagicMapEntry'>struct BinSectionMagicMapEntry</a> *<span id='structBinSectionMagicMapEntry_0'></span>nextEntry;
        <a href='#struct_BinSectionHandler'>struct BinSectionHandler</a> <span id='structBinSectionMagicMapEntry_4'></span>value;
};
</pre><p>These are all the sections that are in the <code>LANGUAGES/English.bin</code> file:
</p><pre>offset 00000: section 00039000 size 3D230
offset 3D238: section 00000000 size 40
offset 3D280: section 00030201 size FF0
offset 3E278: section 00000000 size 0
offset 3E280: section 00030201 size 1270
offset 3F4F8: section 00000000 size 0
offset 3F500: section 00030201 size 370
offset 3F878: section 00000000 size 0
offset 3F880: section 00030201 size 1070
offset 408F8: section 00000000 size 0
offset 40900: section 00030201 size A70
offset 41378: section 00000000 size 0
offset 41380: section 00030201 size CF0
</pre><p>This is output by an early version of <code><a href='https://github.com/yugecin/nfsu2-re/blob/master/nfsu2-re-binfiles/main.c'>nfsu2-re-binfiles/main.c</a></code>.
</p><p>Note that the offset also increments by 8, being <code>sizeof <a href='#struct_BinSectionHeader'>struct BinSectionHeader</a></code>.
</p><p>Section magic <code>0</code> seems to be just for padding/alignment uses.
</p><p><strong>Symbols:</strong></p><ul><li><span class='func' id='43C0B0'>43C0B0 void __thiscall RegisterBinSectionHandler(<a href='#struct_BinSectionHandler'>struct BinSectionHandler</a> *this,
                                <a href='#struct_BinSectionHandler'>struct BinSectionHandler</a> handler)</span>
<pre>int magic, index;

magic = handler.<a href='#structBinSectionHandler_0'>magic</a>;
index = 0x3F &amp; ((magic &gt;&gt; 0x6) + (magic + (magic &gt;&gt; 0xC)));
this-&gt;<a href='#structBinSectionMagicMapEntry_4'>value</a> = handler;
this-&gt;<a href='#structBinSectionMagicMapEntry_0'>nextEntry</a> = <a class='fieldref' href='#828050'>binSectionMagicMap</a>[index];
<a class='fieldref' href='#828050'>binSectionMagicMap</a>[index] = this;
<a class='fieldref' href='#827FE8'>numBinSectionLoadFunctionsInMagicMapBucket</a>++;
</pre></li><li><span class='func' id='408200'>408200 int LoadBinSection34B00(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='408220'>408220 int UnloadBinSection34B00(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='40A460'>40A460 int LoadBinSection3A000(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='40A4A0'>40A4A0 int UnloadBinSection3A000(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='431870'>431870 int LoadBinSection80037050(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='4318D0'>4318D0 int UnloadBinSection80037050(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='432080'>432080 int LoadBinSection37140(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='4320C0'>4320C0 int UnloadBinSection37140(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='4325C0'>4325C0 int UnloadBinSection80037020(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='4348F0'>4348F0 int LoadBinSection0E34010(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
  Uses <code>Anim_CNFSAnimBank_SlotPool</code>
</li><li><span class='func' id='4349A0'>4349A0 int UnloadBinSection0E34010(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='434E10'>434E10 int LoadBinSection0E34009(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
  Uses <code>Anim_CAnimSkeleton_SlotPool</code>
</li><li><span class='func' id='435A50'>435A50 int UnloadBinSection37110(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='435A90'>435A90 int LoadBinSection37080(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='4365B0'>4365B0 int UnloadBinSection0E34009(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='4377F0'>4377F0 int LoadBinSection80037020(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='4381B0'>4381B0 int LoadBinSection37100(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='438720'>438720 int UnloadBinSection37150(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='438C20'>438C20 int UnloadBinSection37080(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='438C60'>438C60 int UnloadBinSection37090(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='439D70'>439D70 int UnloadBinSection37100(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='43A1F0'>43A1F0 int LoadBinSection37150(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='43A260'>43A260 int LoadBinSection37110(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='43A460'>43A460 int LoadBinSection37090(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='43C0A0'>43C0A0 int LoadUnloadBinSection0(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
  Nop handler that returns 1 if <code>binsection-&gt;<a href='#structBinSection_0'>header</a></code> is 0.
</li><li><span class='func' id='43C100'>43C100 <a href='#struct_BinSectionMagicMapEntry'>struct BinSectionMagicMapEntry</a> *FindBinSectionHandler(int magic)</span>
  Used in <a class='funcref' href='#570D70'>570D70:LoadBinSection()</a> and <a class='funcref' href='#577B10'>577B10:UnloadBinSection()</a>.
<pre><a href='#struct_BinSectionMagicMapEntry'>struct BinSectionMagicMapEntry</a> *entry;
int index;

index = 0x3F &amp; ((magic &gt;&gt; 0x6) + (magic + (magic &gt;&gt; 0xC)));
entry = <a class='fieldref' href='#828050'>binSectionMagicMap</a>[index];
while (entry) {
        if (entry-&gt;<a href='#structBinSectionMagicMapEntry_4'>value</a>.<a href='#structBinSectionHandler_0'>magic</a> == magic) {
                return entry;
        }
        entry = entry-&gt;<a href='#structBinSectionMagicMapEntry_0'>nextEntry</a>;
}
return NULL;
</pre></li><li><span class='func' id='44AB60'>44AB60 int LoadBinSection8003B200_8003B201_8003B202(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='452E90'>452E90 int UnloadBinSection8003B200_8003B201_8003B202(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='47BC30'>47BC30 int LoadBinSection8003B500(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='482D20'>482D20 int UnloadBinSection8003B500(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
  Does a function call on <a class='fieldref' href='#82B884'>82B884:pSoundEffectSystem?</a>.
</li><li><span class='func' id='48A280'>48A280 int LoadBinSection3B700(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='48A2B0'>48A2B0 int UnloadBinSection3B700(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='48B4A0'>48B4A0 int LoadBinSection34202(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='48B740'>48B740 int UnloadBinSection34202(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='48E070'>48E070 int LoadBinSection135200_80135100_80135000(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='48E270'>48E270 int UnloadBinSection135200_80135100_80135000(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='491C70'>491C70 int LoadBinSection80035000_80035010_35021_35020(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='491D50'>491D50 int UnloadBinSection80035000_80035010_35021_35020(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='494060'>494060 int LoadBinSection80134000(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='4940E0'>4940E0 int UnloadBinSection80134000(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='494EA0'>494EA0 int LoadBinSectionB3300000_B332000_B0300100(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='495040'>495040 int UnloadBinSectionB3300000_B332000_B0300100(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='500290'>500290 int UnloadBinSection80034A10(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='5108A0'>5108A0 int LoadBinSection30230(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='5108C0'>5108C0 int UnloadBinSection30230(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='5108E0'>5108E0 int LoadBinSection30231(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='510900'>510900 int UnloadBinSection30231(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='512C00'>512C00 int LoadBinSection80034A10(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
  This gets loaded once (enforced by <a class='fieldref' href='#8641F4'>8641F4:binSection80034A10loaded</a>), data resides in <code>GLOBAL/GLOBALB.BUN</code>.
  Career/Sponsor/DVD/Magazines related. The data in this section is more sections, with magic
  <code>0x34A11-0x34A1F</code> (excluding <code>0x34A13</code>),
</li><li><span class='func' id='51BD30'>51BD30 int LoadBinSection30203_30210(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
  Loads FNG packages?
</li><li><span class='func' id='51C610'>51C610 int UnloadBinSection39020(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='52CD90'>52CD90 int LoadBinSection39020(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='5425A0'>5425A0 int UnloadBinSection30203_30210(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
  Unloads FNG packages?
</li><li><span class='func' id='56C4C0'>56C4C0 int LoadBinSection34A07(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='56C4E0'>56C4E0 int UnloadBinSection34A07(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='570D70'>570D70 int LoadBinSection(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
  Only called from <a class='funcref' href='#577AB0'>577AB0:sub_577AB0</a>.
<pre><a href='#struct_BinSectionMagicMapEntry'>struct BinSectionMagicMapEntry</a> *entry;
int i;

entry = <a class='funcref' href='#43C100'>FindBinSectionHandler</a>(binsection-&gt;<a href='#structBinSection_0'>header</a>.<a href='#structBinSectionHeader_0'>magic</a>);
if (entry) {
        return entry-&gt;<a href='#structBinSectionMagicMapEntry_4'>value</a>.<a href='#structBinSectionHandler_4'>loadfunc</a>(binsection);
}
for (i = 0; i &lt; 36; i++) {
        if (<a class='fieldref' href='#7FA858'>binSectionLoadFuncs</a>[i](binsection)) {
                return 1;
        }
}
return 0;
</pre>  Returns 1 when something managed to load it.
  Some loaders that are in the map are also in the array.
</li><li><span class='func' id='577B10'>577B10 void UnloadBinSection(void *arg1, void *arg2)</span>
  Does things and calls the bin section unload handler, similar to <a class='funcref' href='#570D70'>570D70:LoadBinSection()</a>.
</li><li><span class='func' id='579340'>579340 int LoadBinSection39100_39101_39102(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='579350'>579350 int UnloadBinSection39100_39101_39102(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='57A470'>57A470 int LoadBinSection8003B000(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='57BCE0'>57BCE0 int UnloadBinSection8003B000(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='599440'>599440 int LoadBinSection80034A30(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='5994D0'>5994D0 int UnloadBinSection80034A30(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='5A1750'>5A1750 int LoadBinSection80034020(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='5A1860'>5A1860 int UnloadBinSection80034020(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='5A8BD0'>5A8BD0 int UnloadBinSection34026_34027(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='5B0E30'>5B0E30 int LoadBinSection34026_34027(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='5D3EB0'>5D3EB0 int LoadBinSection34201(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='5D3EF0'>5D3EF0 int UnloadBinSection34201(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='5D6440'>5D6440 int UnloadBinSection34108(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='5D8470'>5D8470 int LoadBinSection34146(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='5D84D0'>5D84D0 int UnoadBinSection34146(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='5DA490'>5DA490 int LoadBinSection80034147(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='5DB2E0'>5DB2E0 int LoadBinSection34108(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='5DB5A0'>5DB5A0 int UnloadBinSection80034150(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='5DBF60'>5DBF60 int LoadBinSection80036000(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='5DC050'>5DC050 int UnloadBinSection80036000(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='5DEB80'>5DEB80 int LoadBinSection34121_34122_34123_34124(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='5DEE00'>5DEE00 int UnloadBinSection80034147(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='5DEF30'>5DEF30 int LoadBinSection_34110_34111_34112_34113(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='5DF8A0'>5DF8A0 int LoadBinSection80034100_34107(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='5DFBA0'>5DFBA0 int UnloadBinSection80034100_34107(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='5E0190'>5E0190 int LoadBinSection34250(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='5E0220'>5E0220 int UnloadBinSection34250(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='5E4820'>5E4820 int UnloadBinSection34121_34122_34123_34124(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='5E4E60'>5E4E60 int UnloadBinSection_34110_34111_34112_34113(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='5E81C0'>5E81C0 int LoadBinSection80034130_3412F(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
  Called when exiting to main menu after being in race/freeroam.
</li><li><span class='func' id='5E8660'>5E8660 int UnloadBinSection80034130_3412F(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='5E9C10'>5E9C10 int LoadBinSection80034150_thiscall(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='5EA0F0'>5EA0F0 int LoadBinSection80034150(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='60B810'>60B810 int LoadBinSection8003B600(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='60BAC0'>60BAC0 int UnloadBinSection8003B600(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='61B460'>61B460 int UnloadBinSection34600_34601_80034602(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='61C3C0'>61C3C0 int LoadBinSection30220(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='61C420'>61C420 int UnloadBinSection30220(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='61CB50'>61CB50 int LoadBinSection34030(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='61CB90'>61CB90 int UnloadBinSection34030(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='636BE0'>636BE0 int LoadBinSection34600_34601_34608_34609_34607_80034602(<a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
  Sets <a class='fieldref' href='#8A1CCC'>8A1CCC:ptrCarData</a> data.
</li><li><span class='func' id='77B620'>77B620 void init_function_77B620_registerBinSectionHandler0()</span>
  Registers <a class='fieldref' href='#7EB3F4'>7EB3F4:binSectionHandlerMagicMapEntry0</a> (without using <a class='funcref' href='#43C0B0'>43C0B0:RegisterBinSectionHandler()</a>).
</li><li><span class='func' id='77CB00'>77CB00 void init_function_77CB00_registerBinSectionHandler80134000()</span>
</li><li><span class='func' id='77CC20'>77CC20 void init_function_77CC20_registerBinSectionHandler135200()</span>
</li><li><span class='func' id='77CC40'>77CC40 void init_function_77CC40_registerBinSectionHandler80135100()</span>
</li><li><span class='func' id='77CC60'>77CC60 void init_function_77CC60_registerBinSectionHandler80135000()</span>
</li><li><span class='func' id='77CD60'>77CD60 void init_function_77CD60_registerBinSectionHandlerB3300000()</span>
</li><li><span class='func' id='77CDA0'>77CDA0 void init_function_77CDA0_registerBinSectionHandlerB0300100()</span>
</li><li><span class='func' id='77CD80'>77CD80 void init_function_77CD80_registerBinSectionHandlerB332000()</span>
</li><li><span class='func' id='77D960'>77D960 void init_function_77D960_registerBinSectionHandler39100()</span>
</li><li><span class='func' id='77D980'>77D980 void init_function_77D980_registerBinSectionHandler39101()</span>
</li><li><span class='func' id='77D9A0'>77D9A0 void init_function_77D9A0_registerBinSectionHandler39102()</span>
</li><li><span class='func' id='77E190'>77E190 void init_function_77E190_registerBinSectionHandler34026()</span>
</li><li><span class='func' id='77E1B0'>77E1B0 void init_function_77E1B0_registerBinSectionHandler34027()</span>
</li><li><span class='func' id='77E6C0'>77E6C0 void init_function_77E6C0_registerBinSectionHandler80034140()</span>
</li><li><span class='func' id='77E6E0'>77E6E0 void init_function_77E6E0_registerBinSectionHandler3412F()</span>
</li><li><span class='func' id='77E720'>77E720 void init_function_77E720_registerBinSectionHandler34146()</span>
</li><li><span class='func' id='77E740'>77E740 void init_function_77E740_registerBinSectionHandler34201()</span>
</li><li><span class='func' id='77E7A0'>77E7A0 void init_function_77E7A0_registerBinSectionHandler80034147()</span>
</li><li><span class='func' id='77E7D0'>77E7D0 void init_function_77E7D0_registerBinSectionHandler34110()</span>
</li><li><span class='func' id='77E7F0'>77E7F0 void init_function_77E7F0_registerBinSectionHandler34113()</span>
</li><li><span class='func' id='77E810'>77E810 void init_function_77E781_registerBinSectionHandler34111()</span>
</li><li><span class='func' id='77E830'>77E830 void init_function_77E783_registerBinSectionHandler34112()</span>
</li><li><span class='func' id='77E890'>77E890 void init_function_77E890_registerBinSectionHandler34108()</span>
</li><li><span class='func' id='77E8B0'>77E8B0 void init_function_77E8B0_registerBinSectionHandler80034100()</span>
</li><li><span class='func' id='77E8D0'>77E8D0 void init_function_77E8D0_registerBinSectionHandler34107()</span>
</li><li><span class='field' id='7EB3F4'>7EB3F4 <a href='#struct_BinSectionMagicMapEntry'>struct BinSectionMagicMapEntry</a> binSectionHandlerMagicMapEntry0</span>
  Map entry with <a class='funcref' href='#43C0A0'>43C0A0:LoadUnloadBinSection0()</a> as both <a href='#structBinSectionHandler_4'>loadfunc</a> and <a href='#structBinSectionHandler_8'>unloadfunc</a>.
</li><li><span class='field' id='7FA858'>7FA858 int (*binSectionLoadFuncs)(<a href='#struct_BinSection'>struct BinSection</a>*)[36]</span>
  Called by <a class='funcref' href='#570D70'>570D70:LoadBinSection()</a>.
  These funcs return 1 if they can process the data.
<pre>int (*<a class='fieldref' href='#7FA858'>binSectionLoadFuncs</a>)(<a href='#struct_BinSection'>struct BinSection</a>*)[] = {
/*0*/   <a class='funcref' href='#52CD00'>LoadLanguageFontBinSection30201</a>,
/*1*/   <a class='funcref' href='#491C70'>LoadBinSection80035000_80035010_35021_35020</a>,
/*2*/   <a class='funcref' href='#5DBF60'>LoadBinSection80036000</a>,
/*3*/   <a class='funcref' href='#5A1750'>LoadBinSection80034020</a>,
/*4*/   <a class='funcref' href='#5EA0F0'>LoadBinSection80034150</a>,
/*5*/   <a class='funcref' href='#4348F0'>LoadBinSection0E34010</a>,
/*6*/   <a class='funcref' href='#434E10'>LoadBinSection0E34009</a>,
/*7*/   <a class='funcref' href='#4377F0'>LoadBinSection80037020</a>,
/*8*/   <a class='funcref' href='#431870'>LoadBinSection80037050</a>,
/*9*/   <a class='funcref' href='#435A90'>LoadBinSection37080</a>,
/*10*/  <a class='funcref' href='#43A460'>LoadBinSection37090</a>,
/*11*/  <a class='funcref' href='#43A260'>LoadBinSection37110</a>,
/*12*/  <a class='funcref' href='#432080'>LoadBinSection37140</a>,
/*13*/  <a class='funcref' href='#43A1F0'>LoadBinSection37150</a>,
/*14*/  <a class='funcref' href='#4381B0'>LoadBinSection37100</a>,
/*15*/  <a class='funcref' href='#48B4A0'>LoadBinSection34202</a>,
/*16*/  <a class='funcref' href='#636BE0'>LoadBinSection34600_34601_34608_34609_34607_80034602</a>,
/*17*/  <a class='funcref' href='#599440'>LoadBinSection80034A30</a>,
/*18*/  <a class='funcref' href='#56C4C0'>LoadBinSection34A07</a>,
/*19*/  <a class='funcref' href='#61CB50'>LoadBinSection34030</a>,
/*20*/  <a class='funcref' href='#5DEB80'>LoadBinSection34121_34122_34123_34124</a>,
/*21*/  <a class='funcref' href='#408200'>LoadBinSection34B00</a>,
/*22*/  <a class='funcref' href='#5125B0'>LoadLanguageBinSection39000</a>,
/*23*/  <a class='funcref' href='#5E0190'>LoadBinSection34250</a>,
/*24*/  <a class='funcref' href='#40A460'>LoadBinSection3A000</a>,
/*25*/  <a class='funcref' href='#51BD30'>LoadBinSection30203_30210</a>,
/*26*/  <a class='funcref' href='#57A470'>LoadBinSection8003B000</a>,
/*27*/  <a class='funcref' href='#44AB60'>LoadBinSection8003B200_8003B201_8003B202</a>,
/*28*/  <a class='funcref' href='#512C00'>LoadBinSection80034A10</a>,
/*29*/  <a class='funcref' href='#52CD90'>LoadBinSection39020</a>,
/*30*/  <a class='funcref' href='#47BC30'>LoadBinSection8003B500</a>,
/*31*/  <a class='funcref' href='#61C3C0'>LoadBinSection30220</a>,
/*32*/  <a class='funcref' href='#60B810'>LoadBinSection8003B600</a>,
/*33*/  <a class='funcref' href='#48A280'>LoadBinSection3B700</a>,
/*34*/  <a class='funcref' href='#5108A0'>LoadBinSection30230</a>,
/*35*/  <a class='funcref' href='#5108E0'>LoadBinSection30231</a>,
}
</pre></li><li><span class='field' id='7FA8E8'>7FA8E8 int (*binSectionUnloadFuncs)(<a href='#struct_BinSection'>struct BinSection</a>*)[36]</span>
  Called by <a class='funcref' href='#577B10'>577B10:UnloadBinSection()</a>.
  These funcs return 1 if they can process the data.
<pre>int (*<a class='fieldref' href='#7FA8E8'>binSectionUnloadFuncs</a>)(<a href='#struct_BinSection'>struct BinSection</a>*)[] = {
/*0*/   <a class='funcref' href='#537290'>UnloadLanguageFontBinSection30201</a>,
/*1*/   <a class='funcref' href='#491D50'>UnloadBinSection80035000_80035010_35021_35020</a>,
/*2*/   <a class='funcref' href='#5DC050'>UnloadBinSection80036000</a>,
/*3*/   <a class='funcref' href='#5A1860'>UnloadBinSection80034020</a>,
/*4*/   <a class='funcref' href='#5DB5A0'>UnloadBinSection80034150</a>,
/*5*/   <a class='funcref' href='#4349A0'>UnloadBinSection0E34010</a>,
/*6*/   <a class='funcref' href='#4365B0'>UnloadBinSection0E34009</a>,
/*7*/   <a class='funcref' href='#4325C0'>UnloadBinSection80037020</a>,
/*8*/   <a class='funcref' href='#4318D0'>UnloadBinSection80037050</a>,
/*9*/   <a class='funcref' href='#438C20'>UnloadBinSection37080</a>,
/*10*/  <a class='funcref' href='#438C60'>UnloadBinSection37090</a>,
/*11*/  <a class='funcref' href='#435A50'>UnloadBinSection37110</a>,
/*12*/  <a class='funcref' href='#4320C0'>UnloadBinSection37140</a>,
/*13*/  <a class='funcref' href='#438720'>UnloadBinSection37150</a>,
/*14*/  <a class='funcref' href='#439D70'>UnloadBinSection37100</a>,
/*15*/  <a class='funcref' href='#48B740'>UnloadBinSection34202</a>,
/*16*/  <a class='funcref' href='#61B460'>UnloadBinSection34600_34601_80034602</a>,
/*17*/  <a class='funcref' href='#5994D0'>UnloadBinSection80034A30</a>,
/*18*/  <a class='funcref' href='#56C4E0'>UnloadBinSection34A07</a>,
/*19*/  <a class='funcref' href='#61CB90'>UnloadBinSection34030</a>,
/*20*/  <a class='funcref' href='#5E4820'>UnloadBinSection34121_34122_34123_34124</a>,
/*21*/  <a class='funcref' href='#408220'>UnloadBinSection34B00</a>,
/*22*/  <a class='funcref' href='#4FFAE0'>UnloadLanguageBinSection39000</a>,
/*23*/  <a class='funcref' href='#5E0220'>UnloadBinSection34250</a>,
/*24*/  <a class='funcref' href='#40A4A0'>UnloadBinSection3A000</a>,
/*25*/  <a class='funcref' href='#5425A0'>UnloadBinSection30203_30210</a>,
/*26*/  <a class='funcref' href='#57BCE0'>UnloadBinSection8003B000</a>,
/*27*/  <a class='funcref' href='#452E90'>UnloadBinSection8003B200_8003B201_8003B202</a>,
/*28*/  <a class='funcref' href='#500290'>UnloadBinSection80034A10</a>,
/*29*/  <a class='funcref' href='#51C610'>UnloadBinSection39020</a>,
/*30*/  <a class='funcref' href='#482D20'>UnloadBinSection8003B500</a>,
/*31*/  <a class='funcref' href='#61C420'>UnloadBinSection30220</a>,
/*32*/  <a class='funcref' href='#60BAC0'>UnloadBinSection8003B600</a>,
/*33*/  <a class='funcref' href='#48A2B0'>UnloadBinSection3B700</a>,
/*34*/  <a class='funcref' href='#5108C0'>UnloadBinSection30230</a>,
/*35*/  <a class='funcref' href='#510900'>UnloadBinSection30231</a>,
}
</pre></li><li><span class='field' id='827FE8'>827FE8 char numBinSectionLoadFunctionsInMagicMapBucket[64]</span>
  Written to, but never read. Functions seem to just check if
  <code><a href='#struct_BinSectionMagicMapEntry'>struct BinSectionMagicMapEntry</a>.<a href='#structBinSectionMagicMapEntry_0'>nextEntry</a></code>
  is 0 instead of counting entries.
</li><li><span class='field' id='828050'>828050 <a href='#struct_BinSectionMagicMapEntry'>struct BinSectionMagicMapEntry</a> *binSectionMagicMap[64]</span>
</li><li><span class='field' id='82DBA0'>82DBA0 <a href='#struct_BinSectionMagicMapEntry'>struct BinSectionMagicMapEntry</a> binSectionHandlerMagicMapEntryB3300000</span>
</li><li><span class='field' id='82DBB0'>82DBB0 <a href='#struct_BinSectionMagicMapEntry'>struct BinSectionMagicMapEntry</a> binSectionHandlerMagicMapEntry80135000</span>
</li><li><span class='field' id='830AF8'>830AF8 <a href='#struct_BinSectionMagicMapEntry'>struct BinSectionMagicMapEntry</a> binSectionHandlerMagicMapEntry80135100</span>
</li><li><span class='field' id='830B08'>830B08 <a href='#struct_BinSectionMagicMapEntry'>struct BinSectionMagicMapEntry</a> binSectionHandlerMagicMapEntryB0300100</span>
</li><li><span class='field' id='835784'>835784 <a href='#struct_BinSectionMagicMapEntry'>struct BinSectionMagicMapEntry</a> binSectionHandlerMagicMapEntry135200</span>
</li><li><span class='field' id='835840'>835840 <a href='#struct_BinSectionMagicMapEntry'>struct BinSectionMagicMapEntry</a> binSectionHandlerMagicMapEntry80134000</span>
</li><li><span class='field' id='8358D0'>8358D0 <a href='#struct_BinSectionMagicMapEntry'>struct BinSectionMagicMapEntry</a> binSectionHandlerMagicMapEntryB3320000</span>
</li><li><span class='field' id='8641F4'>8641F4 int binSection80034A10loaded</span>
  Ensures this section only gets loaded once.
</li><li><span class='field' id='8653A0'>8653A0 <a href='#struct_BinSectionMagicMapEntry'>struct BinSectionMagicMapEntry</a> binSectionHandlerMagicMapEntry39101</span>
</li><li><span class='field' id='865470'>865470 <a href='#struct_BinSectionMagicMapEntry'>struct BinSectionMagicMapEntry</a> binSectionHandlerMagicMapEntry39102</span>
</li><li><span class='field' id='86596C'>86596C <a href='#struct_BinSectionMagicMapEntry'>struct BinSectionMagicMapEntry</a> binSectionHandlerMagicMapEntry39100</span>
</li><li><span class='field' id='86B4AC'>86B4AC <a href='#struct_BinSectionMagicMapEntry'>struct BinSectionMagicMapEntry</a> binSectionHandlerMagicMapEntry34027</span>
</li><li><span class='field' id='86B580'>86B580 <a href='#struct_BinSectionMagicMapEntry'>struct BinSectionMagicMapEntry</a> binSectionHandlerMagicMapEntry34026</span>
</li><li><span class='field' id='88A2AC'>88A2AC <a href='#struct_BinSectionMagicMapEntry'>struct BinSectionMagicMapEntry</a> binSectionHandlerMagicMapEntry80034130</span>
</li><li><span class='field' id='88E9B4'>88E9B4 <a href='#struct_BinSectionMagicMapEntry'>struct BinSectionMagicMapEntry</a> binSectionHandlerMagicMapEntry80034100</span>
</li><li><span class='field' id='88E9CC'>88E9CC <a href='#struct_BinSectionMagicMapEntry'>struct BinSectionMagicMapEntry</a> binSectionHandlerMagicMapEntry80034147</span>
</li><li><span class='field' id='88E9DC'>88E9DC <a href='#struct_BinSectionMagicMapEntry'>struct BinSectionMagicMapEntry</a> binSectionHandlerMagicMapEntry34113</span>
</li><li><span class='field' id='88E9EC'>88E9EC <a href='#struct_BinSectionMagicMapEntry'>struct BinSectionMagicMapEntry</a> binSectionHandlerMagicMapEntry3412F</span>
</li><li><span class='field' id='88EA74'>88EA74 <a href='#struct_BinSectionMagicMapEntry'>struct BinSectionMagicMapEntry</a> binSectionHandlerMagicMapEntry34112</span>
</li><li><span class='field' id='88EA94'>88EA94 <a href='#struct_BinSectionMagicMapEntry'>struct BinSectionMagicMapEntry</a> binSectionHandlerMagicMapEntry34107</span>
</li><li><span class='field' id='88EAA4'>88EAA4 <a href='#struct_BinSectionMagicMapEntry'>struct BinSectionMagicMapEntry</a> binSectionHandlerMagicMapEntry34108</span>
</li><li><span class='field' id='88EAB4'>88EAB4 <a href='#struct_BinSectionMagicMapEntry'>struct BinSectionMagicMapEntry</a> binSectionHandlerMagicMapEntry34110</span>
</li><li><span class='field' id='88EAC4'>88EAC4 <a href='#struct_BinSectionMagicMapEntry'>struct BinSectionMagicMapEntry</a> binSectionHandlerMagicMapEntry34146</span>
</li><li><span class='field' id='88F27C'>88F27C <a href='#struct_BinSectionMagicMapEntry'>struct BinSectionMagicMapEntry</a> binSectionHandlerMagicMapEntry34111</span>
</li><li><span class='field' id='88F750'>88F750 <a href='#struct_BinSectionMagicMapEntry'>struct BinSectionMagicMapEntry</a> binSectionHandlerMagicMapEntry34201</span>
</li></ul><p style='margin-bottom:0'><a href='#index'>Index</a></p></div><span id='language'></span><div><h2>Language <a href="#language">#</a></h2>
<p>There seems to be no way to change the language, except for changing the value
in the registry? See <a href='#registry'>Registry</a>. Perhaps it is only set
when the game is installed?
</p><p style='margin-bottom:0'><a href='#index'>Index</a></p></div><span id='language_metadata'></span><div class='indent' style='margin-left:5em'><p style='margin-top:0'><small><a href='#language'>Language</a> &gt; Language metadata</small></p><h3>Language metadata <a href="#language_metadata">#</a></h3>
<p>Thanks to code where it reads the Registry, I found following data:
</p><pre><span id='struct_LanguageData'></span>struct LanguageData {
	char *pName;
	int <span id='structLanguageData_4'></span>val1; //??
	int region;
};

<a href='#struct_LanguageData'>struct LanguageData</a> <a class='fieldref' href='#7FCA08'>languageData</a>[] = {
        { "English US",            0,        0 },
        { "English UK",            0,        5 },
        { "French",                1,        6 },
        { "German",                2,        7 },
        { "Italian",               3,        8 },
        { "Spanish",               4,        9 },
        { "Swedish",               6,        5 },
        { "Danish",                7,        5 },
        { "Dutch",                 5,        5 },
        { "Korean",                8,        2 },
        { "Chinese (Traditional)", 9,        4 },
        { "English China",         9,        11 },
        { "Japanese",              10,       3 },
        { "Thai",                  11,       12 },
        { 0,                       0,        0 },
};
</pre><p>The value stored in the registry for <code>Language</code> is checked against
all language strings in the above data. The matching language's
<a href='#structLanguageData_4'>val1</a> gets stored in <a class='fieldref' href='#7FCA00'>7FCA00:languageIndex</a>, or 0 when the
name stored in the registry didn't match any names.
</p><p>After chasing usages of a region related proc,
I found more language data which is being used in <a class='funcref' href='#4FF680'>4FF680:LoadLanguageSomething()</a>.
They seem to fit into three more structs.
</p><pre>/*from hashes, prefixed with HASH_*/
#define HASH_CONDUITMDITC_TT21I 0x5B9D88B9
#define HASH_font_impact36 0x0920075C
#define HASH_CONDUITMDITC_TT14I 0x5B9D84DB
#define HASH_FONT_CONDUITMDITCTT38BI 0x9583AA1A
#define HASH_arial 0xA87927BE
#define HASH_arial12 0xAB6215C1
#define HASH_lcd_let48 0xBBBA71C2
#define HASH_conduitmditc_tt14i_korean 0xDCA5485A
#define HASH_conduitmditc_tt21i_korean 0x833A8678
#define HASH_conduitmditc_tt14i_chinese 0xF88A75F9
#define HASH_conduitmditc_tt21i_chinese 0x71C777D7
#define HASH_conduitmditc_tt14i_japanese 0x743BF1C1
#define HASH_conduitmditc_tt21i_japanese 0x15192F5F
#define HASH_conduitmditc_tt14i_thailand 0xA73823FF
#define HASH_conduitmditc_tt21i_thailand 0x4815619D

<span id='struct_LanguageStruct7F6DE8'></span>struct LanguageStruct7F6DE8 {
	int <span id='LanguageStruct7F6DE8_0'></span>fonthash;
	int <span id='LanguageStruct7F6DE8_4'></span>field_1;
};

<a href='#struct_LanguageStruct7F6DE8'>struct LanguageStruct7F6DE8</a> <a class='fieldref' href='#7F6DE8'>7F6DE8:struct7F6DE8</a>[] = {
        { HASH_CONDUITMDITC_TT21I,          0x0 },
        { HASH_font_impact36,               0x40000 },
        { HASH_CONDUITMDITC_TT14I,          0x10000 },
        { HASH_FONT_CONDUITMDITCTT38BI,     0x100000 },
        { HASH_arial,                       0x10000 },
        { HASH_arial12,                     0x10000 },
        { HASH_lcd_let48,                   0x4000 },
        { HASH_conduitmditc_tt14i_korean,   0x40000 },
        { HASH_conduitmditc_tt21i_korean,   0x80000 },
        { HASH_conduitmditc_tt14i_chinese,  0x40000 },
        { HASH_conduitmditc_tt21i_chinese,  0x80000 },
        { HASH_conduitmditc_tt14i_japanese, 0x40000 },
        { HASH_conduitmditc_tt21i_japanese, 0x80000 },
        { HASH_conduitmditc_tt14i_thailand, 0x40000 },
        { HASH_conduitmditc_tt21i_thailand, 0x80000 },
};

<span id='struct_LanguageStruct7F6E60'></span>struct LanguageStruct7F6E60 {
	int <span id='structLanguageStruct7F6E60_0'></span>data[28];
};

<span id='struct_LanguageFileData'></span>struct LanguageFileData {
	int id;
	char *filecode;
	char *binfile;
	<a href='#struct_LanguageStruct7F6E60'>struct LanguageStruct7F6E60</a> *<span id='structLanguageFileData_C'></span>pStruct7F6E60;
};

<a class='fieldref' href='#7F6E60'>struct7F6E60</a>[0][0] = HASH_CONDUITMDITC_TT21I;
<a class='fieldref' href='#7F6E60'>struct7F6E60</a>[0][1] = HASH_arial;
<a class='fieldref' href='#7F6E60'>struct7F6E60</a>[0][2] = HASH_CONDUITMDITC_TT14I;
<a class='fieldref' href='#7F6E60'>struct7F6E60</a>[0][3] = HASH_lcd_let48;
<a class='fieldref' href='#7F6E60'>struct7F6E60</a>[0][8] = HASH_FONT_CONDUITMDITCTT38BI;
<a class='fieldref' href='#7F6E60'>struct7F6E60</a>[0][16] = HASH_arial12;
<a class='fieldref' href='#7F6E60'>struct7F6E60</a>[0][17] = HASH_font_impact36;
<a class='fieldref' href='#7F6E60'>struct7F6E60</a>[1][0] = HASH_conduitmditc_tt21i_korean;
<a class='fieldref' href='#7F6E60'>struct7F6E60</a>[1][1] = HASH_arial;
<a class='fieldref' href='#7F6E60'>struct7F6E60</a>[1][2] = HASH_conduitmditc_tt14i_korean;
<a class='fieldref' href='#7F6E60'>struct7F6E60</a>[1][3] = HASH_lcd_let48;
<a class='fieldref' href='#7F6E60'>struct7F6E60</a>[1][16] = HASH_arial12;
<a class='fieldref' href='#7F6E60'>struct7F6E60</a>[1][17] = HASH_font_impact36;
<a class='fieldref' href='#7F6E60'>struct7F6E60</a>[2][0] = HASH_conduitmditc_tt21i_japanese;
<a class='fieldref' href='#7F6E60'>struct7F6E60</a>[2][1] = HASH_arial;
<a class='fieldref' href='#7F6E60'>struct7F6E60</a>[2][2] = HASH_conduitmditc_tt14i_japanese;
<a class='fieldref' href='#7F6E60'>struct7F6E60</a>[2][3] = HASH_lcd_let48;
<a class='fieldref' href='#7F6E60'>struct7F6E60</a>[2][8] = HASH_FONT_CONDUITMDITCTT38BI;
<a class='fieldref' href='#7F6E60'>struct7F6E60</a>[2][16] = HASH_arial12;
<a class='fieldref' href='#7F6E60'>struct7F6E60</a>[2][17] = HASH_font_impact36;
<a class='fieldref' href='#7F6E60'>struct7F6E60</a>[3][0] = HASH_conduitmditc_tt21i_chinese;
<a class='fieldref' href='#7F6E60'>struct7F6E60</a>[3][1] = HASH_arial;
<a class='fieldref' href='#7F6E60'>struct7F6E60</a>[3][2] = HASH_conduitmditc_tt14i_chinese;
<a class='fieldref' href='#7F6E60'>struct7F6E60</a>[3][3] = HASH_lcd_let48;
<a class='fieldref' href='#7F6E60'>struct7F6E60</a>[3][16] = HASH_arial12;
<a class='fieldref' href='#7F6E60'>struct7F6E60</a>[3][17] = HASH_font_impact36;

<a href='#struct_LanguageFileData'>struct LanguageFileData</a> <a class='fieldref' href='#7F7020'>languageFileData</a>[] = {
	{  0, "ENGLISH", "LANGUAGES\\ENGLISH.BIN", <a class='fieldref' href='#7F6E60'>struct7F6E60</a> + 0 },
	{  1, "FRENCH", "LANGUAGES\\FRENCH.BIN", <a class='fieldref' href='#7F6E60'>struct7F6E60</a> + 0 },
	{  2, "GERMAN", "LANGUAGES\\GERMAN.BIN", <a class='fieldref' href='#7F6E60'>struct7F6E60</a> + 0 },
	{  3, "ITALIAN", "LANGUAGES\\ITALIAN.BIN", <a class='fieldref' href='#7F6E60'>struct7F6E60</a> + 0 },
	{  4, "SPANISH", "LANGUAGES\\SPANISH.BIN", <a class='fieldref' href='#7F6E60'>struct7F6E60</a> + 0 },
	{  5, "DUTCH", "LANGUAGES\\DUTCH.BIN", <a class='fieldref' href='#7F6E60'>struct7F6E60</a> + 0 },
	{  6, "SWEDISH", "LANGUAGES\\SWEDISH.BIN", <a class='fieldref' href='#7F6E60'>struct7F6E60</a> + 0 },
	{  7, "DANISH", "LANGUAGES\\DANISH.BIN", <a class='fieldref' href='#7F6E60'>struct7F6E60</a> + 0 },
	{  8, "KOREAN", "LANGUAGES\\KOREAN.BIN", <a class='fieldref' href='#7F6E60'>struct7F6E60</a> + 1 },
	{  9, "CHINESE", "LANGUAGES\\CHINESE.BIN", <a class='fieldref' href='#7F6E60'>struct7F6E60</a> + 3 },
	{ 10, "JAPANESE", "LANGUAGES\\JAPANESE.BIN", <a class='fieldref' href='#7F6E60'>struct7F6E60</a> + 2 },
	/*there is no Thai entry here?*/
};
</pre><p>In <a class='funcref' href='#4FF680'>4FF680:LoadLanguageSomething()</a>, <a class='fieldref' href='#7F7020'>7F7020:languageFileData</a> is searched. If <a class='funcref' href='#570A30'>570A30:GetGameRegion()</a> is 2, the entry with id 8 is searched,
otherwise id 0 is searched.
When it's not found the game will segfault because of the code below:
</p><pre class='ida'><span class='text'>.text:004FF6A2</span>                 jl      short loc_4FF693
<span class='text'>.text:004FF6A4</span> loc_4FF6A4:
<span class='text'>.text:004FF6A4</span>                 xor     edx, edx
<span class='text'>.text:004FF6A6</span> loc_4FF6A6:
<span class='text'>.text:004FF6A6</span>                 mov     ecx, [edx+<span class='num'>0Ch</span>]
</pre><p>Then <code><a href='#struct_LanguageFileData'>struct LanguageFileData</a>.<a href='#structLanguageFileData_C'>pStruct7F6E60</a></code> is read.
Its <code><a href='#structLanguageStruct7F6E60_0'>data</a>[0]</code> value is read and then a
matching entry in <a class='fieldref' href='#7F6DE8'>7F6DE8:struct7F6DE8</a> is searched.
More stuff is read is a loop and reset and I lost track.
Eventually something is called with string <code>LanguageMemoryPool</code>.
</p><p><strong>7983D0 aLanguageselect db 'LanguageSelectScreen',0 TODO</strong>
</p><p><strong>Symbols:</strong></p><ul><li><span class='func' id='4FF680'>4FF680 void LoadLanguageSomething()</span>
  TODO
</li><li><span class='func' id='512520'>512520 LoadLanguageAtBoot?</span>
  TODO
</li><li><span class='field' id='7F6DE8'>7F6DE8 <a href='#struct_LanguageStruct7F6DE8'>struct LanguageStruct7F6DE8</a> struct7F6DE8[15]</span>
</li><li><span class='field' id='7F6E60'>7F6E60 <a href='#struct_LanguageStruct7F6E60'>struct LanguageStruct7F6E60</a> struct7F6E60[4]</span>
</li><li><span class='field' id='7FCA00'>7FCA00 int languageIndex</span>
</li><li><span class='field' id='7FCA08'>7FCA08 <a href='#struct_LanguageData'>struct LanguageData</a> languageData[15]</span>
</li><li><span class='field' id='7F7020'>7F7020 <a href='#struct_LanguageFileData'>struct LanguageFileData</a> languageFileData[11]</span>
</li></ul><p style='margin-bottom:0'><a href='#index'>Index</a></p></div><span id='language_files'></span><div class='indent' style='margin-left:5em'><p style='margin-top:0'><small><a href='#language'>Language</a> &gt; Language files</small></p><h3>Language files <a href="#language_files">#</a></h3>
<p>The language strings are in a bin section with magic <code>0x39000</code>, and is structured like this:
</p><pre><a href='#struct_BinDataLanguage39000'>struct BinDataLanguage39000</a> header;
char unknown[header.<a href='#structBinDataLanguage39000_8'>tableOffset</a> - sizeof(header)];
<a href='#struct_LanguageTableEntry'>struct LanguageTableEntry</a> tableEntries[header.<a href='#structBinDataLanguage39000_4'>numStrings</a>];
char *strings; /*all zero-terminated strings after each other*/
</pre><p>The <code>tableEntries</code> are sorted (low hash to high hash),
required because a binary search is used at lookup.
</p><pre class='ida'><span class='text'>.text:00497766</span>                 push    <span class='num'>04B5DE3E9h</span> <span class='comment'>; hash (SMS_SUBJECT_HEADER)</span>
<span class='text'>.text:0049776B</span>                 lea     eax, [esp+<span class='num'>104h</span>+<span class='str'>buffer</span>]
<span class='text'>.text:00497772</span>                 push    <span class='num'>80h</span>             ; <span class='comment'>destlen</span>
<span class='text'>.text:00497777</span>                 push    eax             ; <span class='comment'>dest</span>
<span class='text'>.text:00497778</span>                 call    <a class='funcref' href='#4FFA50'>GetLanguageStringIntoBuf</a>
</pre><p>Loading is done in <a class='funcref' href='#5125B0'>5125B0:LoadLanguageBinSection39000()</a>.
See <a href="language_english.txt">language_english.txt</a> for all <code>LANGUAGES/English.bin</code> strings by their hash.
(This was generated by an early version of <code><a href='https://github.com/yugecin/nfsu2-re/blob/master/nfsu2-re-binfiles/main.c'>nfsu2-re-binfiles/main.c</a></code>)
</p><p>The hashes seem to be made with the case insensitive hash function <a class='funcref' href='#43DB50'>43DB50:SomeHashCS43DB50()</a>.
The original labels are also stored as a language file in <code>LANGUAGES/Labels.bin</code>
</p><pre><span id='struct_BinDataLanguage39000'></span>struct BinDataLanguage39000 {
        int <span id='structBinDataLanguage39000_0'></span>field_0;
        int <span id='structBinDataLanguage39000_4'></span>numStrings;
        int <span id='structBinDataLanguage39000_8'></span>tableOffset;
        int <span id='structBinDataLanguage39000_C'></span>stringsOffset;
};

<span id='struct_LanguageTableEntry'></span>struct LanguageTableEntry {
	unsigned int <span id='structLanguageTableEntry_0'></span>hash;
	char *<span id='structLanguageTableEntry_4'></span>string;
};

<span id='struct_LoadedLanguage'></span>struct LoadedLanguage {
        int <span id='structLoadedLanguage_0'></span>numStrings;
        char **<span id='structLoadedLanguage_4'></span>ptrStrings;
        <a href='#struct_LanguageTableEntry'>struct LanguageTableEntry</a> *<span id='structLoadedLanguage_8'></span>ptrTable;
        <a href='#struct_LanguageConversionTable'>struct LanguageConversionTable</a> *<span id='structLoadedLanguage_C'></span>ptrConversionTable;
};

<span id='struct_LanguageConversionTable'></span>struct LanguageConversionTable {
        int field_0;
        wchar_t table[256]; /*size unknown*/
};
</pre><p>TODO: language files also contain bin sections with magic <code>0x30201</code>
</p><p><strong>Symbols:</strong></p><ul><li><span class='func' id='4FF9D0'>4FF9D0 char* GetLanguageStringOrNull(unsigned int hash)</span>
  Returns a string ptr or <code>NULL</code> for given hash (which is passed through <code>edx</code>).
  Does a binary search over the hashes in <code><a class='fieldref' href='#8383D0'>8383D0:loadedLanguage</a>.<a href='#structLoadedLanguage_8'>ptrTable</a></code>
</li><li><span class='func' id='4FFA50'>4FFA50 void GetLanguageStringIntoBuf(char *dst, int dstlen, unsigned int hash)</span>
  Same as <a class='funcref' href='#4FFA80'>4FFA80:GetLanguageString()</a> but copy it into a buffer.
</li><li><span class='func' id='4FFA80'>4FFA80 char* GetLanguageString(unsigned int hash)</span>
  Calls <a class='funcref' href='#4FF9D0'>4FF9D0:GetLanguageStringOrNull()</a> and when it returns <code>NULL</code>, call it again but with
  <code>0xC01A6F63</code> as fallback (which results in <code>FENG: Default string error.</code>)
</li><li><span class='func' id='4FFAA0'>4FFAA0 char* GetNumberSuffix(int number)</span>
  Returns, based on passed index, one of: <code>th, st, nd, rd, th, th, th, th, th, th th</code>,
  uses default string as fallback.
  TODO: xref this for fun and profit (only 2 usages?)
</li><li><span class='func' id='4FFAE0'>4FFAE0 int UnloadLanguageBinSection39000(<a href='#struct_BinSection'>struct BinSection</a> *section);</span>
<pre>if (section-&gt;<a href='#structBinSection_0'>header</a>.<a href='#structBinSectionHeader_0'>magic</a> == 0x39000) {
        <a class='fieldref' href='#8383D0'>loadedLanguage</a>.<a href='#structLoadedLanguage_C'>ptrConversionTable</a> = 0;
        <a class='fieldref' href='#8383D0'>loadedLanguage</a>.<a href='#structLoadedLanguage_0'>numStrings</a> = 0;
        <a class='fieldref' href='#8383D0'>loadedLanguage</a>.<a href='#structLoadedLanguage_4'>ptrStrings</a> = 0;
        <a class='fieldref' href='#8383D0'>loadedLanguage</a>.<a href='#structLoadedLanguage_8'>ptrTable</a> = 0;
}
</pre></li><li><span class='func' id='50D3C0'>50D3C0 int __thiscall LanguageConversionStrcpyCharToWchar(<a href='#struct_LanguageConversionTable'>struct LanguageConversionTable</a>
                                                *this, wchar_t *dest, int maxlen, char *src)</span>
  If a char could not be converted, it will be <code>_</code> and the func will return 1.
</li><li><span class='func' id='512530'>512530 void LanguageAwareStrcpyCharToWchar(wchar_t *dest, int maxlen, char *src)</span>
  Uses <a class='funcref' href='#50D3C0'>50D3C0:LanguageConversionStrcpyCharToWchar()</a> when <code><a class='fieldref' href='#8383D0'>8383D0:loadedLanguage</a>.<a href='#structLoadedLanguage_C'>ptrConversionTable</a></code> is set, otherwise <a class='funcref' href='#43E000'>43E000:NaiveStrcpyCharToWchar()</a>.
</li><li><span class='func' id='5125B0'>5125B0 int LoadLanguageBinSection39000(<a href='#struct_BinSection'>struct BinSection</a> *section)</span>
<pre><a href='#struct_BinDataLanguage39000'>struct BinDataLanguage39000</a> *data;
<a href='#struct_LanguageTableEntry'>struct LanguageTableEntry</a> *tableEntry;
int i;

if (section-&gt;<a href='#structBinSection_0'>header</a>.<a href='#structBinSectionHeader_0'>magic</a> == 0x39000) {
        data = (void*) section-&gt;<a href='#structBinSection_8'>data</a>;
        <a class='fieldref' href='#8383D0'>loadedLanguage</a>.<a href='#structLoadedLanguage_C'>ptrConversionTable</a> = (void*) (data + (int) data-&gt;<a href='#structBinDataLanguage39000_0'>field_0</a>);
        <a class='fieldref' href='#8383D0'>loadedLanguage</a>.<a href='#structLoadedLanguage_0'>numStrings</a> = data-&gt;<a href='#structBinDataLanguage39000_4'>numStrings</a>;
        <a class='fieldref' href='#8383D0'>loadedLanguage</a>.<a href='#structLoadedLanguage_4'>ptrStrings</a> = (void*) (data + (int) data-&gt;<a href='#structBinDataLanguage39000_C'>stringsOffset</a>);
        <a class='fieldref' href='#8383D0'>loadedLanguage</a>.<a href='#structLoadedLanguage_8'>ptrTable</a> = (void*) (data + (int) data-&gt;<a href='#structBinDataLanguage39000_8'>tableOffset</a>);
        tableEntry = <a class='fieldref' href='#8383D0'>loadedLanguage</a>.<a href='#structLoadedLanguage_8'>ptrTable</a>;
        for (i = 0; i &lt; <a class='fieldref' href='#8383D0'>loadedLanguage</a>.<a href='#structLoadedLanguage_0'>numStrings</a>; i++) {
                tableEntry-&gt;<a href='#structLanguageTableEntry_4'>string</a> += <a class='fieldref' href='#8383D0'>loadedLanguage</a>.<a href='#structLoadedLanguage_8'>ptrTable</a>;
                tableEntry++;
        }
}
</pre></li><li><span class='func' id='52CD00'>52CD00 int LoadLanguageFontBinSection30201(struct BinData *bindata)</span>
  Something with font.
</li><li><span class='func' id='537290'>537290 int UnloadLanguageFontBinSection30201(struct BinData *bindata)</span>
  Something with font.
</li><li><span class='field' id='8383D0'>8383D0 <a href='#struct_LoadedLanguage'>struct LoadedLanguage</a> loadedLanguage</span>
</li><li><span class='field' id='838530'>838530 int skipLanguageWcharTable</span>
  When 1, <a class='funcref' href='#50D3C0'>50D3C0:LanguageConversionStrcpyCharToWchar()</a> will just zero extend char to wchar_t instead of using the conversion table
  in the language file.
</li></ul><p style='margin-bottom:0'><a href='#index'>Index</a></p></div><span id='pools'></span><div><h2>Pools <a href="#pools">#</a></h2>
<p>I hooked <a class='funcref' href='#440B40'>440B40:AllocateAndInitPool()</a> and collected some output: <a href="createpoollog.txt">createpoollog.txt</a>
This will probably help a lot when trying to figure out other things.
Note that the first time the <code>AUD: NFS3DMixCtl Pool</code> is made, it has an element amount of zero.
The dump is from just starting the game and starting a circuit race.
</p><p>Pools can be enlarged by <a class='funcref' href='#440BB0'>440BB0:Pool::Extend()</a>, but only if <code><a href='#structPool_14'>flags</a></code> has the <code><a href='#POOL_FLAG_EXTENDABLE'>POOL_FLAG_EXTENDABLE</a></code>
flag. When extending, the newly created pool gets added as last in the main pool's
<code><a href='#structPool_8'>nextLinkedPool</a></code>. The main pool's <code><a href='#structPool_10'>firstAvailableElement</a></code> will point to the first allocated element of
the next pool, and the last allocated element of the new pool will point to the first element
of the main pool.
</p><pre><span id='struct_PoolLink'></span>struct PoolLink {
        <a href='#struct_PoolLink'>struct PoolLink</a> *<span id='structPoolLink_0'></span>prev;
        <a href='#struct_PoolLink'>struct PoolLink</a> *<span id='structPoolLink_4'></span>next;
};
/*link is a circle*/

<span id='struct_PoolControl'></span>struct PoolControl {
        int <span id='structPoolControl_0'></span>inited;
        <a href='#struct_PoolLink'>struct PoolLink</a> <span id='structPoolControl_4'></span>link;
};

#define <span id='POOL_FLAG_EXTENDABLE'></span>POOL_FLAG_EXTENDABLE 1
#define <span id='POOL_FLAG_DONT_ZERO_INIT'></span>POOL_FLAG_DONT_ZERO_INIT 2 /*used in <a class='funcref' href='#440D40'>440D40:PoolGetNextFreeItem()</a> etc*/

<span id='struct_Pool'></span>struct Pool {
	<a href='#struct_PoolLink'>struct PoolLink</a> <span id='structPool_0'></span>__parent;
	<a href='#struct_Pool'>struct Pool</a> *<span id='structPool_8'></span>nextLinkedPool;
	char* <span id='structPool_C'></span>name;
	<a href='#struct_PoolEntry'>struct PoolEntry</a> *<span id='structPool_10'></span>firstAvailableElement;
	int <span id='structPool_14'></span>flags;
	int <span id='structPool_18'></span>usedElements;
	int <span id='structPool_1C'></span>maxUsedElements; /*max amount of elements used at one time*/
	int <span id='structPool_20'></span>field_20;
	int <span id='structPool_24'></span>elementAmount;
	int <span id='structPool_28'></span>elementSize;
	int <span id='structPool_2C'></span>elementAmountOverAllLinkedPools;
        /*pool entries come here*/
};

<span id='struct_PoolEntry'></span>struct PoolEntry {
        <a href='#struct_PoolEntry'>struct PoolEntry</a> *<span id='structPoolEntry_0'></span>nextEntry;
        <a href='#struct_PoolEntry'>struct PoolEntry</a> *<span id='structPoolEntry_4'></span>prevEntry?;
};

struct bFileSystemPoolEntry {

};
EXPECT_SIZE(struct bFileSystemPoolEntry, 0xF0);
</pre><p><strong>Symbols:</strong></p><ul><li><span class='func' id='431380'>431380 void CreateAnim_CNFSAnimBankPool()</span>
  Called by <a class='funcref' href='#431380'>431380:CreateAnim_CNFSAnimBankPool()</a>
</li><li><span class='func' id='4314E0'>4314E0 void CreateAnim_CAnimSkeletonPool()</span>
  Called by <a class='funcref' href='#431380'>431380:CreateAnim_CNFSAnimBankPool()</a>
</li><li><span class='func' id='431580'>431580 void CreateAnim_CAnimPartPool()</span>
  Called by <a class='funcref' href='#431380'>431380:CreateAnim_CNFSAnimBankPool()</a>
</li><li><span class='func' id='43CD40'>43CD40 void __thiscall Pool::Init(<a href='#struct_Pool'>struct Pool</a> *this)</span>
  Called once, from <a class='funcref' href='#440B40'>440B40:AllocateAndInitPool()</a>.
  <details><summary>Implementation</summary>
<pre><a href='#struct_Pool'>struct Pool</a> *pool;
<a href='#struct_PoolEntry'>struct PoolEntry</a> *entry;
<a href='#struct_PoolEntry'>struct PoolEntry</a> *next;
int idx;

pool = this;
do {
        pool-&gt;<a href='#structPool_10'>firstAvailableElement</a> = NULL;
        if (pool-&gt;<a href='#structPool_24'>elementAmount</a>) {
                next = (void*) ((char*) pool + sizeof(<a href='#struct_Pool'>struct Pool</a>));
                pool-&gt;<a href='#structPool_10'>firstAvailableElement</a> = (void*) next;
                for (idx = pool-&gt;<a href='#structPool_24'>elementAmount</a> - 1; idx &gt;= 0; idx--) {
                        entry = next;
                        next += pool-&gt;<a href='#structPool_28'>elementSize</a>;
                        entry-&gt;<a href='#structPoolEntry_0'>nextEntry</a> = next;
                }
                next-&gt;<a href='#structPoolEntry_0'>nextEntry</a> = 0;
        }
        pool = pool-&gt;<a href='#structPool_8'>nextLinkedPool</a>;
} while (pool);
</pre>  </details>
</li><li><span class='func' id='43CD80'>43CD80 int __thiscall Pool::GetIndexOfEntry(<a href='#struct_Pool'>struct Pool</a> *this, <a href='#struct_PoolEntry'>struct PoolEntry</a> *entry)</span>
  -1 when not in this pool (or any linked pools).
</li><li><span class='func' id='43CDF0'>43CDF0 int __thiscall Pool::UngetEntry(<a href='#struct_Pool'>struct Pool</a> *this, <a href='#struct_PoolEntry'>struct PoolEntry</a> *entry)</span>
  Mark the entry as free again. Returns the amount of used entries in the pool.
  Same as <a class='funcref' href='#43F920'>43F920:UngetPoolEntry()</a>, but a thiscall.
</li><li><span class='func' id='43F8F0'>43F8F0 <a href='#struct_PoolEntry'>struct PoolEntry</a> *RemoveFirstPoolEntry(<a href='#struct_Pool'>struct Pool</a> *pool)</span>
</li><li><span class='func' id='43F920'>43F920 void UngetPoolEntry(<a href='#struct_Pool'>struct Pool</a> *pool, <a href='#struct_PoolEntry'>struct PoolEntry</a> *entry)</span>
  Same as <a class='funcref' href='#43CDF0'>43CDF0:Pool::UngetEntry()</a>, but an stdcall.
</li><li><span class='func' id='440390'>440390 void AllocateMemoryForPool?(int size, int somestring, int, int)</span>
  TODO, seems to check the string to determine how to alloc?
</li><li><span class='func' id='4407B0'>4407B0 void __thiscall PoolControl::Init(<a href='#struct_PoolControl'>struct PoolControl</a> *this)</span>
  Called by <a class='funcref' href='#77B670'>77B670:init_function_77B670()</a>.
<pre>this-&gt;<a href='#structPoolControl_4'>link</a>.<a href='#structPoolLink_0'>prev</a> = &amp;this-&gt;<a href='#structPoolControl_4'>link</a>;
this-&gt;<a href='#structPoolControl_4'>link</a>.<a href='#structPoolLink_4'>next</a> = &amp;this-&gt;<a href='#structPoolControl_4'>link</a>;
this-&gt;<a href='#structPoolControl_0'>inited</a> = 1;
</pre></li><li><span class='func' id='440B40'>440B40 AllocateAndInitPool(int elementSize, int elementAmount, char *name, int unknown)</span>
  Uses <a class='funcref' href='#440390'>440390:AllocateMemoryForPool?()</a> to allocate memory, calls <a class='funcref' href='#43CD40'>43CD40:Pool::Init()</a>.
  TODO, has one more XREF
</li><li><span class='func' id='440BB0'>440BB0 void __thiscall Pool::Extend(<a href='#struct_Pool'>struct Pool</a> *this, int elementAmount)</span>
  Only called by <a class='funcref' href='#440D40'>440D40:PoolGetNextFreeItem()</a>?
  <details><summary>Implementation <code><a href='https://github.com/yugecin/nfsu2-re/blob/master/nfsu2-re-hooks/replace-440BB0-Pool__Extend.c'>nfsu2-re-hooks/replace-440BB0-Pool__Extend.c</a></code></summary>
<pre><a href='#struct_Pool'>struct Pool</a> *ext;
<a href='#struct_Pool'>struct Pool</a> *lastPool;
char *ptr;

ext = <a class='funcref' href='#440B40'>AllocateAndInitPool</a>(this-&gt;<a href='#structPool_28'>elementSize</a>, elementAmount, this-&gt;<a href='#structPool_C'>name</a>, this-&gt;<a href='#structPool_20'>field_20</a>);
ext-&gt;<a href='#structPool_14'>flags</a> = this-&gt;<a href='#structPool_14'>flags</a>;

lastPool = this;
while (lastPool-&gt;<a href='#structPool_8'>nextLinkedPool</a>) {
        lastPool = lastPool-&gt;<a href='#structPool_8'>nextLinkedPool</a>;
}
lastPool-&gt;<a href='#structPool_8'>nextLinkedPool</a> = ext;

ptr = (char*) ext + sizeof(<a href='#struct_Pool'>struct Pool</a>); /*offset of first element*/
ptr += this-&gt;<a href='#structPool_28'>elementSize</a> * (elementAmount - 1); /*now offset of last element*/
((<a href='#struct_PoolEntry'>struct PoolEntry</a>*) ptr)-&gt;<a href='#structPoolEntry_0'>nextEntry</a> = this-&gt;<a href='#structPool_10'>firstAvailableElement</a>;

this-&gt;<a href='#structPool_10'>firstAvailableElement</a> = ext-&gt;<a href='#structPool_10'>firstAvailableElement</a>;
ext-&gt;<a href='#structPool_10'>firstAvailableElement</a> = NULL;

this-&gt;<a href='#structPool_2C'>elementAmountOverAllLinkedPools</a> += elementAmount;
</pre>  </details>
</li><li><span class='func' id='440DF0'>440DF0 <a href='#struct_Pool'>struct Pool</a> *CreatePool(int elementSize, int elementAmount, char *name, int unknown)</span>
  Calls <a class='funcref' href='#440B40'>440B40:AllocateAndInitPool()</a>.
  <details><summary>Implementation <code><a href='https://github.com/yugecin/nfsu2-re/blob/master/nfsu2-re-hooks/replace-440DF0-CreatePool.c'>nfsu2-re-hooks/replace-440DF0-CreatePool.c</a></code></summary>
<pre><a href='#struct_Pool'>struct Pool</a> *pool;
<a href='#struct_PoolLink'>struct PoolLink</a> *linkNext;

elementSize += 3;
elementSize -= elementSize % 4; /*ceil to multiple of 4*/
pool = <a class='funcref' href='#440B40'>AllocateAndInitPool</a>(elementSize, elementAmount, name, unknown);
if (pool &amp;&amp; <a class='fieldref' href='#828530'>pools</a>.<a href='#structPoolControl_0'>inited</a>) {
        linkNext = <a class='fieldref' href='#828530'>pools</a>.<a href='#structPoolControl_4'>link</a>.<a href='#structPoolLink_4'>next</a>;
        linkNext-&gt;<a href='#structPoolLink_0'>prev</a> = pool;
        <a class='fieldref' href='#828530'>pools</a>.<a href='#structPoolControl_4'>link</a>.<a href='#structPoolLink_4'>next</a> = pool;
        pool-&gt;<a href='#structPool_0'>__parent</a>.<a href='#structPoolLink_0'>prev</a> = <a class='fieldref' href='#828530'>pools</a>.<a href='#structPoolControl_4'>link</a>;
        pool-&gt;<a href='#structPool_0'>__parent</a>.<a href='#structPoolLink_4'>next</a> = linkNext;
}
return pool
</pre>  </details>
</li><li><span class='func' id='440D40'>440D40 <a href='#struct_PoolEntry'>struct PoolEntry</a> *__thiscall PoolGetNextFreeItem(<a href='#struct_Pool'>struct Pool</a> *this)</span>
</li><li><span class='func' id='440E50'>440E50 int PoolGetNextFreeItem_stdcallwrapper(void *pool)</span>
  {440D40} but wrapped in an stdcall.
</li><li><span class='func' id='440DA0'>440DA0 void __thiscall PoolControl::DeletePool(<a href='#struct_PoolControl'>struct PoolControl</a> *this, <a href='#struct_Pool'>struct Pool</a> *pool)</span>
  Frees pool and all its linked pools, remove the pool from the link in <a href='#struct_PoolControl'>struct PoolControl</a>.
</li><li><span class='func' id='440E40'>440E40 int DeletePool(<a href='#struct_Pool'>struct Pool</a> *pool)</span>
<pre><a class='fieldref' href='#828530'>pools</a>-&gt;<a class='funcref' href='#440DA0'>PoolControl::DeletePool</a>(pool);
</pre></li><li><span class='func' id='57ED10'>57ED10 ? ??SetupPools(?,?)</span>
  Called by <a class='funcref' href='#57ED10'>57ED10:??SetupPools()</a>
</li><li><span class='func' id='5EA8B0'>5EA8B0 int isUseMetricSystem()</span>
  Returns <a class='fieldref' href='#83AA1A'>83AA1A:useMetricSystem</a>.
</li><li><span class='func' id='77B670'>77B670 void init_function_77B670()</span>
<pre><a class='fieldref' href='#828530'>pools</a>-&gt;<a class='funcref' href='#4407B0'>PoolControl::Init</a>()
</pre></li><li><span class='field' id='828530'>828530 <a href='#struct_PoolControl'>struct PoolControl</a> pools</span>
</li><li><span class='field' id='865104'>865104 p_bFileSystemPool</span>
</li><li><span class='field' id='81CB6C'>81CB6C <a href='#struct_Pool'>struct Pool</a> *AIActionPool</span>
  Size 560 Amount 23
  Created by <a class='funcref' href='#4035D0'>4035D0:LoadAIStuff()</a>
</li><li><span class='field' id='81CB70'>81CB70 <a href='#struct_Pool'>struct Pool</a> *AIGoalPool</span>
  Size 40 Amount 22
  Created by <a class='funcref' href='#4035D0'>4035D0:LoadAIStuff()</a>
</li><li><span class='field' id='81CBB4'>81CBB4 <a href='#struct_Pool'>struct Pool</a> *futurePointPool</span>
  Size 120 Amount 600
  Created by <a class='funcref' href='#4035D0'>4035D0:LoadAIStuff()</a>
</li><li><span class='field' id='81CBB8'>81CBB8 <a href='#struct_Pool'>struct Pool</a> *pathfindingNodePool</span>
  Size 192 Amount 161
  Created by <a class='funcref' href='#4035D0'>4035D0:LoadAIStuff()</a>
</li><li><span class='field' id='81CBBC'>81CBBC <a href='#struct_Pool'>struct Pool</a> *pathfindingNodeLitePool</span>
  Size 12 Amount 1280
  Created by <a class='funcref' href='#4035D0'>4035D0:LoadAIStuff()</a>
</li><li><span class='field' id='827B4C'>827B4C <a href='#struct_Pool'>struct Pool</a> *anim_CNFSAnimBankPool</span>
  Size 60 Amount 81
  Created by <a class='funcref' href='#431380'>431380:CreateAnim_CNFSAnimBankPool()</a> or <a class='funcref' href='#4348F0'>4348F0:LoadBinSection0E34010()</a> (whoever is first, checked with <a class='fieldref' href='#827B50'>827B50:anim_CNFSAnimBankPoolCreated</a>)
</li><li><span class='field' id='827B50'>827B50 int anim_CNFSAnimBankPoolCreated</span>
  To make sure <a class='fieldref' href='#827B4C'>827B4C:anim_CNFSAnimBankPool</a> gets created just once, since two funcs can make it.
</li><li><span class='field' id='827B54'>827B54 <a href='#struct_Pool'>struct Pool</a> *animCtrlPool</span>
  Size 128 Amount 64
  Created by <a class='funcref' href='#57ED10'>57ED10:??SetupPools()</a>
</li><li><span class='field' id='827B5C'>827B5C <a href='#struct_Pool'>struct Pool</a> *anim_CAnimSkeletonPool</span>
  Size 40 Amount 8
  Created by <a class='funcref' href='#4314E0'>4314E0:CreateAnim_CAnimSkeletonPool()</a> or <a class='funcref' href='#434E10'>434E10:LoadBinSection0E34009()</a> (whoever is first, checked with <a class='fieldref' href='#827B60'>827B60:anim_CAnimSkeletonPoolCreated</a>)
</li><li><span class='field' id='827B60'>827B60 int anim_CAnimSkeletonPoolCreated</span>
  To make sure <a class='fieldref' href='#827B5C'>827B5C:anim_CAnimSkeletonPool</a> gets created just once, since two funcs can make it.
</li><li><span class='field' id='827B64'>827B64 <a href='#struct_Pool'>struct Pool</a> *anim_CAnimPartPool</span>
  Size 20 Amount 8
  Created by <a class='funcref' href='#431580'>431580:CreateAnim_CAnimPartPool()</a>
</li><li><span class='field' id='827B68'>827B68 int anim_CAnimPartPoolCreated</span>
  To make sure <a class='fieldref' href='#827B64'>827B64:anim_CAnimPartPool</a> gets created just once, although it seems like only one place creates it.
</li><li><span class='field' id='83AA1A'>83AA1A int useMetricSystem</span>
</li></ul><p style='margin-bottom:0'><a href='#index'>Index</a></p></div><span id='speedyboot'></span><div><h2>Speedy boot <a href="#speedyboot">#</a></h2>
<p><em>I want a fast startup because I'm booting the game so many times
(not to mention the numerious crashes)</em>
</p><p>During startup, with the debug string output enabled, there are a few entries
showing loading and unloading states, such as <code>LS_THXMovie.fng</code>.
I already sped up boot by replacing the <code>MOVIES/THX_logo.vp6</code> with
<code>MOVIES/blank.vp6</code>. While that skips the unskippable intro logos,
it still takes some time because it switches to a state where it tries loading
and it takes slightly under a second to switch to the next state.
</p><p>So by following the debug prints, I found following section:
</p><pre class='ida'><span class='comment'>.data:007F65E8</span> off_7F65E8  dd offset <span class='ident'>aDiscerrorpc_fn</span>
<span class='comment'>.data:007F65EC</span>             dd offset byte_783FE5
<span class='comment'>.data:007F65F0</span>             dd offset <span class='ident'>aMc_bootup_fng</span> <span class='comment'>; "MC_Bootup.fng"</span>
<span class='comment'>.data:007F65F4</span>             dd offset byte_783FE5
<span class='comment'>.data:007F65F8</span>             dd offset byte_783FE5
<span class='comment'>.data:007F65FC</span>             dd offset <span class='ident'>aLs_blankmovie_</span> <span class='comment'>; "LS_BlankMovie.fng"</span>
<span class='comment'>.data:007F6600</span>             dd offset <span class='ident'>aLs_ealogo_fng</span> <span class='comment'>; "LS_EAlogo.fng"</span>
<span class='comment'>.data:007F6604</span>             dd offset byte_783FE5
<span class='comment'>.data:007F6608</span>             dd offset <span class='ident'>aLs_thxmovie_fn</span> <span class='comment'>; "LS_THXMovie.fng"</span>
<span class='comment'>.data:007F660C</span>             dd offset <span class='ident'>aLs_psamovie_fn</span> <span class='comment'>; "LS_PSAMovie.fng"</span>
<span class='comment'>.data:007F6610</span>             dd offset <span class='ident'>aUg_ls_introfmv</span> <span class='comment'>; "UG_LS_IntroFMV.fng"</span>
<span class='comment'>.data:007F6614</span>             dd offset <span class='ident'>aUg_ls_splash_f</span> <span class='comment'>; "UG_LS_Splash.fng"</span>
<span class='comment'>.data:007F6618</span>             dd offset <span class='ident'>aMc_background_</span> <span class='comment'>; "MC_Background.fng"</span>
<span class='comment'>.data:007F661C</span>             dd offset <span class='ident'>aUi_main_fng</span>  <span class='comment'>; "UI_Main.fng"</span>
</pre><p>This very much looks like the boot states the game goes through.
<code>byte_783FE5</code> is basically an empty string, so maybe there used to
be more states, or some are for different game versions?
</p><p>Putting all of them to a reference to an empty string makes the boot pretty speedy
but then it doesn't do much. After initial boot, there's a black screen for a
short moment, then the basic loading progressbar screen with the cars and Rachel
shows, then it goes to a black screen and you can move the cursor. So the game is
running but nothing of UI is running so you can't do much.
</p><p>Only leaving <code>UG_LS_Splash.fng</code> shows the splash screen with Rachel and
the cars, the famous music starts playing and when the beat drops the EA TRAX message
shows and "Press enter" shows. When pressing enter, we're back to the black screen
with a moveable cursor.
</p><p>Only leaving <code>MC_BACKGROUND.fng</code> shows the splash screen with Rachel and
the cars and the prompt if I want to create a new profile. When pressing 'no', we're
back to the black screen. When pressing 'yes' I get to enter a name but when it then
asks to save the profile, it says 'Unable to save profile' so I have to choose 'no'.
Then black screen again.
</p><p>Only leaving <code>UI_MAIN.fng</code> directly jumps to the main menu where you see
Rachel's car after a short moment after the loading screen showed. It didn't ask
for a profile to load and when I try to load a profile it says that no profiles
were found. Scary. I can create a new profile but it says 'Unable to save'. There
is no music in the menu. Music does start when starting a race but going back to
the menus stops the music again. Going to EA TRAX in the option does suddenly
start the music in the menus.
</p><p>When only leaving <code>LS_EALogo.fng</code>, the ea logo movie sound starts to play
while the 'loading' screen is still showing, then there's one frame of the logo movie
when it's about halfway the sound of the movie and then it goes to black screen with
cursor. Leaving <code>LS_BlankMovie.fng</code> in as well fixes that problem.
</p><p>Leaving just <code>MC_Bootup.fng</code> doesn't seem to change much, not even timing
wise. It does sound important, so I tried this in combination with
<code>UI_MAIN.fng</code>. It jumps into the main menu, but when I go to the profile
manager now, I can load my profiles. Nice. The main menu music still doesn't load
without going to EA TRAX, but I'm okay with that. One weird thing is that the Q button
doesn't show the 'quit game' dialog. After searching a bit, it seems like
<code>LS_PSAMovie.fng</code> is the one that makes the Q to quit keybind happen. That's
quite interesting, definitely something to research when/if I get more into the workings
of the UI.
</p><p>(Later I found the PSA screen(s) put <a class='fieldref' href='#836494'>836494:canUseQToExit</a> on 1 after they're done, I'm guessing for
some reason they don't want us to exit while the PSA is playing, or before the intro
movies end.)
</p><p>So my final setup is to only leave in <code>MC_Bootup</code> (because it makes profiles
work), <code>LS_PSAMovie</code> (because I like the Q button and it can be a good dialog
test, it means I still need to skip the PSA movie but I can handle that),
<code>MC_Background</code> (so I can load a profile at start) and
<code>UI_Main</code> (obviously). Code in <code><a href='https://github.com/yugecin/nfsu2-re/blob/master/nfsu2-re-hooks/speedyboot.c'>nfsu2-re-hooks/speedyboot.c</a></code>.
</p><p style='margin-bottom:0'><a href='#index'>Index</a></p></div><span id='consoleleftover'></span><div><h2>Console leftovers <a href="#consoleleftover">#</a></h2>
<p><em>Note: console as in somewhere you type in, not a videogame console</em>
</p><p>In the hooks project, I "enabled" this console in the functions <code>initConsolePOC</code>
in the file <code><a href='https://github.com/yugecin/nfsu2-re/blob/master/nfsu2-re-hooks/faux-enable-console.c'>nfsu2-re-hooks/faux-enable-console.c</a></code>.
As it doesn't seem to be used anywhere, the only effect you can see is that whatever you
type is written into the <code>console_real_text</code> buffer (use CheatEngine or something
you like to inspect it).
</p><p style='margin-bottom:0'><a href='#index'>Index</a></p></div><span id='console_consume_key'></span><div class='indent' style='margin-left:5em'><p style='margin-top:0'><small><a href='#consoleleftover'>Console leftovers</a> &gt; ConsoleConsumeKey</small></p><h3>ConsoleConsumeKey <a href="#console_consume_key">#</a></h3>
<p>When looking at the <a class='funcref' href='#5CCD60'>5CCD60:MainWndProc()</a> (which is not to hard too find because it's
passed in a struct to <code>RegisterClassExA</code>), I saw a call to a function that
is called on every <code>WM_CHAR</code> event. The function does nothing when the value
in <a class='fieldref' href='#8709BC'>8709BC:consoleEnabledFlag</a> is zero, and there are no write references to it, so it seems
like it will always be zero.
</p><p>First it seems like the input is dropped if it's a <code>CR</code> (carriage return) and
when the value at <a class='fieldref' href='#8709C4'>8709C4:consoleIgnoreNextCR</a> is non-zero. Again, this is always zero so CR's
are never dropped.
</p><p>Then it has four different handlers. The first one handles a backspace character, second
one does escape, third one does tab and CR, and the last one does everything else. Basically
one character is deleted when pressing backspace and one character is added in all other
cases. I named following variables:
</p><ul><li><a class='fieldref' href='#8709B8'>8709B8:consoleTextCaretPosition</a>
</li><li><a class='fieldref' href='#8709C0'>8709C0:consoleTextStringMaxLength</a>
</li><li><a class='fieldref' href='#8709B0'>8709B0:consoleTextString</a>
</li><li><a class='fieldref' href='#8709B4'>8709B4:consoleTextStringLength</a>
</li><li><a class='fieldref' href='#8709BC'>8709BC:consoleEnabledFlag</a>
</li></ul><p>Basically, on backspace it checks if <a class='fieldref' href='#8709B8'>8709B8:consoleTextCaretPosition</a> is bigger than zero,
copies everything in <a class='fieldref' href='#8709B0'>8709B0:consoleTextString</a> starting from <a class='fieldref' href='#8709B8'>8709B8:consoleTextCaretPosition</a> to a
zero byte into a newly allocated buffer, decrements <a class='fieldref' href='#8709B8'>8709B8:consoleTextCaretPosition</a> and <a class='fieldref' href='#8709B4'>8709B4:consoleTextStringLength</a>,
and copies everything from the allocated buffer back into <a class='fieldref' href='#8709B0'>8709B0:consoleTextString</a> at position <a class='fieldref' href='#8709B8'>8709B8:consoleTextCaretPosition</a>.
</p><p>When inserting, it checks if <a class='fieldref' href='#8709B4'>8709B4:consoleTextStringLength</a> is less than <a class='fieldref' href='#8709C0'>8709C0:consoleTextStringMaxLength</a>,
copies everything in <a class='fieldref' href='#8709B0'>8709B0:consoleTextString</a> starting from <a class='fieldref' href='#8709B8'>8709B8:consoleTextCaretPosition</a> to a zero byte into
a newly allocated buffer, inserts the character in <a class='fieldref' href='#8709B0'>8709B0:consoleTextString</a> at position <a class='fieldref' href='#8709B8'>8709B8:consoleTextCaretPosition</a>,
increments <a class='fieldref' href='#8709B8'>8709B8:consoleTextCaretPosition</a> and <a class='fieldref' href='#8709B4'>8709B4:consoleTextStringLength</a> by one,
and copies everything from the allocated buffer back into <a class='fieldref' href='#8709B0'>8709B0:consoleTextString</a> at position <a class='fieldref' href='#8709B8'>8709B8:consoleTextCaretPosition</a>.
</p><ul><li>Backspace: delete character before caret
</li><li>Escape: insert zero byte
</li><li>Tab and CR: insert LF
</li><li>Other: insert char if it's <code>a-z</code> or <code>A-Z</code> or <code>0-9</code> or,
  if <a class='fieldref' href='#80057E'>80057E:consoleDisallowSpecialChars</a> is zero, <code>_</code> or <code>@</code> or <code>.</code> or
  <code>-</code>. If none of these pass, do a check for more keys as described below}
</li></ul><p style='margin-bottom:0'><a href='#index'>Index</a></p></div><span id='console_consume_key_check'></span><div class='indent' style='margin-left:10em'><p style='margin-top:0'><small><a href='#consoleleftover'>Console leftovers</a> &gt; <a href='#console_consume_key'>ConsoleConsumeKey</a> &gt; A hardcoded key check</small></p><h4>A hardcoded key check <a href="#console_consume_key_check">#</a></h4>
<p>At the end of looking if a character is valid, when it hasn't passed any of the criteria
above, it checks one last function if <a class='fieldref' href='#8709C7'>8709C7:consoleFilterSpecialChars</a> is <code>1</code>. The function
seems to check if the key is one of 55 configured values and if so, the char is accepted.
</p><p style='margin-bottom:0'><a href='#index'>Index</a></p></div><span id='console_move_caret'></span><div class='indent' style='margin-left:5em'><p style='margin-top:0'><small><a href='#consoleleftover'>Console leftovers</a> &gt; ConsoleMoveCaret</small></p><h3>ConsoleMoveCaret <a href="#console_move_caret">#</a></h3>
<p>This function is also called from <a class='funcref' href='#5CCD60'>5CCD60:MainWndProc()</a>, this time when a
<code>WM_KEYDOWN</code> message is received. One parameter is passed based on the keycode
of the event:
</p><ul><li><code>VK_LEFT</code>: <code>-1</code>
</li><li><code>VK_RIGHT</code>: <code>1</code>
</li><li><code>VK_HOME</code>: <code>-<a class='fieldref' href='#8709C0'>consoleTextStringMaxLength</a></code>
</li><li><code>VK_END</code>: <code><a class='fieldref' href='#8709C0'>consoleTextStringMaxLength</a></code>
</li></ul><p>This is the only other function that checks if <a class='fieldref' href='#8709BC'>8709BC:consoleEnabledFlag</a> is non-zero.
</p><p style='margin-bottom:0'><a href='#index'>Index</a></p></div><div><p style='margin-top:0'><small><a href='#consoleleftover'>Console leftovers</a> (continuation)</small></p><p>I need text here or my parser breaks.
</p><p><strong>Symbols:</strong></p><ul><li><span class='func' id='5BF260'>5BF260 int ConsoleIsArgOneOfTheseHardcodedValues(char c)</span>
<pre>unsigned char values[55] = {
        ' ', '.', ',', '_', '@', '-', '`', '=', '[', ']', '\\',
        ';', '\'', '/', '&lt;', '&gt;', '?', ':', '"', '{', '}', '|',
        '+', '(', ')', '*', '&amp;', '%', '#', '!', '~', 0xE5, 0xE4,
        0xE0, 0xE2, 0xEB, 0xE8, 0xE9, 0xEA, 0xEF, 0xEE, 0xF6,
        0xF4, 0xFC, 0xF9, 0xFB, 0xE7, 0x9C, 0xF2, 0xEC, 0xC5,
        0xC4, 0xD6, 0xDC, 0xA7
};
int i;

for (i = 0; i &lt; 55; i++) {
        if (values[i] == value) {
                return 1;
        }
}
return 0;
</pre></li><li><span class='func' id='5BF3A0'>5BF3A0 void ConsoleMoveCaret(int relativePosition)</span>
</li><li><span class='field' id='80057E'>80057E char consoleDisallowSpecialChars</span>
  Never written to?
</li><li><span class='field' id='80057D'>80057D char consoleLastCharTyped?</span>
  Never read from?
</li><li><span class='field' id='8709B0'>8709B0 char *consoleTextString</span>
</li><li><span class='field' id='8709B4'>8709B4 int consoleTextStringLength</span>
</li><li><span class='field' id='8709B8'>8709B8 int consoleTextCaretPosition</span>
</li><li><span class='field' id='8709BC'>8709BC int consoleEnabledFlag</span>
</li><li><span class='field' id='8709C0'>8709C0 int consoleTextStringMaxLength</span>
</li><li><span class='field' id='8709C4'>8709C4 int consoleIgnoreNextCR</span>
</li><li><span class='field' id='8709C5'>8709C5 char ??DebugUnusedLastKeyPressed</span>
</li><li><span class='field' id='8709C7'>8709C7 char consoleFilterSpecialChars</span>
</li></ul><p style='margin-bottom:0'><a href='#index'>Index</a></p></div><span id='hashfuncs'></span><div><h2>Hash functions <a href="#hashfuncs">#</a></h2>
<p>While scrolling and looking at references to some strings, I found some parts that look like
following excerpt:
</p><pre class='ida'><span class='text'>.text:005121AE</span>     push    offset <span class='ident'>aGenericdialo_2</span> <span class='comment'>; "GenericDialog_Animate_SMALL.fng"</span>
<span class='text'>.text:005121B3</span>     call    <span class='hi'>sub_505450</span>
<span class='text'>.text:005121B8</span>     add     esp, <span class='num'>4</span>
<span class='text'>.text:005121BB</span>     cmp     esi, eax
<span class='text'>.text:005121BD</span>     jz      short loc_512218
<span class='text'>.text:005121BF</span>     push    offset <span class='ident'>aGenericdialog_</span> <span class='comment'>; "GenericDialog_SMALL.fng"</span>
<span class='text'>.text:005121C4</span>     call    <span class='hi'>sub_505450</span>
<span class='text'>.text:005121C9</span>     add     esp, <span class='num'>4</span>
<span class='text'>.text:005121CC</span>     cmp     esi, eax
<span class='text'>.text:005121CE</span>     jz      short loc_512218
<span class='text'>.text:005121D0</span>     push    offset <span class='ident'>aGenericdialo_3</span> <span class='comment'>; "GenericDialog_Animate_MED.fng"</span>
<span class='text'>.text:005121D5</span>     call    <span class='hi'>sub_505450</span>
<span class='text'>.text:005121DA</span>     add     esp, <span class='num'>4</span>
<span class='text'>.text:005121DD</span>     cmp     esi, eax
<span class='text'>.text:005121DF</span>     jz      short loc_512218
<span class='text'>.text:005121E1</span>     push    offset <span class='ident'>aGenericdialo_4</span> <span class='comment'>; "GenericDialog_MED.fng"</span>
<span class='text'>.text:005121E6</span>     call    <span class='hi'>sub_505450</span>
<span class='text'>.text:005121EB</span>     add     esp, <span class='num'>4</span>
<span class='text'>.text:005121EE</span>     cmp     esi, eax
<span class='text'>.text:005121F0</span>     jz      short loc_512218
<span class='text'>.text:005121F2</span>     push    offset <span class='ident'>aGenericdialo_5</span> <span class='comment'>; "GenericDialog_Animate_LARGE.fng"</span>
<span class='text'>.text:005121F7</span>     call    <span class='hi'>sub_505450</span>
<span class='text'>.text:005121FC</span>     add     esp, <span class='num'>4</span>
<span class='text'>.text:005121FF</span>     cmp     esi, eax
<span class='text'>.text:00512201</span>     jz      short loc_512218
<span class='text'>.text:00512203</span>     push    offset <span class='ident'>aGenericdialo_0</span> <span class='comment'>; "GenericDialog_LARGE.fng"</span>
<span class='text'>.text:00512208</span>     call    <span class='hi'>sub_505450</span>
<span class='text'>.text:0051220D</span>     add     esp, <span class='num'>4</span>
<span class='text'>.text:00512210</span>     cmp     esi, eax
<span class='text'>.text:00512212</span>     jz      short loc_512218
</pre><p>The proc <a class='funcref' href='#505450'>505450:SomeHashCI505450()</a> doesn't look very complicated; it has one argument and
doesn't perform any calls. It dereferences the given argument and increment its position,
until a zero has been found. While it's doing that, <code>eax</code> is modified based on the read value.
So I assumed it is some hashing function and hooked it to see what kind of things are passed
through it.
</p><p>As it turns out, it gets called many, many times.
</p><pre><strong>time        input                       result</strong>
53.42743683 GenericDialog_SMALL.fng     6962C0CD
53.42753220 UI_PC_Help_Bar.fng          33AC1CB4
53.42756271 OL_ICON_GROUP               2BAC0CEE
53.42758179 UI_PC_Help_Bar.fng          33AC1CB4
53.42760086 Hide                        0016A259
53.42761993 UI_Main.fng                 C343126A
53.42766190 GarageMain.fng              4CDD8B14
53.42769241 GarageMain.fng              4CDD8B14
53.42771149 GarageMain.fng              4CDD8B14
53.42773056 GenericDialog.fng           F68A7675
53.42774963 UI_GenericParts_Browser.fng AF09F84F
53.42776871 GenericDialog.fng           F68A7675
53.42779160 GenericDialog_SMALL.fng     6962C0CD
53.42781067 UI_PC_Help_Bar.fng          33AC1CB4
53.42782974 UI_Main.fng                 C343126A
53.42784882 GarageMain.fng              4CDD8B14
53.42790222 UI_MagazineBack.fng         FA8CC482
53.42796707 GenericDialog_SMALL.fng     6962C0CD
53.42798615 UI_PC_Help_Bar.fng          33AC1CB4
53.42800522 UI_Main.fng                 C343126A
53.42802429 GarageMain.fng              4CDD8B14
53.42922211 GenericDialog_SMALL.fng     6962C0CD
53.42924881 UI_PC_Help_Bar.fng          33AC1CB4
53.42926788 UI_Main.fng                 C343126A
53.42928696 GarageMain.fng              4CDD8B14
</pre><p>The excerpt above is probably from one cycle in the update loop, and is repeated a lot.
</p><p>Some time later I found a very similar looking proc: <a class='funcref' href='#43DB50'>43DB50:SomeHashCS43DB50()</a>, so I copied
the previous hook for this function. This one gets called many times seemingly at startup
and when car parts or maps get loaded.
</p><p>When writing this I took a better look at the procedures and saw that the only difference
really is that the first one is case insensitive while the second one is case sensitive.
In the <a class='funcref' href='#505450'>505450:SomeHashCI505450()</a> one, it checks for every character if it is in the range
<code>'a'-'z'</code> and subtracts <code>0x20</code> if so, making the character uppercase
before updating the hash.
</p><p>See <a href="hashes.txt">hashes.txt</a> (&lt; 1MB) for list of hashes, each line is formatted
as <code>hash\tinput\tresult\tproc\n</code>. This file is updated at random times. 8 minutes
of playing gives about a 277MB file, all output was piped to <code>sort | uniq</code>.
</p><p>How I collected these can be seen in the <code>nfsu2-re-hooks/hook-*-hash-*.c</code> files.
</p><p><strong>Symbols:</strong></p><ul><li><span class='func' id='43DB50'>43DB50 unsigned int SomeHashCS43DB50(char *str)</span>
  Case sensitive hash function.
</li><li><span class='func' id='43DB80'>43DB80 unsigned int __cdecl SomeHashCS_WithStartValue(char *str, unsigned int startValue)</span>
  Like <a class='funcref' href='#43DB50'>43DB50:SomeHashCS43DB50()</a>, but starts with given <code>startValue</code> instead of <code>-1</code>.
</li><li><span class='func' id='505450'>505450 unsigned int SomeHashCI505450(char *str)</span>
  Case insensitive hash function.
</li><li><span class='func' id='50B990'>50B990 unsigned int FormatWithSinglePlaceholderAndHashCS43DB50(char *src, void *param)</span>
  Delegates hashing to <a class='funcref' href='#43DB50'>43DB50:SomeHashCS43DB50()</a>.
</li><li><span class='func' id='50B9C0'>50B9C0 unsigned int FormatWithSinglePlaceholderAndHashCI(char *src, void *param)</span>
  Does its own hashing.
</li></ul><p style='margin-bottom:0'><a href='#index'>Index</a></p></div><span id='hashmess'></span><div class='indent' style='margin-left:5em'><p style='margin-top:0'><small><a href='#hashfuncs'>Hash functions</a> &gt; Messing with hash results</small></p><h3>Messing with hash results <a href="#hashmess">#</a></h3>
<p>I had an impulse to try to return different results for certain hashes. For example, return
the result of <code>FIRETRUCK</code> when the input is <code>240SX</code>. The result is ..
difficult to describe. Here's some short points:
</p><ul><li>Browsing to the stock 240sx to customize shows an empty spot, no car
</li><li>Selecting the stock car to customize will suddenly swap to the firetruck model
</li><li>I can modify the firetruck, I can't select any bumpers but I can choose spoilers,
  although it does nothing
</li><li>Changing wheels/spinners/hydraulics does show
</li><li>Then going out of the customization menu crashes the game
  (this includes going to performance tuning)
</li></ul><p class='center'><img src="FIRETRUCK.GIF" alt="jumping firetruck"/><br/>Hop hop skippity hop</p>
<ul><li>Browsing a previously customized 240sx only shows the wheels of the car
</li><li>If the wheels were not customized, it shows black rectangles as wheels and the game
  crashes when I try to customize the wheels/spinners
</li><li>Selecting the customized car to customize doesn't change anything special, still only wheels
</li><li>Only the firetruck customization options can be selected
</li><li>Choosing a spoiler shows the spoiler in the center of the car
</li><li>When going out of a category (like Body parts),
  the car switches to the same car but the wheels at
  the position where they should be for the firetruck
</li><li>When going outside the customize menu now, the car's brand is a <code>*</code> symbol
</li><li>When going to a different car and back, the firetruck model shows
</li><li>Entering customization again hides the firetruck, only showing the wheels
  (the spoiler is gone?)
</li><li>After saving and undoing the swap and restarting the game, the saved car stays a firetruck
  (but the behavior is still the same as described above)
</li><li>Using the car to race makes the framerate go down significantly, except when in nose camera
  (you just see headlights driving without a vehicle body)
</li><li>It doesn't lag at all in the performance tuning
</li></ul><p class='center'><img src="FIRETRUCK-DYNO.JPG" alt="dyno chart"/><br/>Here's a dyno chart of the firetruck</p>
<p>While the firetruck is unused in the game,
I also tried to do this with the taxi, but it gave the same results.
Then I tried to replace it with a "normal" car, the Mustang.
</p><ul><li>Browsing a stock 240sx only shows black rectangles for wheels
</li><li>When selecting the car, it gets replaced with a mustang, and now I'm customizing a mustang
</li><li>The only change I can see is that there are no headlights or taillights
</li><li>Going ingame now only shows the front bumper of the car, which is the thing I customized
</li><li>Going back to the menu now shows the car with stock headlights and taillights
</li><li>Going ingame again now shows the car fully as it should
</li><li>Selecting a customized 240sx now shows the doors of a mustang
</li></ul><p class='center'><img src="MUSTANG.JPG" alt="driving invisible mustang"/><br/>Car?</p>
<p>The behavior isn't always the same, just give it a try and see for yourself.
Replacing the taxi with the ambulance just lags out the game whenever a taxi comes in sight.
</p><p>Check the function <code>SomeHashCS43DB50Print</code> in the file
<code><a href='https://github.com/yugecin/nfsu2-re/blob/master/nfsu2-re-hooks/hook-43DB50-hash-cs.c'>nfsu2-re-hooks/hook-43DB50-hash-cs.c</a></code> to see how I did this,
the code to replace cars is in comments.
</p><p style='margin-bottom:0'><a href='#index'>Index</a></p></div><span id='debugprint'></span><div><h2>Debug print <a href="#debugprint">#</a></h2>
<p>While scrolling through the data segment, I found these interesting strings:
</p><pre class='ida'><span class='comment'>.rdata:0079B160</span> <span class='ident'>aDeletingPackag</span> db <span class='str'>'Deleting package [%s]'</span>,<span class='num'>0Ah</span>,<span class='num'>0</span>
<span class='comment'>.rdata:0079B177</span>                 align <span class='num'>4</span>
<span class='comment'>.rdata:0079B178</span> <span class='ident'>aUnActivateXX</span>   db <span class='str'>'Un-Activate!!! %x %x'</span>,<span class='num'>0Ah</span>,<span class='num'>0</span>
<span class='comment'>.rdata:0079B18E</span>                 db <span class='num'>2</span> dup(<span class='num'>0</span>)
<span class='comment'>.rdata:0079B190</span> <span class='ident'>aWillBeUnloaded</span> db <span class='str'>'Will be unloaded [%s]'</span>,<span class='num'>0Ah</span>,<span class='num'>0</span>
</pre><p>Even more interesting is that these strings are using by pushing them on to the stack,
followed by a call to a specific proc that looks like this:
</p><pre class='ida'><span class='text'>.text:0050D510</span> <span class='ident'>sub_50D510  proc near</span>
<span class='text'>.text:0050D510</span>                 xor     eax, eax
<span class='text'>.text:0050D512</span>                 retn
<span class='text'>.text:0050D512</span> <span class='ident'>sub_50D510  endp</span>
</pre><p>It appears as if this used to be some kind of debug printf function, so I named it
<a class='funcref' href='#50D510'>sub_50D510_DebugPrint</a>. I hooked the function and made it output to a log file,
see <code><a href='https://github.com/yugecin/nfsu2-re/blob/master/nfsu2-re-hooks/replace-50D510-DebugPrint.c'>nfsu2-re-hooks/replace-50D510-DebugPrint.c</a></code>.
</p><p>It also seems to pass data that is not a pointer to a string. I'm guessing since the
implementation of this function was removed (and now just returns zero), and there
were probably other removed functions, so some calls that are supposed to be done
to different functions may now all point to this one function that also happened to
be used for the debug print stuff. My simple solution is to check if the first passed
argument points to memory in the data section, and print if so.
</p><p>I did a short session browsing customization options and performance tuning with this
enabled, the results can be seen in the log file
<a href="debugstring50D510.txt">debugstring50D510.txt</a>. Each line is formatted as
<code>debugstr\t50D510\tcallee\tstring\n</code>. Here is a 'small' excerpt:
</p><pre>DIALOG :: --------- ShowDialog -----------
DIALOG :: |_ Do you want to convert your trunk to carbon fiber?
DIALOG :: Oh shit - the control mask is zero.  This is bad.  Try to use Top Package's control mask.
DIALOG ::  |_ TopPackage = UI_GenericParts_Browser.fng, mask = 0.
DIALOG ::    |_ Crap - mask is zero, forcing to 0xff.
DIALOG :: Success : Control mask = 255, Handle = 2
DIALOG :: --------- ShowDialog Finished -----------
Init Package GenericDialog_SMALL.fng
DIALOG :: Constructor
Joy Event: FEPad_Accept[0]
Joy Event: FEPad_Accept[0]
Joy Event: FEPad_Back[1]
Joy Event: FEPad_Back[1]
DIALOG :: Tick, ReturnWithMessage Set, Dismissing: [GenericDialog_SMALL.fng] [b4623f67]
DIALOG :: DismissDialog.  Handle(2).  Current handle(2)
DIALOG ::  |_ Found, popping.
Queue popping GenericDialog_SMALL.fng
Will unload -----------GenericDialog_SMALL.fng------------------
Will be unloaded [GenericDialog_SMALL.fng]
DIALOG :: Closing, sending message (b4623f67) to (UI_GenericParts_Browser.fng).
Send message[b4623f67] to package [UI_GenericParts_Browser.fng]
Message was queued
Un-Activate!!! 37a52f0 37e69c0
Deleting package [GenericDialog_SMALL.fng]
package[GenericDialog_SMALL.fng] will unload
</pre><p>Most of the messages seem to be about dialogs, joy (keyboard) events,
FEng/fng packages (I'm guessing those are ui resources/designs?).
</p><p style='margin-bottom:0'><a href='#index'>Index</a></p></div><span id='ui'></span><div><h2>UI <a href="#ui">#</a></h2>
<p>Names with <code>.FNG</code> seem to be occuring a lot, it seems like that are UI
resources or some kind of UI widget descriptors.
</p><p>In text strings, <code>^</code> is a line feed (but <code>\n</code> might work as well, TODO).
</p><p>UI things seem to work on a <code>640x480</code> canvas.
Most things (especially when mouse is involved) seem to be positioned
<code>([-320,+320],[-240,+240])</code>.
</p><p style='margin-bottom:0'><a href='#index'>Index</a></p></div><span id='ui_dialog'></span><div class='indent' style='margin-left:5em'><p style='margin-top:0'><small><a href='#ui'>UI</a> &gt; Dialogs</small></p><h3>Dialogs <a href="#ui_dialog">#</a></h3>
<p>Thanks to the <a href='#debugprint'>Debug print</a> discovery, my attention got grabbed
by something that looked like dialog code. These leftover debug strings helped so much.
</p><p>Someone left a trace here:
</p><pre class='ida'><span class='text'>.text:005541FC</span>                 call    <a class='funcref' href='#4FF250'>Dialog__ctor</a>
<span class='text'>.text:00554201</span>                 push    offset <span class='ident'>aDialogConstruc</span> <span class='comment'>; "DIALOG :: Constructor\n"</span>
<span class='text'>.text:00554206</span>                 call    <a class='funcref' href='#50D510'>sub_50D510_DebugPrint</a>
</pre><p>One of the first thing <a class='funcref' href='#558020'>558020:ShowDialog()</a> does is calling <a class='funcref' href='#526C40'>526C40:GetFNGforDialog()</a>,
which looks like initializes the dialog maybe? One argument is passed, seemingly the
dialog name. But then it checks something at the passed dialog name <code>+324h</code>. Conclusion:
it's passing a struct with dialog info, of which the first member is the name.
</p><p style='margin-bottom:0'><a href='#index'>Index</a></p></div><span id='ui_dialog_getfngfordialog'></span><div class='indent' style='margin-left:10em'><p style='margin-top:0'><small><a href='#ui'>UI</a> &gt; <a href='#ui_dialog'>Dialogs</a> &gt; GetFNGForDialog</small></p><h4>GetFNGForDialog <a href="#ui_dialog_getfngfordialog">#</a></h4>
<p>This function is only used once, by the <a class='funcref' href='#558020'>558020:ShowDialog()</a> function. It checks
the value at <code>+324h</code>, which seems to be a pointer to a string,
looks like maybe a type of dialog?
It's checked if that value is either <code>NULL</code> or empty string or equal to
<code>animating</code> or <code>3button</code>. I decided to reimplement that function.
Fun fact: while doing this I managed to write an infinite loop which caused a BSOD.
</p><p>At the end I decided upon the name <a class='funcref' href='#526C40'>526C40:GetFNGforDialog()</a>. It returns a pointer
to a string that says what FNG to display for the dialog that was passed.
</p><p>The dialog info may already have the FNG set, this function will return that unless
it's not set or it's not either <code>animating</code> or <code>3button</code>.
</p><ul><li><code>HelpDialog_SMALL.fng</code> when <code><a href='#structDialogInfo_32D'>isHelpDialog</a></code> and text has less than 5 linebreaks
</li><li><code>HelpDialog_MED.fng</code> when <code><a href='#structDialogInfo_32D'>isHelpDialog</a></code> and text has more than 4 linebreaks
</li><li><code>GenericDialog_ThreeButton.fng</code> when <code><a href='#structDialogInfo_324'>myFNGName</a></code> is <code>3button</code>
</li><li><code>GenericDialog_SMALL.fng</code> when text width is <code>&lt; 2561.0f</code>
</li><li><code>GenericDialog_Animate_SMALL.fng</code> same as above, but when type is <code>animating</code>
</li><li><code>GenericDialog_MED.fng</code> when text width is <code>&lt; 5122.0f</code>
</li><li><code>GenericDialog_Animate_MED.fng</code> same as above, but when type is <code>animating</code>
</li><li><code>GenericDialog_LARGE.fng</code> if the other measurements didn't pass
</li><li><code>GenericDialog_Animate_LARGE.fng</code> same as above, but when type is <code>animating</code>
</li></ul><p>See the <code><a href='https://github.com/yugecin/nfsu2-re/blob/master/nfsu2-re-hooks/replace-526C40-GetFNGForDialog.c'>nfsu2-re-hooks/replace-526C40-GetFNGForDialog.c</a></code> function
for the complete reimplementation.
</p><p>Here's me messing with the returned value:
</p><p class='center'><img src="dialoghelp.jpg" alt="dialog"/><br/><code>HelpDialog_SMALL.fng</code></p>
<p class='center'><img src="dialoggenericmed.jpg" alt="dialog"/><br/><code>GenericDialog_MED.fng</code></p>
<p class='center'><img src="dialog3button.jpg" alt="dialog"/><br/><code>GenericDialog_ThreeButton.fng</code></p>
<p class='center'><img src="dialoganimate.gif" alt="dialog"/><br/><code>GenericDialog_Animate_SMALL.fng</code></p>
<p>I can't remember seeing this animate style dialog... But when adding some debug prints,
it seems like the online/LAN play uses this: <code>dialog 'Retrieving updated games
list^from the server...' has type animating</code> but that dialog disappears so fast
I probably never noticed it.
</p><p>Then I tried replacing it with something totally different,
<code>UI_GenericParts_Browser.fng</code>. I half expected the game to crash, so I was
surprised when it showed me this:
</p><p class='center'><img src="dialoggenericpartsbrowser.jpg" alt="main menu ui on splash screen"/><br/>:)</p>
<p>Seems like this is a nice place to test loading other screens. Some do crash, but
here's <code>UI_OLEAMessenger.fng</code>:
</p><p class='center'><img src="dialogoleamessenger.jpg" alt="online messenger menu with placeholder text"/><br/>No idea why that text is .. Spanish?</p>
<p>Printing the dialog info struct address sadly showed that it wasn't stored in the
executable itself so it's probably somewhere deep in a bin file.
</p><p style='margin-bottom:0'><a href='#index'>Index</a></p></div><div class='indent' style='margin-left:5em'><p style='margin-top:0'><small><a href='#ui'>UI</a> &gt; <a href='#ui_dialog'>Dialogs</a> (continuation)</small></p><p><code>DialogInfo</code> struct made by looking at all of the above and more:
(Especially <a class='funcref' href='#4FF250'>4FF250:Dialog__ctor()</a> helped here.)
</p><pre><span id='struct_DialogInfo'></span>struct DialogInfo {
	char <span id='structDialogInfo_0'></span>text[768];
	unsigned int <span id='structDialogInfo_300'></span>leftButtonLanguageString;
	unsigned int <span id='structDialogInfo_304'></span>leftButtonMessage;
	unsigned int <span id='structDialogInfo_308'></span>rightButtonLanguageString;
	unsigned int <span id='structDialogInfo_30C'></span>righttButtonMessage;
	unsigned int <span id='structDialogInfo_310'></span>middleButtonLanguageString;
	unsigned int <span id='structDialogInfo_314'></span>middleButtonMessage;
	int <span id='structDialogInfo_318'></span>field_318;
	int <span id='structDialogInfo_31C'></span>field_31C;
	char *<span id='structDialogInfo_320'></span>parentFNGName;
	char *<span id='structDialogInfo_324'></span>myFNGName;
	int <span id='structDialogInfo_328'></span>numButtons;
	char <span id='structDialogInfo_32C'></span>field_32C;
	char <span id='structDialogInfo_32D'></span>isHelpDialog;
	char <span id='structDialogInfo_32E'></span>field_32E;
	char <span id='structDialogInfo_32F'></span>textNeedsSomeWcharConversion; /*set to 0 in 55806D*/
	int <span id='structDialogInfo_330'></span>field_330; /*set to 0 in 558074*/
	int <span id='structDialogInfo_334'></span>field_334;
	int <span id='structDialogInfo_338'></span>field_338;
};
EXPECT_SIZE(<a href='#struct_DialogInfo'>struct DialogInfo</a>, 0x338);
ASSERT_OFFSET(<a href='#struct_DialogInfo'>struct DialogInfo</a>, <a href='#structDialogInfo_324'>myFNGName</a>, 0x324);
ASSERT_OFFSET(<a href='#struct_DialogInfo'>struct DialogInfo</a>, <a href='#structDialogInfo_32D'>isHelpDialog</a>, 0x32D);
</pre><p><strong>Symbols:</strong></p><ul><li><span class='func' id='4FF250'>4FF250 void __thiscall Dialog__ctor(<a href='#struct_DialogInfo'>struct DialogInfo</a> *this)</span>
  Initializes memory that was allocated to be a dialog.
</li><li><span class='func' id='526C40'>526C40 int GetFNGforDialog(<a href='#struct_DialogInfo'>struct DialogInfo</a> *dialog)</span>
  Returns a pointer to a string that says what FNG to display for the dialog that was passed.
  See <a href='#ui_dialog_getfngfordialog'>GetFNGForDialog</a>
</li><li><span class='func' id='540A60'>540A60 void DismissDialog(int dialogIdToDismiss)</span>
</li><li><span class='func' id='54C050'>54C050 int __thiscall DialogFNGMessageHandler(struct DialogFNGObject *this, int, int, int, int)</span>
</li><li><span class='func' id='5542A0'>5542A0 DialogFNGInitHandler</span>
</li><li><span class='func' id='558020'>558020 int ShowDialog(<a href='#struct_DialogInfo'>struct DialogInfo</a> *info)</span>
  Returns the new dialog id for it (value in <a class='fieldref' href='#838974'>838974:shownDialogId</a>) or zero when
  it didn't show because of some override.
</li><li><span class='func' id='5582A0'>5582A0 int ShowButtonlessFormattedDialogPtr(char *dialogParentFNGName,
                                               char *dialogFNGName,
                                               char *textFormat,
                                               void *textParameterPtr)</span>
  Calls <a class='funcref' href='#558020'>558020:ShowDialog()</a>.
</li><li><span class='func' id='558310'>558310 int ShowButtonlessFormattedDialog(char *dialogParentFNGName,
                                            char *dialogFNGName,
                                            char *textFormat,
                                            int textParameter)</span>
  Delegates to <a class='funcref' href='#5582A0'>5582A0:ShowButtonlessFormattedDialogPtr()</a>.
</li><li><span class='func' id='558330'>558330 int ShowButtonlessFormattedLanguageDialog(char *dialogParentFNGName,
                                                    char *dialogFNGName,
                                                    unsigned int textLanguageString,
                                                    int textParameter)</span>
  Delegates to <a class='funcref' href='#5582A0'>5582A0:ShowButtonlessFormattedDialogPtr()</a>.
</li><li><span class='func' id='558390'>558390 int ShowStandardFormattedErrorDialog(char *dialogParentFNGName,
                                               char *dialogFNGName,
                                               char *textFormat,
                                               void *textParameterPtr)</span>
  Calls <a class='funcref' href='#558020'>558020:ShowDialog()</a>.
  Uses <code>0x639(OK)</code> for <a href='#structDialogInfo_310'>middleButtonLanguageString</a>, <code>0x34DC1BEC</code> for <a href='#structDialogInfo_314'>middleButtonMessage</a>,
  <code>0xB4EDEB6D</code> for <a href='#structDialogInfo_318'>field_318</a>, <code>0</code> for <a href='#structDialogInfo_31C'>field_31C</a>,
  <code>1</code> for <a href='#structDialogInfo_328'>numButtons</a> and <a href='#structDialogInfo_32C'>field_32C</a>.
</li><li><span class='func' id='558430'>558430 int ShowStandardFormattedLanguageErrorDialog(char *dialogParentFNGName,
                                                       char *dialogFNGName,
                                                       unsigned int textFormatLanguageString,
                                                       int textParameter)</span>
  Delegates to <a class='funcref' href='#558390'>558390:ShowStandardFormattedErrorDialog()</a>.
</li><li><span class='func' id='558490'>558490 int ShowSingleButtonFormattedDialog318_32C(char *dialogParentFNGName,
                                                     char *dialogFNGName,
                                                     unsigned int middleButtonLanguageString,
                                                     unsigned int middleButtonMessage,
                                                     int dialogField318,
                                                     char byteDialogField32C,
                                                     char *textFormat,
                                                     void *textParameterPtr)</span>
  Calls <a class='funcref' href='#558020'>558020:ShowDialog()</a>.
  Uses <code>0</code> for <a href='#structDialogInfo_31C'>field_31C</a> and <code>1</code> for <a href='#structDialogInfo_328'>numButtons</a>.
</li><li><span class='func' id='558540'>558540 int ShowSingleButtonFormattedDialog318(char *dialogParentFNGName,
                                                 char *dialogFNGName,
                                                 unsigned int middleButtonLanguageString,
                                                 unsigned int middleButtonMessage,
                                                 int dialogField318,
                                                 char *textFormat,
                                                 int textParameter)</span>
  Delegates to <a class='funcref' href='#558490'>558490:ShowSingleButtonFormattedDialog318_32C()</a>.
  Uses <code>1</code> for <a href='#structDialogInfo_32C'>field_32C</a>.
</li><li><span class='func' id='558570'>558570 int ShowSingleButtonFormattedLanguageDialog318(char *dialogParentFNGName,
                                                         char *dialogFNGName,
                                                         unsigned int middleButtonLanguageString,
                                                         unsigned int middleButtonMessage,
                                                         int dialogField318,
                                                         unsigned int textLanguageString,
                                                         int textParameter)</span>
  Delegates to <a class='funcref' href='#558490'>558490:ShowSingleButtonFormattedDialog318_32C()</a>.
  Uses <code>1</code> for <a href='#structDialogInfo_32C'>field_32C</a>.
</li><li><span class='func' id='5585E0'>5585E0 int ShowSingleButtonFormattedDialog(char *dialogParentFNGName,
                                              char *dialogFNGName,
                                              unsigned int middleButtonLanguageString,
                                              unsigned int middleButtonMessage,
                                              char *textFormat,
                                              int textParameter)</span>
  Delegates to <a class='funcref' href='#558490'>558490:ShowSingleButtonFormattedDialog318_32C()</a>.
  Uses <code>0</code> for <a href='#structDialogInfo_318'>field_318</a> and <a href='#structDialogInfo_32C'>field_32C</a>.
</li><li><span class='func' id='558610'>558610 int ShowSingleButtonFormattedLanguageDialog(char *dialogParentFNGName,
                                                      char *dialogFNGName,
                                                      unsigned int middleButtonLanguageString,
                                                      unsigned int middleButtonMessage,
                                                      unsigned int textLanguageString,
                                                      int textParameter)</span>
  Delegates to <a class='funcref' href='#558490'>558490:ShowSingleButtonFormattedDialog318_32C()</a>.
  Uses <code>0</code> for <a href='#structDialogInfo_318'>field_318</a> and <a href='#structDialogInfo_32C'>field_32C</a>.
</li><li><span class='func' id='558680'>558680 int ShowTwoButtonFormattedDialog318_31C_32C(char *dialogParentFNGName,
                                                      char *dialogFNGName,
                                                      unsigned int leftButtonLanguageString,
                                                      unsigned int rightButtonLanguageString,
                                                      unsigned int leftButtonMessage,
                                                      unsigned int rightButtonMessage,
                                                      int dialogField318,
                                                      char dialogField_32C,
                                                      int dialogField_31C,
                                                      char *textFormat,
                                                      void *textParameterPtr)</span>
  Calls <a class='funcref' href='#558020'>558020:ShowDialog()</a>.
</li><li><span class='func' id='558750'>558750 int ShowTwoButtonFormattedDialog318_31C(char *dialogParentFNGName,
                                                  char *dialogFNGName,
                                                  unsigned int leftButtonLanguageString,
                                                  unsigned int rightButtonLanguageString,
                                                  unsigned int leftButtonMessage,
                                                  unsigned int rightButtonMessage,
                                                  int dialogField318,
                                                  int dialogField31C,
                                                  char *textFormat,
                                                  int textParameter)</span>
  Delegates to <a class='funcref' href='#558680'>558680:ShowTwoButtonFormattedDialog318_31C_32C()</a> with <code>1</code> for <a href='#structDialogInfo_32C'>field_32C</a>.
</li><li><span class='func' id='558790'>558790 int ShowTwoButtonFormattedLanguageDialog318_31C(char *dialogParentFNGName,
                                                          char *dialogFNGName,
                                                          unsigned int leftButtonLanguageString,
                                                          unsigned int rightButtonLanguageString,
                                                          unsigned int leftButtonMessage,
                                                          unsigned int rightButtonMessage,
                                                          int dialogField318,
                                                          int dialogField31C,
                                                          unsigned int textFormatLanguageString,
                                                          int textParameter)</span>
  Delegates to <a class='funcref' href='#558680'>558680:ShowTwoButtonFormattedDialog318_31C_32C()</a> with <code>1</code> for <a href='#structDialogInfo_32C'>field_32C</a>.
</li><li><span class='func' id='558820'>558820 int ShowTwoButtonFormattedDialog31C(int dialogParentFNGName,
                                              int dialogFNGName,
                                              unsigned int leftButtonLanguageString,
                                              unsigned int rightButtonLanguageString,
                                              unsigned int leftButtonMessage,
                                              unsigned int rightButtonMessage,
                                              int dialogField31C,
                                              char *textFormat,
                                              int textParameter)</span>
  Delegates to <a class='funcref' href='#558680'>558680:ShowTwoButtonFormattedDialog318_31C_32C()</a> with <code>0</code> for <a href='#structDialogInfo_318'>field_318</a> and <a href='#structDialogInfo_32C'>field_32C</a>.
</li><li><span class='func' id='558860'>558860 int ShowTwoButtonFormattedLanguageDialog31C(char *dialogParentFNGName,
                                                      char *dialogFNGName,
                                                      unsigned int leftButtonLanguageString,
                                                      unsigned int rightButtonLanguageString,
                                                      unsigned int leftButtonMessage,
                                                      unsigned int rightButtonMessage,
                                                      int dialogField31C,
                                                      char *textFormat,
                                                      int textParameter)</span>
  Delegates to <a class='funcref' href='#558680'>558680:ShowTwoButtonFormattedDialog318_31C_32C()</a> with <code>0</code> for <a href='#structDialogInfo_318'>field_318</a> and <a href='#structDialogInfo_32C'>field_32C</a>.
</li><li><span class='func' id='5588F0'>5588F0 int ShowThreeButtonFormattedDialog318_31C(char *dialogParentFNGName,
                                                    char *dialogFNGName,
                                                    unsigned int leftButtonLanguageString,
                                                    unsigned int rightButtonLanguageString,
                                                    unsigned int middleButtonLanguageString,
                                                    unsigned int leftButtonMessage,
                                                    unsigned int rightButtonMessage,
                                                    unsigned int middleButtonMessage,
                                                    int dialogField318,
                                                    int dialogField31C,
                                                    char *textFormat,
                                                    void *textParameterPtr)</span>
  Calls <a class='funcref' href='#558020'>558020:ShowDialog()</a> with <code>3</code> for <a href='#structDialogInfo_328'>numButtons</a>, <code>1</code> for <a href='#structDialogInfo_32C'>field_32C</a>.
</li><li><span class='func' id='5589D0'>5589D0 int ShowThreeButtonFormattedDialog318_31C(char *dialogParentFNGName,
                                                    char *dialogFNGName,
                                                    unsigned int leftButtonLanguageString,
                                                    unsigned int rightButtonLanguageString,
                                                    unsigned int middleButtonLanguageString,
                                                    unsigned int leftButtonMessage,
                                                    unsigned int rightButtonMessage,
                                                    unsigned int middleButtonMessage,
                                                    int dialogField318,
                                                    int dialogField31C,
                                                    char *textFormat,
                                                    int textParameter)</span>
  Delegates to <a class='funcref' href='#5588F0'>5588F0:ShowThreeButtonFormattedDialog318_31C()</a>.
</li><li><span class='func' id='558A20'>558A20 int ShowThreeButtonFormattedLanguageDialog318_31C(char *dialogParentFNGName,
                                                            char *dialogFNGName,
                                                            unsigned int leftButtonLanguageString,
                                                            unsigned int rightButtonLanguageString,
                                                            unsigned int middleButtonLanguageString,
                                                            unsigned int leftButtonMessage,
                                                            unsigned int rightButtonMessage,
                                                            unsigned int middleButtonMessage,
                                                            int dialogField318,
                                                            int dialogField31C,
                                                            unsigned int textFormatLanguageString,
                                                            int textParameter)</span>
  Delegates to <a class='funcref' href='#5588F0'>5588F0:ShowThreeButtonFormattedDialog318_31C()</a>.
</li><li><span class='func' id='558AC0'>558AC0 int ShowHelpDialog(char *dialogParentFNGName, char *dialogFNGName, unsigned int textLanguageString)</span>
  Calls <a class='funcref' href='#558020'>558020:ShowDialog()</a> with <code>1</code> for <a href='#structDialogInfo_328'>numButtons</a>, <a href='#structDialogInfo_32C'>field_32C</a>, <a href='#structDialogInfo_32D'>isHelpDialog</a>.
  Uses <code>0x639(OK)</code> for <a href='#structDialogInfo_310'>middleButtonLanguageString</a>, <code>0x34DC1BEC</code> for <a href='#structDialogInfo_314'>middleButtonMessage</a>,
  <code>0xB4EDEB6D</code> for <a href='#structDialogInfo_318'>field_318</a>, <code>0</code> for <a href='#structDialogInfo_31C'>field_31C</a>.
</li><li><span class='field' id='7F6DE0'>7F6DE0 int nextDialogId</span>
  When <a class='funcref' href='#558020'>558020:ShowDialog()</a> is called, value is put into <a class='fieldref' href='#838974'>838974:shownDialogId</a> and incremented.
</li><li><span class='field' id='838640'>838640 <a href='#struct_DialogInfo'>struct DialogInfo</a> shownDialogData</span>
  Dialog info passed to <a class='funcref' href='#558020'>558020:ShowDialog()</a> is copied into here, TODO xrefs
</li><li><span class='field' id='838960'>838960 char* shownDialogParent</span>
  Example value: <code>UI_PerformanceTuning_Setting.fng</code>.
</li><li><span class='field' id='838964'>838964 char* shownDialogType</span>
  Example value: <code>GenericDialog_MED.fng</code>.
</li><li><span class='field' id='838970'>838970 int dialogDismissedByOtherDialogMsg</span>
  Unsure yet.
</li><li><span class='field' id='838974'>838974 int shownDialogId</span>
  Zero when none.
</li></ul><p style='margin-bottom:0'><a href='#index'>Index</a></p></div><span id='fngthings'></span><div class='indent' style='margin-left:5em'><p style='margin-top:0'><small><a href='#ui'>UI</a> &gt; FNG things</small></p><h3>FNG things <a href="#fngthings">#</a></h3>
<p>Thanks to <a class='funcref' href='#558020'>558020:ShowDialog()</a> code, following things were discovered:
</p><pre><span id='struct_FNGShowData'></span>struct FNGShowData {
	char *fngname;
	int arg1;
	unsigned int helpTextLanguageString; /*set to {structFNGData+8}*/
	unsigned int helpBarMask; /*set to {structFNGData+C}*/
	int arg2;
};
EXPECT_SIZE(struct FNGMessage, 0x14);

typedef <a href='#struct_FNGShowData'>struct FNGShowData</a>* (<span id='fnginithandler'></span>fnginithandler)(<a href='#struct_FNGShowData'>struct FNGShowData</a> *msg);

<span id='struct_FNGData'></span>struct FNGData {
	char *name;
	<a href='#fnginithandler'>fnginithandler</a> *initializeHandler;
	unsigned int <span id='structFNGData_8'></span>helpTextLanguageString;
	unsigned int <span id='structFNGData_C'></span>helpBarMask;
	int field_10;
	int field_14;
	int field_18;
};
EXPECT_SIZE(struct FNGData, 0x1C);

<span id='struct_FNGInfo'></span>struct FNGInfo {
        int field_0;
        <a href='#struct_FNGInfo'>struct FNGInfo</a> *<span id='structFNGInfo_4'></span>child;
        int field_8;
        char *<span id='structFNGInfo_C'></span>fngName;
        unsigned int <span id='structFNGInfo_10'></span>hash;
        int field_14;
        int field_18;
        int controlMask;
        int field_20;
        int field_24;
        int field_28;
        int field_2C;
        int field_30;
        int field_34;
        int field_38;
        int field_3C;
        int field_40;
        int field_44;
        int field_48;
        <a href='#struct_UIElement'>struct UIElement</a> *<span id='structFNGInfo_4C'></span>rootUIElement;
};

<span id='struct_UIData'></span>struct UIData {
        /*TODO*/
        <a href='#struct_UIData_Field8'>struct UIData_Field8</a> *<span id='structUIData_8'></span>field_8;
};


<span id='struct_UIData_Field8'></span>struct UIData_Field8 {
        /*incomplete*/
        /*+E4*/
        <a href='#struct_FNGInfo'>struct FNGInfo</a> *<span id='structUIData_Field8_E4'></span>topPackage;
};

struct FNGData <a class='fieldref' href='#7F7DC8'>fngdata</a>[] = {
<details><summary>collapsed data</summary>
/*7F7DC8*/{ "UI_Main.fng", // 0
            0x4ED6B0,
            HELP_MAIN_MENU,
            BUTTON_PC_NAV_QUIT | BUTTON_PC_NAV_CONTINUE,
            0x0, 0x100, 0x0 },

/*7F7DE4*/{ "UI_OptionsMain.fng", // 1
            0x4EFDE0,
            HELP_OPTIONS_MAIN,
            BUTTON_PC_NAV_QUIT | BUTTON_PC_NAV_CONTINUE | BUTTON_PC_NAV_BACK,
            0x0, 0x80, 0x0 },

/*7F7E00*/{ "UI_Options.fng", // 2
            0x4E3710,
            HELP_OPTIONS,
            BUTTON_PC_NAV_QUIT | BUTTON_PC_NAV_BACK,
            0x0, 0x1CA, 0x0 },

/*7F7E1C*/{ "UI_Wheel_Options.fng", // 3
            0x4E3770,
            HELP_WHEEL,
            BUTTON_PC_NAV_QUIT | BUTTON_PC_NAV_BACK,
            0x0, 0x1CA, 0x0 },

/*7F7E38*/{ "UI_PC_Customize_Options.fng", // 4
            0x4E36B0,
            0,
            BUTTON_PC_NAV_QUIT | BUTTON_PC_NAV_BACK,
            0x0, 0x1CA, 0x0 },

/*7F7E54*/{ "UI_Options_PC_Controller.fng", // 5
            0x4F92E0,
            0,
            BUTTON_PC_NAV_QUIT | BUTTON_PC_NAV_BACK | BUTTON_DYNO_RESET_OR_PC_NAV_RESET_KEYS,
            0x0, 0x1CA, 0x0 },

/*7F7E70*/{ "UI_PC_LAN_ServerSelect.fng", // 6
            0x4FD4B0,
            0,
            BUTTON_PC_NAV_QUIT | BUTTON_PC_NAV_CONTINUE | BUTTON_PC_NAV_BACK | BUTTON_OL_HOST_LAN_SERVER,
            0x0, 0x1CA, 0x0 },

/*7F7E8C*/{ "UI_PC_LAN.fng", // 7
            0x4D6C90,
            0,
            BUTTON_PC_NAV_QUIT | BUTTON_PC_NAV_CONTINUE | BUTTON_PC_NAV_BACK,
            0x0, 0x1CA, 0x0 },

/*7F7EA8*/{ "UI_PC_Help_Bar.fng", // 8
            0x552280,
            0,
            0,
            0x0, 0x80, 0x0 },

/*7F7EC4*/{ "UI_Trailers.fng", // 9
            0x4CFB20,
            HELP_OPTIONS_TRAILERS,
            BUTTON_PC_NAV_QUIT | BUTTON_PC_NAV_BACK,
            0x0, 0x80, 0x0 },

/*7F7EE0*/{ "Credits.fng", // 10
            0x4B8720,
            HELP_OPTIONS_CREDITS,
            BUTTON_PC_NAV_QUIT | BUTTON_PC_NAV_BACK,
            0x0, 0x80, 0x0 },

/*7F7EFC*/{ "ScreenPrintf.fng", // 11
            0x0,
            0,
            0,
            0x0, 0x100, 0x1 },

/*7F7F18*/{ "loading_boot.fng", // 12
            0x0,
            0,
            0,
            0x0, 0x80, 0x2 },

/*7F7F34*/{ "UI_CareerCrib.fng", // 13
            0x4ED780,
            HELP_CRIB,
            BUTTON_PC_NAV_QUIT | BUTTON_PC_NAV_CONTINUE | BUTTON_PC_NAV_BACK,
            0x0, 0xC0, 0x0 },

/*7F7F50*/{ "UI_CribRewardOptionsMain.fng", // 14
            0x4ED7E0,
            HELP_CRIB_REWARD_OPTIONS,
            BUTTON_PC_NAV_QUIT | BUTTON_PC_NAV_CONTINUE | BUTTON_PC_NAV_BACK,
            0x0, 0xC0, 0x0 },

/*7F7F6C*/{ "UI_CareerCarSelect.fng", // 15
            0x4FC110,
            HELP_CRIB_CAR_SELECT,
            BUTTON_PC_NAV_QUIT | BUTTON_PC_NAV_CONTINUE | BUTTON_PC_NAV_BACK,
            0x0, 0xC0, 0x0 },

/*7F7F88*/{ "UI_StartCareer.fng", // 16
            0x4ED710,
            HELP_CAREER_OPTIONS,
            BUTTON_PC_NAV_QUIT | BUTTON_PC_NAV_CONTINUE | BUTTON_PC_NAV_BACK,
            0x0, 0xC0, 0x0 },

/*7F7FA4*/{ "UI_MagazineBack.fng", // 17
            0x554E60,
            0,
            0,
            0x0, 0xC0, 0x0 },

/*7F7FC0*/{ "UI_MagazineReward.fng", // 18
            0x56B140,
            0,
            0,
            0x0, 0xC0, 0x0 },

/*7F7FDC*/{ "UI_MagazineSelect.fng", // 19
            0x55B520,
            HELP_CRIB_MAGAZINE,
            BUTTON_PC_NAV_QUIT | BUTTON_PC_NAV_CONTINUE | BUTTON_PC_NAV_BACK,
            0x0, 0xC0, 0x0 },

/*7F7FF8*/{ "UI_MagazineView.fng", // 20
            0x554EC0,
            0,
            0,
            0x0, 0xC0, 0x0 },

/*7F8014*/{ "UI_RewardsSponsor.fng", // 21
            0x4ED840,
            HELP_CRIB_REWARD_SPONSORS,
            BUTTON_PC_NAV_QUIT | BUTTON_PC_NAV_BACK,
            0x0, 0xC0, 0x0 },

/*7F8030*/{ "UI_CareerWorldMap.fng", // 22
            0x4F9D30,
            HELP_CRIB_WORLD_MAP,
            BUTTON_PC_NAV_QUIT | BUTTON_PC_NAV_BACK | LAYOUT_WORLDMAP_POSITION,
            0x0, 0x80, 0x0 },

/*7F804C*/{ "UI_Status_Master.fng", // 23
            0x4E1B80,
            0,
            BUTTON_PC_NAV_BACK | LAYOUT_WORLDMAP_POSITION | LAYOUT_ONE_LINE_NO_BG,
            0x0, 0x80, 0x0 },

/*7F8068*/{ "UI_Status_Career.fng", // 24
            0x4EEB10,
            0,
            0,
            0x0, 0x80, 0x0 },

/*7F8084*/{ "UI_Status_Region.fng", // 25
            0x4B1C90,
            0,
            0,
            0x0, 0x80, 0x0 },

/*7F80A0*/{ "UI_Status_DVD.fng", // 26
            0x4B1D90,
            0,
            0,
            0x0, 0x80, 0x0 },

/*7F80BC*/{ "EA_Trax_Jukebox.fng", // 27
            0x554F20,
            HELP_OPTIONS_EATRAX,
            BUTTON_PC_NAV_QUIT | BUTTON_PC_NAV_BACK,
            0x0, 0x80, 0x0 },

/*7F80D8*/{ "UI_Menu_Asset_Reputation.fng", // 28
            0x553B00,
            0,
            0,
            0x0, 0x80, 0x0 },

/*7F80F4*/{ "UI_CareerCarLot.fng", // 29
            0x4FC0B0,
            HELP_CAREER_CARLOT,
            BUTTON_PC_NAV_QUIT | BUTTON_PC_NAV_CONTINUE | BUTTON_PC_NAV_BACK,
            0x0, 0xC0, 0x0 },

/*7F8110*/{ "UI_EngageEventDialog.fng", // 30
            0x4CE650,
            0,
            0,
            0x0, 0xC0, 0x0 },

/*7F812C*/{ "UI_EngageRaceDialog.fng", // 31
            0x4E34A0,
            0,
            0,
            0x0, 0xC0, 0x0 },

/*7F8148*/{ "UI_EngageShopDialog.fng", // 32
            0x4CE6B0,
            0,
            0,
            0x0, 0xC0, 0x0 },

/*7F8164*/{ "UI_Showcase_Preview.fng", // 33
            0x4E3500,
            0,
            0,
            0x0, 0xC0, 0x0 },

/*7F8180*/{ "UI_Showcase_DPAD.fng", // 34
            0x4CF5C0,
            0,
            0,
            0x0, 0xC0, 0x0 },

/*7F819C*/{ "IG_PlayMovie.fng", // 35
            0x554E00,
            0,
            0,
            0x0, 0xC0, 0x0 },

/*7F81B8*/{ "UI_Pause.fng", // 36
            0x4F4790,
            0,
            BUTTON_PC_NAV_CONTINUE | BUTTON_PC_NAV_BACK | LAYOUT_ONE_LINE_NO_BG | LAYOUT_PAUSEMENU_POSITION,
            0x0, 0xC0, 0x0 },

/*7F81D4*/{ "UI_PauseOptionsMain.fng", // 37
            0x4F47F0,
            0,
            BUTTON_PC_NAV_CONTINUE | BUTTON_PC_NAV_BACK | LAYOUT_ONE_LINE_NO_BG | LAYOUT_PAUSEMENU_POSITION,
            0x0, 0x80, 0x0 },

/*7F81F0*/{ "UI_PauseOptions.fng", // 38
            0x4EB650,
            0,
            BUTTON_PC_NAV_BACK | LAYOUT_ONE_LINE_NO_BG,
            0x0, 0x440, 0x0 },

/*7F820C*/{ "UI_ReplayControl.fng", // 39
            0x4D7AD0,
            0,
            0,
            0x0, 0x80, 0x0 },

/*7F8228*/{ "HUD_SingleRace.fng", // 40
            0x0,
            0,
            0,
            0x0, 0x168, 0x1 },

/*7F8244*/{ "HUD_Drift.fng", // 41
            0x0,
            0,
            0,
            0x0, 0x80, 0x1 },

/*7F8260*/{ "HUD_Drag.fng", // 42
            0x0,
            0,
            0,
            0x0, 0x80, 0x1 },

/*7F827C*/{ "UI_InGame_WorldMap.fng", // 43
            0x4F9C10,
            0,
            BUTTON_PC_NAV_BACK | LAYOUT_WORLDMAP_POSITION | LAYOUT_ONE_LINE_NO_BG,
            0x0, 0x80, 0x0 },

/*7F8298*/{ "UI_EngageMessageDialog.fng", // 44
            0x4B2240,
            0,
            BUTTON_PC_NAV_CONTINUE | BUTTON_PC_NAV_BACK | LAYOUT_WORLDMAP_POSITION | LAYOUT_ONE_LINE_NO_BG,
            0x0, 0x80, 0x0 },

/*7F82B4*/{ "UI_SMS_Mailbox.fng", // 45
            0x4E2050,
            0,
            BUTTON_PC_NAV_READ_MESSAGE | BUTTON_PC_NAV_BACK | BUTTON_PC_NAV_DELETE | LAYOUT_WORLDMAP_POSITION | LAYOUT_ONE_LINE_NO_BG,
            0x0, 0x80, 0x0 },

/*7F82D0*/{ "GarageMain.fng", // 46
            0x4EB130,
            0,
            0,
            0x0, 0x80, 0x0 },

/*7F82EC*/{ "DiscError.fng", // 47
            0x5522D0,
            0,
            0,
            0x0, 0x80, 0x0 },

/*7F8308*/{ "GenericDialog.fng", // 48
            0x0,
            0,
            0,
            0x0, 0x80, 0x0 },

/*7F8324*/{ "GenericDialog_LARGE.fng", // 49
            0x0,
            0,
            0,
            0x0, 0x80, 0x0 },

/*7F8340*/{ "GenericDialog_MED.fng", // 50
            0x0,
            0,
            0,
            0x0, 0x80, 0x0 },

/*7F835C*/{ "GenericDialog_SMALL.fng", // 51
            0x0,
            0,
            0,
            0x0, 0x80, 0x0 },

/*7F8378*/{ "GenericDialog_Animate_LARGE.fng", // 52
            0x0,
            0,
            0,
            0x0, 0x80, 0x0 },

/*7F8394*/{ "GenericDialog_Animate_MED.fng", // 53
            0x0,
            0,
            0,
            0x0, 0x80, 0x0 },

/*7F83B0*/{ "GenericDialog_Animate_SMALL.fng", // 54
            0x0,
            0,
            0,
            0x0, 0x80, 0x0 },

/*7F83CC*/{ "GenericDialog_ThreeButton.fng", // 55
            0x0,
            0,
            0,
            0x0, 0x80, 0x0 },

/*7F83E8*/{ "IG_GenericDialog_LARGE.fng", // 56
            0x0,
            0,
            0,
            0x0, 0x80, 0x0 },

/*7F8404*/{ "IG_GenericDialog_MED.fng", // 57
            0x0,
            0,
            0,
            0x0, 0x80, 0x0 },

/*7F8420*/{ "IG_GenericDialog_SMALL.fng", // 58
            0x0,
            0,
            0,
            0x0, 0x80, 0x0 },

/*7F843C*/{ "HelpDialog_LARGE.fng", // 59
            0x0,
            0,
            0,
            0x0, 0x80, 0x0 },

/*7F8458*/{ "HelpDialog_MED.fng", // 60
            0x0,
            0,
            0,
            0x0, 0x80, 0x0 },

/*7F8474*/{ "HelpDialog_SMALL.fng", // 61
            0x0,
            0,
            0,
            0x0, 0x80, 0x0 },

/*7F8490*/{ "GenericerDialog.fng", // 62
            0x0,
            0,
            0,
            0x0, 0x80, 0x0 },

/*7F84AC*/{ "MU_QRTransmissionSelect.fng", // 63
            0x0,
            0,
            0,
            0x0, 0x80, 0x0 },

/*7F84C8*/{ "MU_QuickRaceCarSelect.fng", // 64
            0x4EB1A0,
            0,
            0,
            0x0, 0x80, 0x0 },

/*7F84E4*/{ "Chyron_FE.fng", // 65
            0x4CB180,
            0,
            0,
            0x0, 0x80, 0x0 },

/*7F8500*/{ "Chyron_IG.fng", // 66
            0x4CB180,
            0,
            0,
            0x0, 0x80, 0x0 },

/*7F851C*/{ "UI_DebugTest.fng", // 67
            0x4B89B0,
            0,
            0,
            0x0, 0x80, 0x0 },

/*7F8538*/{ "UI_InGameDialog.fng", // 68
            0x0,
            0,
            0,
            0x0, 0x80, 0x0 },

/*7F8554*/{ "UI_VirtualKeyboard.fng", // 69
            0x4EFD40,
            HELP_VIRTUAL_KEYBOARD,
            0,
            0x0, 0x258, 0x0 },

/*7F8570*/{ "UI_QRModeSelect.fng", // 70
            0x4EF280,
            HELP_QR_MODE_SELECT,
            BUTTON_PC_NAV_QUIT | BUTTON_PC_NAV_CONTINUE | BUTTON_PC_NAV_BACK,
            0x0, 0x80, 0x0 },

/*7F858C*/{ "UI_QRModeOptions.fng", // 71
            0x4FA550,
            HELP_QR_MODE_OPTIONS,
            BUTTON_PC_NAV_QUIT | BUTTON_PC_NAV_CONTINUE | BUTTON_PC_NAV_BACK,
            0x0, 0x200, 0x0 },

/*7F85A8*/{ "UI_QRTrackSelect.fng", // 72
            0x4EF9B0,
            HELP_TRACK_SELECT,
            BUTTON_PC_NAV_QUIT | BUTTON_PC_NAV_CONTINUE | BUTTON_PC_NAV_BACK,
            0x0, 0x80, 0x0 },

/*7F85C4*/{ "UI_QRCarSelect.fng", // 73
            0x4FC190,
            HELP_QR_CAR_SELECT,
            BUTTON_PC_NAV_QUIT | BUTTON_PC_NAV_CONTINUE | BUTTON_PC_NAV_BACK | BUTTON_PC_NAV_CUSTOMIZE,
            0x0, 0x100, 0x0 },

/*7F85E0*/{ "UI_OLCarSelect.fng", // 74
            0x4FC190,
            HELP_OL_CAR_SELECT,
            BUTTON_PC_NAV_QUIT | BUTTON_PC_NAV_CONTINUE | BUTTON_PC_NAV_BACK | BUTTON_PC_NAV_CUSTOMIZE,
            0x0, 0x100, 0x0 },

/*7F85FC*/{ "2P_PressStart.fng", // 75
            0x4CCED0,
            0,
            0,
            0x0, 0x100, 0x0 },

/*7F8618*/{ "UI_DebugCarCustomize.fng", // 76
            0x554A00,
            0,
            BUTTON_PC_NAV_QUIT | BUTTON_PC_NAV_CONTINUE | BUTTON_PC_NAV_BACK,
            0x0, 0x80, 0x0 },

/*7F8634*/{ "UI_ChooseCustomizeCategory.fng", // 77
            0x5591E0,
            HELP_SHOP_SELECT,
            BUTTON_PC_NAV_QUIT | BUTTON_PC_NAV_CONTINUE | BUTTON_PC_NAV_BACK,
            0x0, 0x80, 0x0 },

/*7F8650*/{ "UI_ChoosePerformanceCategory.fng", // 78
            0x559C30,
            HELP_PERFORMANCE_SHOP_MAIN,
            BUTTON_PC_NAV_QUIT | BUTTON_PC_NAV_CONTINUE | BUTTON_PC_NAV_BACK,
            0x0, 0x80, 0x0 },

/*7F866C*/{ "UI_GenericParts_Browser.fng", // 79
            0x566430,
            HELP_CRIB_CHANGEPARTS_MAIN,
            BUTTON_PC_NAV_QUIT | BUTTON_PC_NAV_CONTINUE | BUTTON_PC_NAV_BACK,
            0xFFFFFFFF, 0x80, 0x0 },

/*7F8688*/{ "UI_ChoosePaintCategory.fng", // 80
            0x55A400,
            HELP_GRAPHICS_SHOP_MAIN,
            BUTTON_PC_NAV_QUIT | BUTTON_PC_NAV_CONTINUE | BUTTON_CANCEL_CHANGES | BUTTON_PC_NAV_BACK,
            0x0, 0x80, 0x0 },

/*7F86A4*/{ "UI_ChoosePerformancePackage.fng", // 81
            0x55C8D0,
            HELP_PERFORMANCE_SHOP_MAIN,
            BUTTON_PC_NAV_QUIT | BUTTON_PC_NAV_INSTALL_PACKAGE | BUTTON_PC_NAV_BACK,
            0x0, 0x80, 0x0 },

/*7F86C0*/{ "UI_BuyPerformanceParts.fng", // 82
            0x56C150,
            HELP_PERFORMANCE_SHOP_PART_SELECT,
            BUTTON_PC_NAV_QUIT | BUTTON_PC_NAV_INSTALL_PART | BUTTON_PC_NAV_BACK,
            0x0, 0x80, 0x0 },

/*7F86DC*/{ "UI_PerformanceBrandSelect.fng", // 83
            0x554B80,
            0,
            BUTTON_PC_NAV_QUIT | BUTTON_PC_NAV_CONTINUE,
            0x0, 0x80, 0x0 },

/*7F86F8*/{ "UI_Paint.fng", // 84
            0x56C1B0,
            HELP_GRAPHICS_SHOP_PAINT_SELECT,
            BUTTON_PC_NAV_QUIT | BUTTON_PC_NAV_CONTINUE | BUTTON_PC_NAV_BACK,
            0x0, 0x80, 0x0 },

/*7F8714*/{ "UI_ChooseVinylLayer.fng", // 85
            0x555440,
            HELP_GRAPHICS_SHOP_VINYL_LAYER_SELECT,
            BUTTON_PC_NAV_QUIT | BUTTON_PC_NAV_CONTINUE | BUTTON_PC_NAV_BACK,
            0x0, 0x80, 0x0 },

/*7F8730*/{ "UI_ChooseUniquePart.fng", // 86
            0x554B20,
            HELP_UNIQUES_BROWSER,
            BUTTON_PC_NAV_QUIT | BUTTON_PC_NAV_INSTALL_PART | BUTTON_PC_NAV_BACK,
            0x0, 0x80, 0x0 },

/*7F874C*/{ "UI_DecalMain.fng", // 87
            0x554AC0,
            HELP_GRAPHICS_SHOP_DECAL_SELECT_CATEGORY,
            BUTTON_PC_NAV_QUIT | BUTTON_PC_NAV_CONTINUE | BUTTON_PC_NAV_BACK,
            0x0, 0x80, 0x0 },

/*7F8768*/{ "UI_DecalsOverlay.fng", // 88
            0x56B900,
            0,
            BUTTON_PC_NAV_QUIT | BUTTON_PC_NAV_CONTINUE | BUTTON_PC_NAV_BACK,
            0x0, 0x80, 0x0 },

/*7F8784*/{ "UI_DecalsOverlayInvis.fng", // 89
            0x56B900,
            0,
            0,
            0x0, 0x80, 0x0 },

/*7F87A0*/{ "UI_ChooseCustomHUD.fng", // 90
            0x554DA0,
            HELP_CHANGE_HUD_COLOR,
            BUTTON_PC_NAV_QUIT | BUTTON_PC_NAV_CONTINUE | BUTTON_PC_NAV_BACK,
            0x0, 0x80, 0x0 },

/*7F87BC*/{ "UI_ChooseRimBrand.fng", // 91
            0x554A60,
            HELP_BODY_SHOP_MAIN,
            BUTTON_PC_NAV_QUIT | BUTTON_PC_NAV_CONTINUE | BUTTON_PC_NAV_BACK,
            0x0, 0x80, 0x0 },

/*7F87D8*/{ "UI_Rims_Browser.fng", // 92
            0x56B350,
            HELP_BODY_SHOP_MAIN,
            BUTTON_PC_NAV_QUIT | BUTTON_PC_NAV_CONTINUE | BUTTON_PC_NAV_BACK,
            0x0, 0x80, 0x0 },

/*7F87F4*/{ "UI_ChooseSpinner.fng", // 93
            0x56C0F0,
            HELP_BODY_SHOP_MAIN,
            BUTTON_PC_NAV_QUIT | BUTTON_PC_NAV_CONTINUE | BUTTON_PC_NAV_BACK,
            0x0, 0x80, 0x0 },

/*7F8810*/{ "UI_PerformanceDyno_MAIN.fng", // 94
            0x55D7F0,
            0,
            BUTTON_PC_NAV_CONTINUE | BUTTON_PC_NAV_BACK,
            0x0, 0x100, 0x0 },

/*7F882C*/{ "UI_PerformanceTuning_Master.fng", // 95
            0x55D8B0,
            0,
            BUTTON_PC_NAV_CONTINUE | BUTTON_PC_NAV_BACK,
            0x0, 0x80, 0x0 },

/*7F8848*/{ "UI_PerformanceTuning_Graph.fng", // 96
            0x55DB70,
            0,
            BUTTON_PC_NAV_BACK | BUTTON_DYNO_RESET_OR_PC_NAV_RESET_KEYS | BUTTON_DYNO_TIP,
            0x0, 0x100, 0x0 },

/*7F8864*/{ "UI_PerformanceTuning_NOS.fng", // 97
            0x55DB70,
            0,
            BUTTON_PC_NAV_BACK | BUTTON_DYNO_RESET_OR_PC_NAV_RESET_KEYS | BUTTON_DYNO_TIP,
            0x0, 0x100, 0x0 },

/*7F8880*/{ "UI_PerformanceTuning_Sliders.fng", // 98
            0x55DB10,
            0,
            BUTTON_PC_NAV_BACK | BUTTON_DYNO_RESET_OR_PC_NAV_RESET_KEYS,
            0x0, 0x100, 0x0 },

/*7F889C*/{ "UI_PerformanceTuning_Drivetrain.fng", // 99
            0x55DB10,
            0,
            BUTTON_PC_NAV_BACK | BUTTON_DYNO_RESET_OR_PC_NAV_RESET_KEYS | BUTTON_DYNO_TIP,
            0x0, 0x100, 0x0 },

/*7F88B8*/{ "UI_PerformanceTuning_Setting.fng", // 100
            0x55D850,
            0,
            BUTTON_PC_NAV_CONTINUE | BUTTON_PC_NAV_BACK,
            0x0, 0x100, 0x0 },

/*7F88D4*/{ "UI_PerformanceDyno_Chart.fng", // 101
            0x55AF20,
            0,
            BUTTON_PC_NAV_CONTINUE,
            0x0, 0x100, 0x0 },

/*7F88F0*/{ "UI_PerformanceDyno_Results.fng", // 102
            0x55AF80,
            0,
            BUTTON_PC_NAV_CONTINUE | BUTTON_PC_NAV_BACK,
            0x0, 0x100, 0x0 },

/*7F890C*/{ "UI_ICEMAIN.fng", // 103
            0x560550,
            HELP_CARSPECIALTIES_SHOP_MAIN,
            BUTTON_PC_NAV_QUIT | BUTTON_PC_NAV_CONTINUE | BUTTON_PC_NAV_BACK,
            0x0, 0x100, 0x0 },

/*7F8928*/{ "UI_IcePartsOverlay.fng", // 104
            0x56C3C0,
            0,
            BUTTON_PC_NAV_QUIT | BUTTON_PC_NAV_INSTALL_PART | BUTTON_PC_NAV_BACK,
            0x0, 0x100, 0x0 },

/*7F8944*/{ "UI_CustomNeonMain.fng", // 105
            0x554C40,
            0,
            BUTTON_PC_NAV_QUIT | BUTTON_PC_NAV_CONTINUE | BUTTON_PC_NAV_BACK,
            0x0, 0x100, 0x0 },

/*7F8960*/{ "UI_NeonPartsOverlay.fng", // 106
            0x554BE0,
            0,
            BUTTON_PC_NAV_QUIT | BUTTON_PC_NAV_INSTALL_PART | BUTTON_PC_NAV_BACK,
            0x0, 0x100, 0x0 },

/*7F897C*/{ "UI_CustomHUDOverlay.fng", // 107
            0x56C420,
            HELP_HUD_SELECT,
            BUTTON_PC_NAV_QUIT | BUTTON_PC_NAV_INSTALL_PART | BUTTON_PC_NAV_BACK,
            0x0, 0x100, 0x0 },

/*7F8998*/{ "UI_PostRaceResults.fng", // 108
            0x4FBB60,
            0,
            BUTTON_PC_NAV_CONTINUE | LAYOUT_ONE_LINE_NO_BG | LAYOUT_RIGHT_POSITION,
            0x0, 0x80, 0x0 },

/*7F89B4*/{ "UI_PostRaceReward.fng", // 109
            0x4D72F0,
            0,
            BUTTON_PC_NAV_CONTINUE | BUTTON_PC_NAV_BACK,
            0x0, 0x80, 0x0 },

/*7F89D0*/{ "UI_SponsorPopup.fng", // 110
            0x4C1280,
            0,
            BUTTON_PC_NAV_BACK,
            0x0, 0x80, 0x0 },

/*7F89EC*/{ "UI_Sponsorship_new.fng", // 111
            0x4F4730,
            0,
            BUTTON_PC_NAV_BACK,
            0x0, 0x80, 0x0 },

/*7F8A08*/{ "UI_PostRace_TournResults.fng", // 112
            0x4FBF00,
            0,
            BUTTON_PC_NAV_CONTINUE | LAYOUT_ONE_LINE_NO_BG | LAYOUT_RIGHT_POSITION,
            0x0, 0x80, 0x0 },

/*7F8A24*/{ "UI_PostRace_TournStandings.fng", // 113
            0x4FBF60,
            0,
            BUTTON_PC_NAV_CONTINUE,
            0x0, 0x80, 0x0 },

/*7F8A40*/{ "UI_PostRaceStats.fng", // 114
            0x4FD6C0,
            0,
            BUTTON_PC_NAV_BACK | LAYOUT_ONE_LINE_NO_BG,
            0x0, 0x80, 0x0 },

/*7F8A5C*/{ "UI_PostRace.fng", // 115
            0x4F3940,
            0,
            BUTTON_PC_NAV_CONTINUE | BUTTON_PC_NAV_BACK | LAYOUT_ONE_LINE_NO_BG | LAYOUT_PAUSEMENU_POSITION,
            0x0, 0x80, 0x0 },

/*7F8A78*/{ "MU_PostRaceConfirm.fng", // 116
            0x0,
            0,
            0,
            0x0, 0x80, 0x0 },

/*7F8A94*/{ "LS_BlankMovie.fng", // 117
            0x4A8AD0,
            0,
            0,
            0x0, 0x80, 0x0 },

/*7F8AB0*/{ "LS_EALogo.fng", // 118
            0x4A89D0,
            0,
            0,
            0x0, 0x80, 0x0 },

/*7F8ACC*/{ "MW_LS_IntroFMV.fng", // 119
            0x4C52D0,
            0,
            0,
            0x0, 0x80, 0x0 },

/*7F8AE8*/{ "MW_LS_Splash.fng", // 120
            0x4C5500,
            0,
            0,
            0x0, 0x80, 0x0 },

/*7F8B04*/{ "UG_LS_IntroFMV.fng", // 121
            0x4C52D0,
            0,
            0,
            0x0, 0x80, 0x0 },

/*7F8B20*/{ "UG_LS_Splash.fng", // 122
            0x4C5500,
            0,
            0,
            0x0, 0x80, 0x0 },

/*7F8B3C*/{ "LS_THXMovie.fng", // 123
            0x4A8D90,
            0,
            0,
            0x0, 0x80, 0x0 },

/*7F8B58*/{ "LS_PSAMovie.fng", // 124
            0x4A8C60,
            0,
            0,
            0x0, 0x80, 0x0 },

/*7F8B74*/{ "LS_Demo_Legal.fng", // 125
            0x4C50C0,
            0,
            0,
            0x0, 0x80, 0x0 },

/*7F8B90*/{ "LS_Demo_PSA.fng", // 126
            0x4A8EC0,
            0,
            0,
            0x0, 0x80, 0x0 },

/*7F8BAC*/{ "LS_Demo_ESRB.fng", // 127
            0x4A8F50,
            0,
            0,
            0x0, 0x80, 0x0 },

/*7F8BC8*/{ "LS_Demo_Warning.fng", // 128
            0x4A9080,
            0,
            0,
            0x0, 0x80, 0x0 },

/*7F8BE4*/{ "UI_EngageMessageDialog.fng", // 129
            0x4B2240,
            0,
            BUTTON_PC_NAV_BACK | BUTTON_PC_NAV_DELETE | LAYOUT_ONE_LINE_NO_BG,
            0x0, 0x80, 0x0 },

/*7F8C00*/{ "", // 130
            0x4D9480,
            0,
            0,
            0x0, 0x80, 0x0 },

/*7F8C1C*/{ "LS_LangSelect.fng", // 131
            0x4F48A0,
            0,
            0,
            0x0, 0x80, 0x0 },

/*7F8C38*/{ "LS_Chinese_Health.fng", // 132
            0x4A87E0,
            0,
            0,
            0x0, 0x80, 0x0 },

/*7F8C54*/{ "UI_OL_Disconnect.fng", // 133
            0x4D0390,
            0,
            0,
            0x0, 0x80, 0x0 },

/*7F8C70*/{ "UI_OL_Disconnect_BG.fng", // 134
            0x4D03F0,
            0,
            0,
            0x0, 0x80, 0x0 },

/*7F8C8C*/{ "UI_OL_WebOffer.fng", // 135
            0x49D550,
            0,
            0,
            0x0, 0x80, 0x0 },

/*7F8CA8*/{ "UI_OL_WebOffer2.fng", // 136
            0x4B9E80,
            0,
            0,
            0x0, 0x0, 0x0 },

/*7F8CC4*/{ "UI_OL_News.fng", // 137
            0x49D4F0,
            0,
            0,
            0x0, 0x80, 0x0 },

/*7F8CE0*/{ "UI_OLLobbyRoom.fng", // 138
            0x4FA990,
            HELP_OL_LOBBY,
            0,
            0x0, 0x200, 0x0 },

/*7F8CFC*/{ "UI_OLGameRoom.fng", // 139
            0x4F1820,
            HELP_OL_GAMEROOM,
            0,
            0x0, 0x200, 0x0 },

/*7F8D18*/{ "UI_OLGameRoom_host.fng", // 140
            0x4F1880,
            0,
            0,
            0x0, 0x200, 0x0 },

/*7F8D34*/{ "UI_OLGameRoom_client.fng", // 141
            0x4F18E0,
            0,
            0,
            0x0, 0x200, 0x0 },

/*7F8D50*/{ "UI_OLPreRaceStart.fng", // 142
            0x4D3430,
            0,
            0,
            0x0, 0x80, 0x0 },

/*7F8D6C*/{ "UI_OL_ViewCar.fng", // 143
            0x4FB260,
            HELP_OL_VIEWCAR,
            BUTTON_PC_NAV_BACK,
            0x0, 0x100, 0x0 },

/*7F8D88*/{ "UI_OL_ViewTrack.fng", // 144
            0x4FB2C0,
            HELP_OL_VIEWTRACK,
            BUTTON_PC_NAV_BACK,
            0x0, 0x80, 0x0 },

/*7F8DA4*/{ "UI_OLCarLot.fng", // 145
            0x4FD450,
            HELP_OL__TRADECAR_MAIN,
            BUTTON_PC_NAV_QUIT | BUTTON_PC_NAV_CONTINUE | BUTTON_PC_NAV_BACK,
            0x0, 0x80, 0x0 },

/*7F8DC0*/{ "UI_OLMAIN.fng", // 146
            0x4F1940,
            HELP_OL_MAIN_MENU,
            BUTTON_PC_NAV_QUIT | BUTTON_PC_NAV_CONTINUE | BUTTON_PC_NAV_BACK | BUTTON_PC_NAV_EA_MESSENGER,
            0x0, 0x80, 0x0 },

/*7F8DDC*/{ "UI_OLFilters.fng", // 147
            0x4E6530,
            0,
            BUTTON_PC_NAV_QUIT | BUTTON_PC_NAV_CONTINUE | BUTTON_PC_NAV_BACK | BUTTON_PC_NAV_EA_MESSENGER,
            0x0, 0x80, 0x0 },

/*7F8DF8*/{ "PC_OL_Lobby.fng", // 148
            0x4FA990,
            0,
            BUTTON_PC_NAV_QUIT | BUTTON_PC_NAV_BACK | BUTTON_PC_NAV_EA_MESSENGER,
            0x0, 0x80, 0x0 },

/*7F8E14*/{ "PC_OL_GameRoom.fng", // 149
            0x4F1820,
            HELP_OL_GAME_ROOM,
            BUTTON_PC_NAV_BACK | BUTTON_PC_NAV_EA_MESSENGER,
            0x0, 0x200, 0x0 },

/*7F8E30*/{ "UI_OLPassword.fng", // 150
            0x4E42C0,
            0,
            0,
            0x0, 0x80, 0x0 },

/*7F8E4C*/{ "UI_OLRankings_Personal.fng", // 151
            0x4F1BC0,
            HELP_OL_PERSONAL_RANK,
            BUTTON_PC_NAV_QUIT | BUTTON_PC_NAV_BACK | BUTTON_PC_NAV_EA_MESSENGER,
            0x0, 0x80, 0x0 },

/*7F8E68*/{ "UI_OLRankings_Overall.fng", // 152
            0x4FB1A0,
            HELP_OL_OVERALL_RANK,
            BUTTON_PC_NAV_QUIT | BUTTON_PC_NAV_CONTINUE | BUTTON_PC_NAV_BACK | BUTTON_PC_NAV_EA_MESSENGER,
            0x0, 0x80, 0x0 },

/*7F8E84*/{ "UI_OLRankings_Monthly.fng", // 153
            0x4E64D0,
            HELP_OL_MONTHLY_RANK,
            BUTTON_PC_NAV_QUIT | BUTTON_PC_NAV_BACK | BUTTON_PC_NAV_EA_MESSENGER,
            0x0, 0x80, 0x0 },

/*7F8EA0*/{ "UI_OLEAMessenger.fng", // 154
            0x4F22F0,
            HELP_OL_MESSENGER,
            0,
            0x0, 0x80, 0x0 },

/*7F8EBC*/{ "PC_OL_SEARCH.fng", // 155
            0x4D5070,
            0,
            0,
            0x0, 0x80, 0x0 },

/*7F8ED8*/{ "UI_OL_FriendDialogue.fng", // 156
            0x4FB200,
            0,
            BUTTON_PC_NAV_QUIT | BUTTON_PC_NAV_CONTINUE | BUTTON_PC_NAV_BACK,
            0x0, 0x80, 0x0 },

/*7F8EF4*/{ "UI_OLX_Message.fng", // 157
            0x4F24E0,
            0,
            BUTTON_PC_NAV_QUIT | BUTTON_PC_NAV_CONTINUE | BUTTON_PC_NAV_BACK,
            0x0, 0x80, 0x0 },

/*7F8F10*/{ "UI_OLRankings.fng", // 158
            0x4F2540,
            HELP_OL_RANKINGS_MENU,
            BUTTON_PC_NAV_QUIT | BUTTON_PC_NAV_CONTINUE | BUTTON_PC_NAV_BACK | BUTTON_PC_NAV_EA_MESSENGER,
            0x0, 0x80, 0x0 },

/*7F8F2C*/{ "UI_OLX_FindResults.fng", // 159
            0x4F25A0,
            0,
            BUTTON_PC_NAV_QUIT | BUTTON_PC_NAV_CONTINUE | BUTTON_PC_NAV_BACK,
            0x0, 0x80, 0x0 },

/*7F8F48*/{ "UI_OL_Feedback.fng", // 160
            0x4F27E0,
            HELP_OL_MESSENGER_FEEDBACK,
            0,
            0x0, 0x80, 0x0 },

/*7F8F64*/{ "UI_OL_Challenge.fng", // 161
            0x4D6940,
            0,
            0,
            0x0, 0x80, 0x0 },

/*7F8F80*/{ "UI_OLViewCareer.fng", // 162
            0x4E88C0,
            0,
            BUTTON_PC_NAV_BACK,
            0x0, 0x80, 0x0 },

/*7F8F9C*/{ "UI_OLISPConnect.fng", // 163
            0x4B9750,
            0,
            BUTTON_PC_NAV_QUIT | BUTTON_PC_NAV_CONTINUE | BUTTON_PC_NAV_BACK,
            0x0, 0x0, 0x0 },

/*7F8FB8*/{ "UI_OLSelectPersona.fng", // 164
            0x4E3CD0,
            HELP_OL_PS2_PERSONA_SELECT,
            BUTTON_PC_NAV_QUIT | BUTTON_PC_NAV_CONTINUE | BUTTON_PC_NAV_BACK | BUTTON_PC_NAV_DELETE,
            0x0, 0x100, 0x0 },

/*7F8FD4*/{ "UI_OLCreateUser.fng", // 165
            0x4E3D50,
            HELP_OL_PS2_CREATEACCOUNT,
            BUTTON_PC_NAV_QUIT | BUTTON_PC_NAV_BACK,
            0x0, 0x0, 0x0 },

/*7F8FF0*/{ "UI_OLCreateUser_2.fng", // 166
            0x4BAA60,
            0,
            BUTTON_PC_NAV_QUIT | BUTTON_PC_NAV_BACK,
            0x0, 0x0, 0x0 },

/*7F900C*/{ "UI_OLAgeVerif.fng", // 167
            0x4E3DD0,
            0,
            BUTTON_PC_NAV_QUIT | BUTTON_PC_NAV_CONTINUE | BUTTON_PC_NAV_BACK,
            0x0, 0x0, 0x0 },

/*7F9028*/{ "UI_OLAgeTooYoung.fng", // 168
            0x49E780,
            0,
            BUTTON_PC_NAV_QUIT | BUTTON_PC_NAV_CONTINUE | BUTTON_PC_NAV_BACK,
            0x0, 0x0, 0x0 },

/*7F9044*/{ "UI_OLUseExisting.fng", // 169
            0x4E3E30,
            HELP_OL_PS2_USEEXISTING,
            BUTTON_PC_NAV_QUIT | BUTTON_PC_NAV_CONTINUE | BUTTON_PC_NAV_BACK,
            0x0, 0x100, 0x0 },

/*7F9060*/{ "UI_OLForgotAccountName.fng", // 170
            0x4E3BD0,
            0,
            BUTTON_PC_NAV_QUIT | BUTTON_PC_NAV_CONTINUE | BUTTON_PC_NAV_BACK,
            0x0, 0x100, 0x0 },

/*7F907C*/{ "UI_OLEALogin.fng", // 171
            0x4E3C50,
            HELP_OL_PS2_EALOGIN,
            BUTTON_PC_NAV_QUIT | BUTTON_PC_NAV_CONTINUE | BUTTON_PC_NAV_BACK,
            0x0, 0x100, 0x0 },

/*7F9098*/{ "UI_DateEntry.fng", // 172
            0x552720,
            HELP_OL_PS2_DATEWIDGET,
            BUTTON_PC_NAV_QUIT | BUTTON_PC_NAV_CONTINUE | BUTTON_PC_NAV_BACK,
            0x0, 0x0, 0x0 },

/*7F90B4*/{ "DiscErrorPC.fng", // 173
            0x4D97A0,
            0,
            BUTTON_PC_NAV_QUIT | BUTTON_PC_NAV_CONTINUE | BUTTON_PC_NAV_BACK,
            0x0, 0x80, 0x0 },

/*7F90D0*/{ "UI_ProfileManager.fng", // 174
            0x4F4900,
            HELP_OPTIONS_MAIN,
            BUTTON_PC_NAV_QUIT | BUTTON_PC_NAV_CONTINUE | BUTTON_PC_NAV_BACK,
            0x0, 0x80, 0x0 },

/*7F90EC*/{ "UI_Deleteprofile.fng", // 175
            0x4F4960,
            HELP_OPTIONS_MAIN,
            0,
            0x0, 0x80, 0x0 },

/*7F9108*/{ "MC_Bootup.fng", // 176
            0x4F32B0,
            0,
            0,
            0x0, 0x80, 0x0 },

/*7F9124*/{ "MC_List.fng", // 177
            0x4D7070,
            HELP_LOAD_PROFILE_BOOT,
            BUTTON_PC_NAV_QUIT,
            0x0, 0x80, 0x0 },

/*7F9140*/{ "MC_Main.fng", // 178
            0x4F3320,
            0,
            BUTTON_PC_NAV_QUIT,
            0x0, 0x80, 0x0 },

/*7F915C*/{ "MC_Background.fng", // 179
            0x4A8740,
            0,
            0,
            0x0, 0x80, 0x0 },
</details>};

<span id='struct_PCHelpBarFNGObject'></span>struct PCHelpBarFNGObject {
        // todo
}
</pre><p><details><summary>Short excerpt from hooking <a class='funcref' href='#50B790'>50B790:ShowFNG()</a></summary>
</p><p><code>arg2</code> for the dialogs are a pointer to the text string
</p><pre>ShowFNG(AB447B38 (""), 037864A0, 00000000) = 00000000
ShowFNG(33AC1CB4 ("UI_PC_Help_Bar.fng"), 0378BD30, 00000000) = 03D7EB60
ShowFNG(E503D390 ("MC_Bootup.fng"), 0379ADE0, 00000000) = 03786140
ShowFNG(23F4270A ("LS_PSAMovie.fng"), 03786120, 00000000) = 03787AD0
ShowFNG(F774ED37 ("MC_Background.fng"), 03786120, 00000000) = 03786290
ShowFNG(801E019C ("MC_Main.fng"), 03787F40, 00000000) = 0379F4B0
ShowFNG(136E3C13 ("MC_List.fng"), 0379C8C0, 00000000) = 037A86F0
ShowFNG(4CDD8B14 ("GarageMain.fng"), 037AE470, 00000000) = 037AFD70
ShowFNG(C343126A ("UI_Main.fng"), 037A8EC0, 00000000) = 037AE880
ShowFNG(8E2B101E ("UI_QRCarSelect.fng"), 037879D0, 00000000) = 0379D3B0
ShowFNG(887BBEA7 ("UI_ChooseCustomizeCategory.fng"), 0379BF40, 00000000) = 03787570
ShowFNG(DF3D7763 ("UI_Menu_Asset_Reputation.fng"), 03789730, 00000000) = 0378A940
ShowFNG(AF09F84F ("UI_GenericParts_Browser.fng"), 0378A860, 00000000) = 037BBBB0
ShowFNG(887BBEA7 ("UI_ChooseCustomizeCategory.fng"), 037B9F40, 00000000) = 037BE620
ShowFNG(8E2B101E ("UI_QRCarSelect.fng"), 037BE4A0, 00000000) = 03787660
ShowFNG(C343126A ("UI_Main.fng"), 0378A570, 00000000) = 0379F260
ShowFNG(F6C99F4D ("UI_QRModeSelect.fng"), 0379F0F0, 00000000) = 03788380
ShowFNG(8E2B101E ("UI_QRCarSelect.fng"), 0378BF40, 00000000) = 0379B7C0
ShowFNG(6962C0CD ("GenericDialog_SMALL.fng"), 0379B620, 00838640) = 037A80E0
ShowFNG(6962C0CD ("GenericDialog_SMALL.fng"), 037AE720, 00838640) = 037ABA50
ShowFNG(6962C0CD ("GenericDialog_SMALL.fng"), 037AE720, 00838640) = 037ABA50
ShowFNG(AB447B38 (""), 03767010, 00000000) = 00000000
ShowFNG(0EB1F7E5 ("HUD_SingleRace.fng"), 037A45B0, 00000000) = 00000000
ShowFNG(26691D4A ("Chyron_IG.fng"), 03793AE0, 00000000) = 03D7EBF0
ShowFNG(33AC1CB4 ("UI_PC_Help_Bar.fng"), 037B8870, 00000000) = 03D7EB60
ShowFNG(32124083 ("UI_Pause.fng"), 03796280, 00000000) = 037B8B90
ShowFNG(33AC1CB4 ("UI_PC_Help_Bar.fng"), 037C7D30, 00000000) = 03D7EB60
ShowFNG(73F51C74 ("UI_PauseOptionsMain.fng"), 037C3EF0, 00000000) = 037C6080
ShowFNG(AEA9078F ("UI_PauseOptions.fng"), 037BAE10, 00000000) = 037D8430
ShowFNG(73F51C74 ("UI_PauseOptionsMain.fng"), 037D8F40, 00000000) = 037DE0C0
ShowFNG(33AC1CB4 ("UI_PC_Help_Bar.fng"), 037DFF40, 00000000) = 03D7EB60
ShowFNG(32124083 ("UI_Pause.fng"), 037DDF40, 00000000) = 037DE2B0
ShowFNG(AA469286 ("UI_InGameDialog.fng"), 037C1120, 00838640) = 037C2AB0
</pre><p></details>
</p><pre><span id='struct_FERenderObject'></span>struct FERenderObject {
        <a href='#struct_PoolEntry'>struct PoolEntry</a> <span id='structFERenderObject_0'></span>__parent;
        int field_8;
        int field_C;
        int field_10;
        int field_14;
        <a href='#struct_ObjectLink'>struct ObjectLink</a> <span id='structFERenderObject_18'></span>FERenderEPolyLink;
        /*size 0xA0*/
};
</pre><pre>TODO:
.rdata:0079C118 aIconscroller_5 db 'IconScrollerMenu : Switch/Pop/Direct Pop called on me (0x%x).',0Ah
.rdata:0079C118                                         ; DATA XREF: sub_543D40+3E9?o
.rdata:0079C118                 db 0
.rdata:0079C157                 align 4
.rdata:0079C158 aIconscroller_4 db 'IconScrollerMenu : EXIT/INIT_COMPLETE called on me (0x%x).',0Ah,0
.rdata:0079C158                                         ; DATA XREF: sub_543D40+38B?o
.rdata:0079C194 aIconscroller_2 db 'IconScrollerMenu : UNDIM_COMPLETE.',0Ah,0
</pre><ul><li><span class='func' id='4B2240'>4B2240 int FNGINIT_UI_EngageMessageDialog_fng(void *arg)</span>
  Calls <a class='funcref' href='#497850'>497850:ShowSmsMessage()</a> and passes the arg and freshly allocated memory as <code>this</code>.
  TODO
</li><li><span class='func' id='50B840'>50B840 <a href='#struct_FNGData'>struct FNGData</a>* GetFNGDataForHash(unsigned int hash)</span>
  Goes through all the fng data above and returns the one with matching hash.
</li><li><span class='func' id='50B8E0'>50B8E0 int SetInitializeHandlerForFNG(char *fng, <a href='#fnginithandler'>fnginithandler</a> *func)</span>
  Goes through all the fng data above and set the handler for <a class='funcref' href='#43DCC0'>43DCC0:stricmp()</a> matching fng names.
</li><li><span class='func' id='50B790'>50B790 ShowFNG(int fnghash, int arg1, int arg2)</span>
  See <code><a href='https://github.com/yugecin/nfsu2-re/blob/master/nfsu2-re-hooks/replace-50B790-ShowFNG.c'>nfsu2-re-hooks/replace-50B790-ShowFNG.c</a></code> for a reimplementation.
</li><li><span class='func' id='50C550'>50C550 void FreeFNGFeRenderObjects(<a href='#struct_FNGInfo'>struct FNGInfo</a> *fng)</span>
  Frees all <code><a href='#struct_UIElement'>struct UIElement</a>::<a href='#structUIElement_58'>FERenderObject</a></code> objects by calling <a class='funcref' href='#504880'>504880:FNGInfo::VisitUIRecursively()</a>
  using a visitor that has <a class='funcref' href='#5374F0'>5374F0:UIElementVisitor_ClearFNGCache::acceptElement()</a> as its <code><a href='#structUIElementVisitor_vtable_4'>acceptElement</a></code>.
</li><li><span class='func' id='50CE30'>50CE30 char *FindTopPackage(unsigned int *hashes, int numHashes)</span>
  Checks if any of the given hashes conform with
  <code><a class='fieldref' href='#8384C4'>pUIData</a>-&gt;<a href='#structUIData_8'>field_8</a>-&gt;<a href='#structUIData_Field8_E4'>topPackage</a>-&gt;<a href='#structFNGInfo_10'>hash</a></code>
  and return its <code><a href='#structFNGInfo_C'>fngName</a></code>.
</li><li><span class='func' id='519E50'>519E50 <a href='#struct_FNGInfo'>struct FNGInfo</a> *__thiscall GetFNGInfoByNameByHierarchy(void *thisUnused,
                                                                   char *str,
                                                                   <a href='#struct_FNGInfo'>struct FNGInfo</a> *fnginfo)</span>
  Goes through <code><a href='#structFNGInfo_4'>child</a></code> until the next one is null or its
  <code><a href='#structFNGInfo_C'>fngName</a></code> and <code><a href='#structFNGInfo_10'>hash</a></code> matches.
  <code>this</code> is unused.
</li><li><span class='func' id='51CCD0'>51CCD0 <a href='#struct_FNGInfo'>struct FNGInfo</a> *__thiscall UIData::GetFNGInfoForName(<a href='#struct_UIData'>struct UIData</a> *this, char *fngName)</span>
  Searches through levelSlotPool.
</li><li><span class='func' id='52C390'>52C390 void __thiscall FERenderObject::FreeAllRenderEPolys(<a href='#struct_FERenderObject'>struct FERenderObject</a> *this)</span>
</li><li><span class='func' id='52C3A0'>52C3A0 void __thiscall FERenderObject::FreeAllRenderEPolys_0(<a href='#struct_FERenderObject'>struct FERenderObject</a> *this,
                                                                void *unused)</span>
</li><li><span class='func' id='52CEF0'>52CEF0 <a href='#struct_FNGInfo'>struct FNGInfo</a> *GetFNGInfoByName(char *fngName)</span>
  TODO, this probably searches everything instead of the hierarchy like <a class='funcref' href='#519E50'>519E50:GetFNGInfoByNameByHierarchy()</a>
</li><li><span class='func' id='5374F0'>5374F0 int __thiscall UIElementVisitor_ClearFNGCache::acceptElement(struct UIElementVisitor_ClearFNGCache *this,
                                                                       <a href='#struct_UIElement'>struct UIElement</a> *element)
  Frees <code><a href='#struct_UIElement'>struct UIElement</a>::<a href='#structUIElement_58'>FERenderObject</a></code> and its EPoly objects.
</li><li><span class='func' id='5379A0'>5379A0 void RemoveFNGFromUIObject(char *fngName)</span>
</li><li><span class='func' id='555E80'>555E80 void AddFngToUIObject_1(char *fngName, void *data)</span>
  Does more stuff.
</li><li><span class='func' id='555F10'>555F10 int AddFngToUIObjectWrapper(char *fngName, char *parentFngName, char controlMask, void *data)</span>
  Wraps <a class='funcref' href='#555D00'>555D00:AddFNGToUIObject()</a>.
  <code>parentFngName</code> may be null.
</li><li><span class='func' id='555D00'>555D00 int __thiscall AddFNGToUIObject(<a href='#struct_UIData'>struct UIData</a> *this, int flagsMaybe, char *fngName,
                                          char *parentFngName, int controlMask, void *data)</span>
  <code>parentFngName</code> may be null.
</li><li><span class='func' id='558B70'>558B70 void __thiscall UIConsumeKey(void *this, int keyCode)</span>
  probably used for Q, but what else?
</li><li><span class='func' id='55DBD0'>55DBD0 void UIHandleKey(int keyCode)</span>
  Called from <code>WM_CHAR</code> messages in <a class='funcref' href='#5CCD60'>5CCD60:MainWndProc()</a>,
  only used to type/press enter in a textbox and Q to quit.
  Navigating menus seems unaffected
</li><li><span class='func' id='55DC20'>55DC20 __thiscall void SendSomethingToFNG?(void *this, char *fng, int data)</span>
  Called when menus change.
</li><li><span class='field' id='7F7DC8'>7F7DC8 <a href='#struct_FNGData'>struct FNGData</a> fngdata[180]</span>
</li><li><span class='field' id='8384E0'>8384E0 gCallingScreenPackageName</span>
  <details><summary>Thx to</summary>
<pre class='ida'><span class='text'>.text:00551F0A</span>      push    offset <a class='fieldref' href='#8384E0'>gCallingScreenPackageName</a>
<span class='text'>.text:00551F0F</span>      push    esi
<span class='text'>.text:00551F10</span>      push    offset <span class='ident'>aGcallingscreen</span> <span class='comment'>; "gCallingScreenPackageName SETTING %s.  Previously : %s."</span>
<span class='text'>.text:00551F15</span>      call    <a class='funcref' href='#50D510'>sub_50D510_DebugPrint</a>
<span class='text'>.text:00551F1A</span>      mov     edx, [ebp+4]
<span class='text'>.text:00551F1D</span>      push    edx             <span class='comment'>; src</span>
<span class='text'>.text:00551F1E</span>      push    offset <a class='fieldref' href='#8384E0'>gCallingScreenPackageName</a> <span class='comment'>; dest</span>
<span class='text'>.text:00551F23</span>      call    <a class='funcref' href='#43DBD0'>strcpy</a>
</pre>  </details>
</li><li><span class='field' id='83A9C0'>83A9C0 int isTextboxFocused</span>
</li><li><span class='field' id='83A9C4'>83A9C4 void *focusedTextbox</span>
</li></ul><p style='margin-bottom:0'><a href='#index'>Index</a></p></div><span id='some_fng_screens'></span><div class='indent' style='margin-left:5em'><p style='margin-top:0'><small><a href='#ui'>UI</a> &gt; Some FNG screens</small></p><h3>Some FNG screens <a href="#some_fng_screens">#</a></h3>
<p>This was done by putting pointers to their strings into the boot flow entries (see <a href='#speedyboot'>Speedy boot</a>).
</p><p><details><summary>2P_PressStart.fng</summary>
<p class='center'><img src="2P_PRESS_START.JPG" alt="2player press start"/><br/>2P_PressStart.fng</p>
</details>
</p><p><details><summary>loading_boot.fng</summary>
<p class='center'><img src="LOADING_BOOT.JPG" alt="alternative loading screen with nfsu2 logo"/><br/>loading_boot.fng</p>
</details>
</p><p style='margin-bottom:0'><a href='#index'>Index</a></p></div><span id='replace_loading_screen'></span><div class='indent' style='margin-left:10em'><p style='margin-top:0'><small><a href='#ui'>UI</a> &gt; <a href='#some_fng_screens'>Some FNG screens</a> &gt; Replacing the loading screen</small></p><h4>Replacing the loading screen <a href="#replace_loading_screen">#</a></h4>
<p>I found <code>loading_boot.fng</code> pretty cool, so I wondered if that could be used instead for
the loading screens (on boot, when loading race, going into freeroam, ..).
</p><p>I've seen lots of places refer to a string with content <code>PC_Loading.fng</code>, so I thought maybe
replacing that with <code>loading_boot.fng</code> will just work. And it does.
</p><pre>strcpy((char*) 0x790734, "loading_boot.fng");
</pre><p>Since the string is longer, it will override this string with an empty string though:
</p><pre class='ida'><span class='comment'>.rdata:00790744</span> <span class='ident'>aLoadingTipsFng</span> db <span class='str'>'Loading_Tips.fng'</span>,<span class='num'>0</span>
</pre><p>It seems unused, so I guess it's fine. That made me wonder if that one could be used as loading
screen, maybe it shows tips? But when trying it just shows a black screen. Maybe it's a cut
feature?
</p><p style='margin-bottom:0'><a href='#index'>Index</a></p></div><div class='indent' style='margin-left:5em'><p style='margin-top:0'><small><a href='#ui'>UI</a> &gt; <a href='#some_fng_screens'>Some FNG screens</a> (continuation)</small></p><p><details><summary>UI_DebugTest.fng</summary>
<p class='center'><img src="UI_DEBUGTEST.JPG" alt="pulsing text and different colored circles"/><br/>UI_DebugTest.fng</p>
</details>
</p><p><details><summary>UI_OLAgeTooYoung.fng</summary>
<p class='center'><img src="UI_OLAGETOOYOUNG.JPG" alt="age too young"/><br/>UI_OLAgeTooYoung.fng</p>
</details>
</p><p><details><summary>UI_OLMAIN.fng</summary>
<p class='center'><img src="UI_OLMAIN.JPG" alt="online main menu"/><br/>UI_OLMAIN.fng</p>
</details>
</p><p><details><summary>UI_OL_Feedback.fng</summary>
<p class='center'><img src="UI_OL_FEEDBACK.JPG" alt="online player feedback menu"/><br/>UI_OL_Feedback.fng</p>
</details>
</p><p><details><summary>UI_OL_FriendDialogue.fng</summary>
<p class='center'><img src="UI_OL_FRIENDDIALOGUE.JPG" alt="online friend dialogue"/><br/>UI_OL_FriendDialogue.fng</p>
</details>
</p><p><details><summary>UI_OL_Voice_Chat.fng</summary>
<p class='center'><img src="UI_OL_VOICE_CHAT.JPG" alt="online voice chat"/><br/>UI_OL_Voice_Chat.fng</p>
</details>
</p><p style='margin-bottom:0'><a href='#index'>Index</a></p></div><span id='screenprintf'></span><div class='indent' style='margin-left:5em'><p style='margin-top:0'><small><a href='#ui'>UI</a> &gt; ScreenPrintf.fng</small></p><h3>ScreenPrintf.fng <a href="#screenprintf">#</a></h3>
<p>So this is an interesting name, but doesn't really seem used (it makes sense, it shouldn't be used in a
release build of the game). Though now with the few functions I documented maybe I can make it show?
</p><p>I tried following code:
</p><pre>static
void hook_on_msg_WM_CHAR(int wparam)
{
	if (wparam == 121) { // y
		<a class='funcref' href='#555E80'>AddFngToUIObject_1</a>("ScreenPrintf.fng", 0);
	</span>
}
</pre><p>It didn't crash, so that was a win already. The second parameter for that func is what I suspect some data to
initialize the fng screen. It fortunately seems like either the ScreenPrintf one doesn't initialize anything or it has
a null check. for the passed data It doesn't seem to show anything though. Then I thought of the UI elements and their
visitor methods (like <a class='funcref' href='#504880'>504880:FNGInfo::VisitUIRecursively()</a>). So I tried to print all the UI elements that are on screen.
</p><p><details><summary>Code <code><a href='https://github.com/yugecin/nfsu2-re/blob/master/nfsu2-re-hooks/debug-custom-uielementvisitor.c'>nfsu2-re-hooks/debug-custom-uielementvisitor.c</a></code></summary>
<pre>static
void debug_custom_uielementvisitor_visit_element(<a href='#struct_UIElement'>struct UIElement</a> *element, char *prefix)
{
	<a href='#struct_UIElement'>struct UIElement</a> *containerchild;
	<a href='#struct_UILabel'>struct UILabel</a> *label;
	char locbuf[100];
	char locbuf2[100];

	sprintf(locbuf, "%s    ", prefix);
	while (element) {
		locbuf2[0] = 0;
		if (element-&gt;<a href='#structUIElement_18'>type</a> == 2) {
			label = (void*) element;
			if (label-&gt;<a href='#structUILabel_64'>string</a>.<a href='#structWideCharString_0'>ptrString</a>) {
				locbuf2[0] = ' ';
				wchar2char(locbuf2 + 1, label-&gt;<a href='#structUILabel_64'>string</a>.<a href='#structWideCharString_0'>ptrString</a>);
			}
		}
		logging(buf, sprintf(buf, "%selement type %d hash %08X flags %8X:%s",
			prefix, element-&gt;<a href='#structUIElement_18'>type</a>, element-&gt;<a href='#structUIElement_10'>hash</a>,
			element-&gt;<a href='#structUIElement_1C'>someFlags</a>, locbuf2));
		if (element-&gt;<a href='#structUIElement_18'>type</a> == 5) {
			containerchild = ((<a href='#struct_UIContainer'>struct UIContainer</a>*) element)-&gt;<a href='#structUIContainer_64'>children</a>;
			debug_custom_uielementvisitor_visit_element(containerchild, locbuf);
		}
		element = element-&gt;<a href='#structUIElement_4'>nextSibling</a>;
	}
}

static
void debug_custom_uielementvisitor_visit_fng(<a href='#struct_FNGInfo'>struct FNGInfo</a> *fng, char *prefix)
{
	char locbuf[100];
	<a href='#struct_UIElement'>struct UIElement</a> *element;

	sprintf(locbuf, "%s    ", prefix);
	do {
		logging(buf, sprintf(buf, "%sfng %s:", prefix, fng-&gt;<a href='#structFNGInfo_C'>fngName</a>));
		element = fng-&gt;<a href='#structFNGInfo_4C'>rootUIElement</a>;
		debug_custom_uielementvisitor_visit_element(element, locbuf);
		fng = fng-&gt;<a href='#structFNGInfo_4'>child</a>;
	} while (fng);
}
</pre></details>
</p><p>And here's the output when in the options menu in the pause menu while in career freeroam:
</p><p><details><summary>Output</summary>
<pre>fng UI_PauseOptionsMain.fng:
    element type 5 hash 8D7E0C53 flags 40000000:
        element type 2 hash 42ADB44C flags 40000000: Pause Options Main
        element type 1 hash B62648B1 flags 40000000:
        element type 1 hash 7CA40D0F flags 40000000:
        element type 5 hash 371F1C93 flags 40000000:
            element type 1 hash 0A570002 flags 40000000:
            element type 1 hash A67C3FE2 flags 40000000:
            element type 1 hash A67C3FE2 flags 40000000:
            element type 1 hash A67C3FE2 flags 40000000:
            element type 1 hash 5E11FBFB flags 40000000:
        element type 5 hash DE2F4E52 flags 40000000:
            element type 1 hash A67C3FE2 flags 40000000:
            element type 1 hash C8C5F8A6 flags 40000000:
            element type 1 hash C8C5F8A6 flags 40000000:
            element type 1 hash A67C3FE2 flags 40000000:
            element type 1 hash A67C3FE2 flags 40000000:
        element type 2 hash 5E7B09C9 flags 40000000: Option title
        element type 1 hash 687FDA31 flags 40000000:
        element type 1 hash DF422345 flags 43800000:
        element type 5 hash 02DDF58C flags 40000041:
            element type 5 hash 02DDF58C flags 40000001:
            element type 5 hash 812A09D4 flags 40000001:
                element type 2 hash 1C7FCF8B flags 40000001: Back
                element type 2 hash B02B46B7 flags 40000001: $JOY_EVENT_FENG_CANCEL$
            element type 5 hash 6A218478 flags 40000001:
                element type 2 hash 93B5083A flags 40000001: Select
                element type 2 hash 9D752086 flags 40000001: $JOY_EVENT_FENG_SELECT$
        element type 5 hash 0DE769B5 flags 40000000:
            element type 1 hash 5E1208DF flags 40000000:
            element type 1 hash 0894389E flags 40000000:
            element type 1 hash A67C3FE2 flags 40000000:
            element type 1 hash A67C3FE2 flags 40000000:
            element type 1 hash 5E11FBFB flags 40000000:
            element type 1 hash 0A570002 flags 40000000:
            element type 1 hash 0A570002 flags 40000000:
        element type 5 hash 52BDEE1D flags 40000000:
            element type 1 hash 39CC2F66 flags 40000000:
            element type 1 hash DDE4A5E5 flags 40000000:
            element type 1 hash DDE4A5E8 flags 40000000:
            element type 1 hash BE9AB445 flags 40000000:
            element type 1 hash 39CC2F45 flags 40000000:
            element type 1 hash DDE4A5E7 flags 40000000:
            element type 1 hash 39CC2F24 flags 40000000:
            element type 1 hash DDE4A5E6 flags 40000000:
    element type 1 hash B51549B8 flags 50080000:
    element type 1 hash 4B4E3890 flags 50080000:
    element type 1 hash 4B4E388F flags 50080000:
    element type 1 hash 4B4E388E flags 50080000:
    element type 1 hash 4B4E388D flags 50080000:
    element type 1 hash 4B4E388C flags 50080000:
    element type 1 hash 4B4E388B flags 57C80001:
    element type 1 hash 4B4E388A flags 57C80001:
    element type 1 hash 4B4E3889 flags 57C80000:
    element type 2 hash 47FF4E7C flags 40000000: EVENT HANDLER

    element type 1 hash 444969FE flags 40000000:
    element type 1 hash 444969FD flags 40000001:
    element type 1 hash 3FBB7A4E flags 40000000:
    element type 1 hash 688A1551 flags 40000000:
    element type 5 hash BE77206B flags 40000000:
        element type 5 hash 550E571C flags 48000000:
            element type 1 hash 1F3B164E flags 40000000:
    element type 1 hash B04669E3 flags        1:
    element type 1 hash 4B4E3888 flags 53C80000:
fng UI_PC_Help_Bar.fng:
    element type 2 hash 47FF4E7C flags 40000000: Event Handler
    element type 2 hash B8A7C6CF flags 50080001: WWWWWWWWWWWWW
    element type 1 hash 62376D1B flags 40000001:
    element type 2 hash B8A7C6CE flags 10080001: WWWWWWWWWWWWW
    element type 1 hash 62376D1A flags        1:
    element type 1 hash 62376D19 flags        0:
    element type 2 hash B8A7C6CD flags 10080000: WWWWWWWWWWWWW
    element type 2 hash B8A7C6CC flags 10080000: WWWWWWWWWWWWW
    element type 1 hash 62376D18 flags        0:
    element type 2 hash B8A7C6D0 flags 50080001: WWWWWWWWWWWWW
    element type 1 hash 62376D1C flags 40000001:
    element type 1 hash 62376D1D flags 40000001:
    element type 2 hash B8A7C6D1 flags 50080001: WWWWWWWWWWWWW
    element type 1 hash A444D171 flags 40000000:
    element type 1 hash A444D172 flags 40000000:
    element type 1 hash A444D170 flags 40000000:
    element type 1 hash A444D16F flags        0:
    element type 1 hash A444D16E flags 40000000:
    element type 1 hash E0AE8220 flags        0:
    element type 5 hash A22ED3B7 flags 40000000:
        element type 5 hash 2BAC0CEE flags 40000000:
            element type 1 hash E8E1E298 flags 40000001:
            element type 1 hash E8E1E29A flags 40000001:
            element type 1 hash E8E1E297 flags 40000001:
            element type 5 hash 12DF3004 flags 40000000:
                element type 1 hash 5145A2BF flags 40000000:
                element type 1 hash 5145A2BD flags 40000000:
                element type 1 hash 5145A2BC flags 40000000:
        element type 5 hash 3B949CD0 flags 40000001:
            element type 5 hash 84EB1500 flags 40000001:
                element type 2 hash EB406FEC flags 42800003: AA
                element type 2 hash EB3A688A flags 43800003: 0
                element type 5 hash 2253BC50 flags 40000001:
                    element type 1 hash A67C3FE2 flags 40000001:
                    element type 1 hash A67C3FE2 flags 40000001:
                element type 5 hash 6D2A1AE9 flags 40000001:
                    element type 1 hash D253B8F3 flags 40000001:
                    element type 1 hash 0894449B flags 40000001:
                element type 5 hash 22534096 flags 40000001:
                    element type 1 hash D6B3DA2D flags 40000001:
                    element type 1 hash A67C3FE2 flags 40000001:
fng HUD_SingleRace.fng:
    element type 1 hash 79498F08 flags 40000001:
    element type 1 hash 79498F07 flags 40000001:
    element type 1 hash 79498F06 flags 40000001:
    element type 5 hash 697D2BCA flags 40000001:
        element type 1 hash 4F649313 flags 43800001:
        element type 1 hash 4F649314 flags 43800001:
    element type 2 hash 77CE0364 flags 40000001: Disconnect in 15s
    element type 2 hash 192F96D9 flags        1: Bank Cash
    element type 2 hash 49106CE2 flags        1: Cash Reward: 333
    element type 2 hash 2A37A685 flags 40000001: DEFAULT STRING
    element type 2 hash 2A37A684 flags 40000001: DEFAULT STRING
    element type 5 hash 29F0A455 flags 40000001:
    element type 2 hash 2A37A683 flags 40000001: DEFAULT STRING
    element type 2 hash 2A37A682 flags 40000001: DEFAULT STRING
    element type 2 hash 2A37A681 flags 40000001: DEFAULT STRING
    element type 2 hash 2A37A680 flags 40000001: DEFAULT STRING
    element type 1 hash EB24E169 flags 40000001:
    element type 1 hash A71E35FB flags 40000001:
    element type 1 hash 62451575 flags 40000001:
    element type 1 hash B65634BC flags 40000001:
    element type 1 hash 84C55E14 flags 40000001:
    element type 1 hash C11804C6 flags 40000001:
    element type 1 hash 409C6EF0 flags 40000001:
    element type 1 hash 9E59FCF0 flags 40000001:
    element type 1 hash 79498F05 flags 40000001:
    element type 1 hash F7EC30B2 flags 40000001:
    element type 1 hash E24C838B flags 40000001:
    element type 1 hash 19EF4E89 flags 40000001:
    element type 1 hash 6E8333B0 flags 40000001:
    element type 1 hash 2C225885 flags 40000001:
    element type 1 hash 9E59FCEF flags 40000001:
    element type 1 hash 79498F04 flags 40000001:
    element type 1 hash F7EC30B1 flags 40000001:
    element type 1 hash E24C838A flags 40000001:
    element type 1 hash 19EF4E88 flags 40000001:
    element type 1 hash 6E8333AF flags 40000001:
    element type 1 hash 2C225884 flags 40000001:
    element type 2 hash 668C9CD6 flags        1: x3
    element type 1 hash 9E59FCEE flags 40000001:
    element type 1 hash 9E59FCED flags 40000001:
    element type 1 hash 9E59FCEC flags 40000001:
    element type 1 hash 9E59FCEB flags 40000001:
    element type 1 hash 79498F03 flags 40000001:
    element type 1 hash 79498F02 flags 40000001:
    element type 1 hash 79498F01 flags 40000001:
    element type 1 hash 79498F00 flags 40000001:
    element type 1 hash F7EC30B0 flags 40000001:
    element type 1 hash F7EC30AF flags 40000001:
    element type 1 hash F7EC30AE flags 40000001:
    element type 1 hash F7EC30AD flags 42400001:
    element type 1 hash E24C8389 flags 40000001:
    element type 1 hash 19EF4E87 flags 40000001:
    element type 1 hash 6E8333AE flags 40000001:
    element type 1 hash 2C225883 flags 40000001:
    element type 2 hash 8EB730A7 flags        3: Fort Union
    element type 1 hash 18DDF914 flags 40000001:
    element type 1 hash FE2467E3 flags 40000001:
    element type 2 hash 407919AF flags        1:
    element type 1 hash A71E35FA flags 40000001:
    element type 1 hash A71E35F9 flags 40000001:
    element type 1 hash A71E35F8 flags 40000001:
    element type 1 hash A71E35F7 flags 40000001:
    element type 1 hash A71E35F6 flags 40000001:
    element type 1 hash 1149C7DA flags 40000001:
    element type 1 hash 62451574 flags 40000001:
    element type 1 hash B65634BB flags 40000001:
    element type 1 hash 84C55E13 flags 40000001:
    element type 1 hash C11804C5 flags 40000001:
    element type 1 hash 409C6EEF flags 40000001:
    element type 1 hash 62451573 flags 40000001:
    element type 1 hash B65634BA flags 40000001:
    element type 1 hash 84C55E12 flags 40000001:
    element type 1 hash C11804C4 flags 40000001:
    element type 1 hash 409C6EEE flags 40000001:
    element type 1 hash 62451572 flags 40000001:
    element type 1 hash B65634B9 flags 40000001:
    element type 1 hash 84C55E11 flags 40000001:
    element type 1 hash C11804C3 flags 40000001:
    element type 1 hash 409C6EED flags 40000001:
    element type 1 hash 62451571 flags 40000001:
    element type 1 hash B65634B8 flags 40000001:
    element type 1 hash 84C55E10 flags 40000001:
    element type 1 hash C11804C2 flags 40000001:
    element type 1 hash 409C6EEC flags 40000001:
    element type 1 hash 62451570 flags 40000001:
    element type 1 hash B65634B7 flags 40000001:
    element type 1 hash 84C55E0F flags 40000001:
    element type 1 hash C11804C1 flags 40000001:
    element type 2 hash 565F28AE flags 40000001: TIME
    element type 2 hash 22465E2B flags 40000001: LAPY TIMER
    element type 2 hash 27754C7F flags 40000001: HANGY TIMEY!
    element type 2 hash 15D0E247 flags 40000001: + 25
    element type 1 hash 409C6EEB flags 42400001:
    element type 1 hash F2A54430 flags 42400001:
    element type 1 hash 7AF1CA63 flags 40000001:
    element type 1 hash E24C8388 flags 40000001:
    element type 1 hash 7AF1CA62 flags 40000001:
    element type 1 hash E24C8387 flags 40000001:
    element type 1 hash 19EF4E86 flags 40000001:
    element type 1 hash 19EF4E85 flags 40000001:
    element type 1 hash 6E8333AD flags 40000001:
    element type 1 hash 6E8333AC flags 40000001:
    element type 1 hash 2C225882 flags 40000001:
    element type 1 hash 2C225881 flags 40000001:
    element type 1 hash E24C8386 flags 40000001:
    element type 1 hash 7AF1CA61 flags 40000001:
    element type 1 hash 19EF4E84 flags 42400001:
    element type 1 hash 6E8333AB flags 42400001:
    element type 1 hash 2C225880 flags 42400001:
    element type 1 hash 024C680E flags 40000001:
    element type 1 hash 024C680B flags 40000001:
    element type 1 hash 024C680C flags 40000001:
    element type 1 hash 024C680D flags 40000001:
    element type 1 hash 024C680A flags 40000001:
    element type 1 hash 024C6809 flags 40000001:
    element type 1 hash 024C6808 flags 40000001:
    element type 1 hash EB24E168 flags 40000001:
    element type 1 hash EB24E165 flags 40000001:
    element type 1 hash EB24E166 flags 40000001:
    element type 1 hash EB24E167 flags 40000001:
    element type 1 hash EB24E164 flags 40000001:
    element type 1 hash EB24E163 flags 40000001:
    element type 1 hash EB24E162 flags 40000001:
    element type 1 hash 1B259972 flags 40000001:
    element type 1 hash C1347E2F flags 42400001:
    element type 1 hash 40CDC515 flags 42400001:
    element type 5 hash 382D2FC9 flags 40000001:
        element type 1 hash 142EDB6C flags 40000001:
        element type 1 hash 99EBA9C7 flags 40000001:
        element type 1 hash 142EDA64 flags 40000001:
        element type 1 hash 92A75587 flags 40000001:
    element type 1 hash 90FE80F3 flags 42400001:
    element type 2 hash 2DA220AA flags 40000001: +9999
    element type 2 hash 29AF04FD flags 40000001: 9.99
    element type 2 hash C18C12FE flags 40000001: 9.99
    element type 2 hash C18C12FD flags 40000001: WWWWWWWWWWWW DISCONNECTED
    element type 1 hash 411301E3 flags 40000001:
    element type 2 hash F59D909F flags 40000001: xxx:xxx:xxx
    element type 1 hash C82FA200 flags 40000001:
    element type 5 hash E8434EB4 flags 40000001:
        element type 2 hash 9C183BF8 flags 40000001: 8
        element type 2 hash 44F24239 flags 40000001: nd
        element type 2 hash 3BBD6268 flags 40000001: /8
    element type 5 hash 035B0E22 flags 40000001:
    element type 5 hash AFFD0354 flags 40000001:
    element type 5 hash 02DDF58C flags 40000001:
    element type 5 hash 5164D4EA flags 40000001:
        element type 1 hash 05D19F25 flags 40000001:
        element type 1 hash 61D30442 flags 40000001:
        element type 2 hash C1D5FF50 flags 40000003:   0
        element type 2 hash C3383B63 flags 40000003: KM/H
        element type 1 hash F0250DAC flags 40000001:
        element type 2 hash B84589BE flags 40000003: 1
        element type 5 hash C5D551B7 flags 40000001:
            element type 1 hash 6D5FE871 flags 40000001:
            element type 1 hash 19C99185 flags 40000001:
            element type 1 hash 1A33CBB5 flags 40000001:
            element type 1 hash 1A33CBB6 flags 40000001:
            element type 1 hash 6D5ECE44 flags 40000001:
            element type 1 hash 00B78D9E flags 40000001:
            element type 1 hash 19C97422 flags 40000001:
        element type 1 hash 25CF2F74 flags 42800001:
        element type 1 hash 1D9051AA flags 40000001:
        element type 1 hash 11495CD6 flags 40000001:
        element type 1 hash 11461255 flags 40000001:
        element type 1 hash 39E180C4 flags 40000001:
    element type 5 hash 84CCAB08 flags 40000001:
    element type 2 hash A7806DDB flags 40000001: Race Over Message
Goes Here
    element type 1 hash 4E4566E5 flags 40000001:
    element type 5 hash 3345911D flags 40000001:
        element type 1 hash A206A0B4 flags 43800001:
        element type 1 hash 0A729B1B flags 43800001:
        element type 1 hash 99F665F4 flags 40000001:
        element type 1 hash B996A84C flags 40000001:
        element type 1 hash 3B1B624A flags 43800001:
        element type 1 hash 50910822 flags 43800001:
        element type 5 hash ED16ECE6 flags 40000001:
    element type 5 hash 54BE67BC flags 40000001:
        element type 2 hash 05092833 flags 40000001: Time:
        element type 2 hash 30D9802E flags 40000001: 99999999
        element type 1 hash A86C3C9C flags 40000001:
    element type 5 hash 5ED609A1 flags 40000001:
        element type 1 hash FA3D7B71 flags 40000001:
        element type 1 hash FA3D7B72 flags 40000001:
        element type 1 hash FA3D7B73 flags 40000001:
        element type 1 hash FA3D7B74 flags 40000001:
        element type 1 hash 4FDDD64C flags 40000001:
        element type 1 hash 4FDDD64D flags 40000001:
        element type 1 hash 4FDDD64E flags 40000001:
        element type 1 hash 4FDDD64F flags 40000001:
        element type 2 hash 4183E0A1 flags 40000001: 1
        element type 2 hash 4183E0A2 flags 40000001: 2
        element type 2 hash 4183E0A3 flags 40000001: 3
        element type 2 hash 4183E0A4 flags 40000001: 4
        element type 2 hash 2AF89FD7 flags 40000001: wwwwwwwwwww
        element type 2 hash 2AF89FD8 flags 40000001: wwwwwwwwwww
        element type 2 hash 2AF89FD9 flags 40000001: wwwwwwwwwww
        element type 2 hash 2AF89FDA flags 40000001: wwwwwwwwwww
    element type 5 hash 70F90BD4 flags 40000001:
        element type 2 hash 8B7E6EA1 flags 40000001: Laps
        element type 1 hash A86C3C9B flags 40000001:
        element type 2 hash F2685238 flags 40000001: /80
        element type 2 hash 57F0E3A5 flags 40000001: 10
    element type 5 hash 8CA76279 flags C0000001:
        element type 1 hash 238F4B29 flags 40000001:
        element type 1 hash C81A81F5 flags 40000001:
        element type 1 hash ACBAF9EF flags 40000001:
        element type 2 hash 92CDC512 flags 40000001: + 500
        element type 2 hash BCEA10CE flags 40000001: Meters
    element type 5 hash 30D59B88 flags C0000001:
        element type 1 hash 9A4E84A9 flags 40000001:
        element type 2 hash CD3A501F flags 40000001: 00:00:00
        element type 2 hash F7CFC1FC flags 40000001: Forhanosgranska
        element type 2 hash 6BF40D64 flags 40000001: Time:
    element type 1 hash 4B9B8F5A flags 42800001:
    element type 5 hash D292009B flags C0000001:
        element type 1 hash F11AFFD1 flags 40000001:
        element type 1 hash 9C355B23 flags 40000001:
        element type 1 hash F11AFFD2 flags 40000001:
        element type 1 hash 9C355B24 flags 40000001:
        element type 1 hash F11AFFD3 flags 40000001:
        element type 1 hash 9C355B25 flags 40000001:
        element type 1 hash B2D2E745 flags 40000001:
        element type 2 hash 7121F270 flags 40000001: Circuit Stats
        element type 2 hash C8D50791 flags 40000001: Best Lap:
        element type 2 hash C8D50792 flags 40000001: Current G's:
        element type 2 hash C8D50793 flags 40000001: Maximum G's:
        element type 2 hash F3828848 flags 40000001: 00000
        element type 2 hash F3828849 flags 40000001: 00000
        element type 2 hash F382884A flags 40000001: 00000
        element type 5 hash 29F0A455 flags 40000001:
            element type 2 hash 4635CA2C flags 40000001: Time:
            element type 2 hash E1FA0DA7 flags 40000001: 99999999
            element type 1 hash 9C355B26 flags 40000001:
        element type 1 hash B2751131 flags 40000001:
        element type 5 hash 0B470B80 flags 40000001:
            element type 1 hash 968971D0 flags 40000001:
            element type 1 hash 968971D3 flags 40000001:
            element type 1 hash 718D020B flags 40000001:
            element type 1 hash 718D0209 flags 40000001:
            element type 1 hash 718D020A flags 40000001:
            element type 1 hash 968971D2 flags 40000001:
            element type 1 hash 718D020C flags 40000001:
            element type 1 hash 968971D1 flags 40000001:
    element type 5 hash D80C97E1 flags 40000001:
        element type 1 hash 053A5193 flags 40000001:
        element type 1 hash BF9CC87C flags 40000001:
        element type 2 hash 0D94B769 flags 40000001: Filter
    element type 5 hash 06254D8A flags 40000001:
        element type 1 hash EED72BCE flags 40000001:
        element type 2 hash 0FBA78C2 flags 40000001: Searching
Connection
        element type 2 hash 06012887 flags 43800001:
        element type 5 hash E2848973 flags 40000001:
            element type 1 hash 4F649313 flags 43800001:
            element type 1 hash 4F649314 flags 43800001:
    element type 5 hash 3F8644CA flags C0000001:
        element type 2 hash 1930B057 flags 40000003: 0
        element type 2 hash 31B0D166 flags 40000001: Bank:
fng ScreenPrintf.fng:
    element type 2 hash B9D457DE flags 42000000: DEFAULT STRING
    element type 2 hash B9D457DF flags 42000000: DEFAULT STRING
    element type 2 hash B9D457F7 flags 42000000: DEFAULT STRING
    element type 2 hash B9D457F8 flags 42000000: DEFAULT STRING
    element type 2 hash B9D457F9 flags 42000000: DEFAULT STRING
    element type 2 hash B9D457FA flags 42000000: DEFAULT STRING
    element type 2 hash B9D457FB flags 42000000: DEFAULT STRING
    element type 2 hash B9D457FC flags 42000000: DEFAULT STRING
    element type 2 hash B9D457FD flags 42000000: DEFAULT STRING
    element type 2 hash B9D457FE flags 42000000: DEFAULT STRING
    element type 2 hash B9D457FF flags 42000000: DEFAULT STRING
    element type 2 hash B9D45800 flags 42000000: DEFAULT STRING
    element type 2 hash B9D45818 flags 42000000: DEFAULT STRING
    element type 2 hash B9D45819 flags 42000000: DEFAULT STRING
    element type 2 hash B9D4581A flags 42000000: DEFAULT STRING
    element type 2 hash B9D4581B flags 42000000: DEFAULT STRING
    element type 2 hash B9D457B7 flags 42000000: DEFAULT STRING
    element type 2 hash B9D457B8 flags 42000000: DEFAULT STRING
    element type 2 hash B9D457B9 flags 42000000: DEFAULT STRING
    element type 2 hash B9D457BA flags 42000000: DEFAULT STRING
    element type 2 hash B9D457BB flags 42000000: DEFAULT STRING
    element type 2 hash B9D457BC flags 42000000: DEFAULT STRING
    element type 2 hash B9D457BD flags 42000000: DEFAULT STRING
    element type 2 hash B9D457BE flags 42000000: DEFAULT STRING
    element type 2 hash B9D457D6 flags 42000000: DEFAULT STRING
    element type 2 hash B9D457D7 flags 42000000: DEFAULT STRING
    element type 2 hash B9D457D8 flags 42000000: DEFAULT STRING
    element type 2 hash B9D457D9 flags 42000000: DEFAULT STRING
    element type 2 hash B9D457DA flags 42000000: DEFAULT STRING
    element type 2 hash B9D457DB flags 42000000: DEFAULT STRING
    element type 2 hash B9D457DC flags 42000000: DEFAULT STRING
    element type 2 hash B9D457DD flags 42000000: DEFAULT STRING
    element type 2 hash 5334FAE2 flags 42000000: DEFAULT STRING
    element type 2 hash 5334FAE3 flags 42000000: DEFAULT STRING
    element type 2 hash 5334FAE4 flags 42000000: DEFAULT STRING
    element type 2 hash 5334FAE5 flags 42000000: DEFAULT STRING
    element type 2 hash 5334FAE6 flags 42000000: DEFAULT STRING
    element type 2 hash 5334FAE7 flags 42000000: DEFAULT STRING
    element type 2 hash 5334FAE8 flags 42000000: DEFAULT STRING
    element type 2 hash 5334FAE9 flags 42000000: DEFAULT STRING
    element type 2 hash 5334FAEA flags 42000000: DEFAULT STRING
    element type 2 hash 5334FAEB flags 42000000: DEFAULT STRING
    element type 2 hash B9D45773 flags 42000000: DEFAULT STRING
    element type 2 hash B9D45774 flags 42000000: DEFAULT STRING
    element type 2 hash B9D45775 flags 42000000: DEFAULT STRING
    element type 2 hash B9D45776 flags 42000000: DEFAULT STRING
    element type 2 hash B9D45777 flags 42000000: DEFAULT STRING
    element type 2 hash B9D45778 flags 42000000: DEFAULT STRING
    element type 2 hash B9D45779 flags 42000000: DEFAULT STRING
    element type 2 hash B9D4577A flags 42000000: DEFAULT STRING
    element type 2 hash B9D4577B flags 42000000: DEFAULT STRING
    element type 2 hash B9D4577C flags 42000000: DEFAULT STRING
    element type 2 hash B9D45794 flags 42000000: DEFAULT STRING
    element type 2 hash B9D45795 flags 42000000: DEFAULT STRING
    element type 2 hash B9D45796 flags 42000000: DEFAULT STRING
    element type 2 hash B9D45797 flags 42000000: DEFAULT STRING
    element type 2 hash B9D45798 flags 42000000: DEFAULT STRING
    element type 2 hash B9D45799 flags 42000000: DEFAULT STRING
    element type 2 hash B9D4579A flags 42000000: DEFAULT STRING
    element type 2 hash B9D4579B flags 42000000: DEFAULT STRING
    element type 2 hash B9D4579C flags 42000000: DEFAULT STRING
    element type 2 hash B9D4579D flags 42000000: DEFAULT STRING
    element type 2 hash B9D457B5 flags 42000000: DEFAULT STRING
    element type 2 hash B9D457B6 flags 42000000: DEFAULT STRING
</pre></details>
</p><p>At the end we can see all the elements of the <code>ScreenPrintf.fng</code> package. Seems like it just has a bunch of labels.
But this is a nice confirmation that my previous code to load it, did actually work. From the other elements, I guessed
that flag <code>2</code> means it should be visible, so I tried adding that.
</p><p class='center'><img src="SCREENPRINTF_1.JPG" alt="default string"/><br/>Cool.</p>
<p>Then the text can be changed easily by one of the many funcs, for example:
</p><pre><a class='funcref' href='#537B80'>SetUILabelByHashFormattedString</a>("ScreenPrintf.fng", 0xB9D457DE, "0xB9D457DE", "");
</pre><p class='center'><img src="SCREENPRINTF_2.JPG" alt="custom strings"/><br/>Nice.</p>
<p>A quick search of all the label hashes did not give any result, so it seems like there is no code left in the program
where it would set any of the labels' text.
</p><p style='margin-bottom:0'><a href='#index'>Index</a></p></div><span id='pc_help_bar'></span><div class='indent' style='margin-left:5em'><p style='margin-top:0'><small><a href='#ui'>UI</a> &gt; PC help bar</small></p><h3>PC help bar <a href="#pc_help_bar">#</a></h3>
<p>This is the button bar at the bottom of the screen, with the player name and money text. It also has some elements
that are only shown when you're connected online (TODO).
</p><p>Buttons are changed by using <a class='funcref' href='#54E6E0'>54E6E0:PCHelpBarFNGObject::SyncByMask()</a>. Buttons are predetermined, you can only specify which buttons you want and
not set an arbitrary text label. The positions are shown below. See <a class='funcref' href='#54E6E0'>54E6E0:PCHelpBarFNGObject::SyncByMask()</a> for the button masks. The lowest matching
mask gets placed on button1, and so on.
</p><p class='center'><img src="PCHELPBAR.JPG" alt="two line button bar with 6 buttons"/><br/>Normal bar</p>
<p class='center'><img src="PCHELPBAR10000.JPG" alt="wide button bar with 3 buttons"/><br/><code>LAYOUT_ONE_LINE_NO_BG</code></p>
<p class='center'><img src="PCHELPBAR10000-8000.JPG" alt="wide button bar with 3 buttons, slighty up"/><br/><code>LAYOUT_ONE_LINE_NO_BG | LAYOUT_WORLDMAP_POSITION</code></p>
<p class='center'><img src="PCHELPBAR10000-20000.JPG" alt="wide button bar with 3 buttons, up"/><br/><code>LAYOUT_ONE_LINE_NO_BG | LAYOUT_PAUSEMENU_POSITION</code></p>
<p class='center'><img src="PCHELPBAR10000-80000000.JPG" alt="right aligned button bar with 2 buttons"/><br/><code>LAYOUT_ONE_LINE_NO_BG | LAYOUT_RIGHT_POSITION</code></p>
<pre><span id='enum_PCHELPBARFLAGS'></span>enum PCHELPBARFLAGS {
        BUTTON_PC_NAV_QUIT = 0x1,
        BUTTON_PC_NAV_LOGOFF = 0x2,
        BUTTON_PC_NAV_CONTINUE = 0x4,
        BUTTON_PC_NAV_INSTALL_PART = 0x8,
        BUTTON_PC_NAV_INSTALL_VINYL = 0x10,
        BUTTON_PC_NAV_INSTALL_DECAL = 0x20,
        BUTTON_PC_NAV_INSTALL_PACKAGE = 0x40,
        BUTTON_PC_NAV_INSTALL_PAINT = 0x80,
        BUTTON_PC_NAV_READ_MESSAGE = 0x100,
        BUTTON_CANCEL_CHANGES = 0x200,
        BUTTON_PC_NAV_BACK = 0x400,
        BUTTON_DYNO_RESET_OR_PC_NAV_RESET_KEYS = 0x800,
        BUTTON_PC_NAV_CUSTOMIZE = 0x1000,
        BUTTON_PC_NAV_DELETE = 0x2000,
        BUTTON_PC_NAV_EA_MESSENGER = 0x4000,
        LAYOUT_WORLDMAP_POSITION = 0x8000,
        LAYOUT_ONE_LINE_NO_BG = 0x10000,
        LAYOUT_PAUSEMENU_POSITION = 0x20000,
        BUTTON_DELETE_TUNED_CAR = 0x40000,
        BUTTON_ICE_TEST_NOS_PURGE = 0x80000,
        BUTTON_ICE_OPEN_CLOSE_HOOD = 0x100000,
        BUTTON_ICE_OPEN_CLOSE_DOORS = 0x200000,
        BUTTON_DYNO_TIP = 0x400000,
        BUTTON_DECAL_COLOR_OR_FE_REPAINT = 0x800000,
        BUTTON_MU_PAUSE_RESTART = 0x1000000,
        BUTTON_STRING_WORLD_MAP = 0x2000000,
        BUTTON_FILTER_EVENT_OFF = 0x4000000,
        BUTTON_FILTER_EVENT_ON = 0x8000000,
        BUTTON_ACTIVATE_GPS = 0x10000000,
        BUTTON_DEACTIVATE_GPS = 0x20000000,
        BUTTON_OL_HOST_LAN_SERVER = 0x40000000,
        LAYOUT_RIGHT_POSITION = 0x80000000,
};
</pre><p><strong>Symbols:</strong></p><ul><li><span class='func' id='50CF10'>50CF10 int __thiscall PCHelpBarFNGObject::IsSomethingStillAnimating(<a href='#struct_PCHelpBarFNGObject'>struct PCHelpBarFNGObject</a> *this)</span>
</li><li><span class='func' id='52D170'>52D170 int __thiscall PCHelpBarFNGObject::GetMessageToSendFromMask(<a href='#struct_PCHelpBarFNGObject'>struct PCHelpBarFNGObject</a> *this, <a href='#enum_PCHELPBARFLAGS'>enum PCHELPBARFLAGS</a> mask)</span>
  Used when a button is pressed, to send the appropriate message.
</li><li><span class='func' id='52D330'>52D330 unsigned int __thiscall PCHelpBarFNGObject::GetButtonLanguageKey(<a href='#struct_PCHelpBarFNGObject'>struct PCHelpBarFNGObject</a> *this, int mask)</span>
  See <a class='funcref' href='#54E6E0'>54E6E0:PCHelpBarFNGObject::SyncByMask()</a> for mask. <code>BUTTON_PC_NAV_CONTINUE</code> is returned if it's not any of the other <code>BUTTON_</code> masks.
</li><li><span class='func' id='52D4F0'>52D4F0 void __thiscall PCHelpBarFNGObject::OnCursorMoved(<a href='#struct_PCHelpBarFNGObject'>struct PCHelpBarFNGObject</a> *this)</span>
  Called from <a class='funcref' href='#55DFA0'>55DFA0:PCHelpBarFNGObject::MessageHandler()</a>.
</li><li><span class='func' id='542990'>542990 void __thiscall PCHelpBarFNGObject::SetVisible(<a href='#struct_PCHelpBarFNGObject'>struct PCHelpBarFNGObject</a> *this, int show)</span>
</li><li><span class='func' id='54E6A0'>54E6A0 void __thiscall PCHelpBarFNGObject::Show(<a href='#struct_PCHelpBarFNGObject'>struct PCHelpBarFNGObject</a> *this)</span>
</li><li><span class='func' id='54E6B0'>54E6B0 void __thiscall PCHelpBarFNGObject::Hide(<a href='#struct_PCHelpBarFNGObject'>struct PCHelpBarFNGObject</a> *this)</span>
</li><li><span class='func' id='54E6E0'>54E6E0 void __thiscall PCHelpBarFNGObject::SyncByMask(<a href='#struct_PCHelpBarFNGObject'>struct PCHelpBarFNGObject</a> *this, int someMask, char *fngName)</span>
  Sets buttons and background of the help bar, updates profile name display.
  mask:
<pre>-        1: BUTTON_PC_NAV_QUIT: Quit Game
-        2: BUTTON_PC_NAV_LOGOFF: Logoff
-        4: BUTTON_PC_NAV_CONTINUE: Continue
-        8: BUTTON_PC_NAV_INSTALL_PART: Install Part
-       10: BUTTON_PC_NAV_INSTALL_VINYL: Install Vinyl
-       20: BUTTON_PC_NAV_INSTALL_DECAL: Install Decal
-       40: BUTTON_PC_NAV_INSTALL_PACKAGE: Install Package
-       80: BUTTON_PC_NAV_INSTALL_PAINT: Install Paint
-      100: BUTTON_PC_NAV_READ_MESSAGE: Read Message
-      200: BUTTON_CANCEL_CHANGES: Cancel Changes
-      400: BUTTON_PC_NAV_BACK: Back
-      800: if <a class='fieldref' href='#89E7E6'>isInPerformanceTuning</a>
            BUTTON_DYNO_RESET: Reset to default
            else
            BUTTON_PC_NAV_RESET_KEYS: Reset Keys To Default
-     1000: BUTTON_PC_NAV_CUSTOMIZE: Customize
-     2000: BUTTON_PC_NAV_DELETE: Delete
-     4000: BUTTON_PC_NAV_EA_MESSENGER: EA Messenger
-     8000: LAYOUT_WORLDMAP_POSITION: moves the button bar up slightly, three buttons, only has an effect when 10000 is set
-    10000: LAYOUT_ONE_LINE_NO_BG: used for pause options (display settings etc)/world map/pause menu
-    20000: LAYOUT_PAUSEMENU_POSITION: moves the button bar up, three buttons, only has an effect when 10000 is set
-    40000: BUTTON_DELETE_TUNED_CAR: Delete Tuned Car
-    80000: BUTTON_ICE_TEST_NOS_PURGE: Test N20 Purge
-   100000: BUTTON_ICE_OPEN_CLOSE_HOOD: Open/Close Hood
-   200000: BUTTON_ICE_OPEN_CLOSE_DOORS: Open/Close Doors
-   400000: BUTTON_DYNO_TIP: Tip
-   800000: if (in UI_ChooseVinylLayer.fng)
            BUTTON_DECAL_COLOR: Decal Color
            else
            BUTTON_FE_REPAINT: Repaint
-  1000000: BUTTON_MU_PAUSE_RESTART: Restart
-  2000000: BUTTON_STRING_WORLD_MAP_SELECT: Select Event
-  4000000: BUTTON_FILTER_EVENT_OFF: Hide on World Map
-  8000000: BUTTON_FILTER_EVENT_ON: Show on World Map
- 10000000: BUTTON_ACTIVATE_GPS: Activate GPS
- 20000000: BUTTON_DEACTIVATE_GPS: Deactivate GPS
- 40000000: BUTTON_OL_HOST_LAN_SERVER: Host LAN Server
- 80000000: LAYOUT_RIGHT_POSITION: puts buttons at the right, two buttons, only has an effect when 10000 is set
</pre>  Mask gets adjusted based on <a class='fieldref' href='#850078'>850078:someOLState</a> and <a class='fieldref' href='#8654A4'>8654A4:_??gameStateSomething</a>:
<pre>if ((<a class='fieldref' href='#850078'>someOLState</a> == 8 || <a class='fieldref' href='#850078'>someOLState</a> == 0x100) &amp;&amp; <a class='fieldref' href='#8654A4'>_??gameStateSomething</a> == 3 &amp;&amp; (mask &amp; BUTTON_PC_NAV_QUIT)) {
        mask = (mask &amp; ~PC_NAV_QUIT) | BUTTON_PC_NAV_LOGOFF;
}
if (<a class='fieldref' href='#850078'>someOLState</a> == 0x200 &amp;&amp; (mask &amp; BUTTON_PC_NAV_EA_MESSENGER)) {
        mask &amp;= ~BUTTON_PC_NAV_EA_MESSENGER;
}
</pre></li><li><span class='func' id='55DE00'>55DE00 void __thiscall PCHelpBarFNGObject::OnPrimaryCursorJustPressed(<a href='#struct_PCHelpBarFNGObject'>struct PCHelpBarFNGObject</a> *this)</span>
  Called from <a class='funcref' href='#55DFA0'>55DFA0:PCHelpBarFNGObject::MessageHandler()</a>.
</li><li><span class='func' id='55DFA0'>55DFA0 int __thiscall PCHelpBarFNGObject::MessageHandler(<a href='#struct_PCHelpBarFNGObject'>struct PCHelpBarFNGObject</a> *this, unsigned int message, int, int, int)</span>
</li><li><span class='field' id='8384D8'>8384D8 <a href='#struct_PCHelpBarFNGObject'>struct PCHelpBarFNGObject</a> *pcHelpBarFNGObject</span>
</li></ul><p style='margin-bottom:0'><a href='#index'>Index</a></p></div><div><p style='margin-top:0'><small><a href='#ui'>UI</a> (continuation)</small></p><p>Stuff
</p><p>UI keys seem to be hashed with the case insensitive hash.
</p><pre><span id='struct_U2RECT'></span>struct U2RECT {
        float <span id='structU2RECT_0'></span>left;
        float <span id='structU2RECT_04'></span>top
        float <span id='structU2RECT_08'></span>right
        float <span id='structU2RECT_0C'></span>bottom
};

#define UIELEMENT_FLAG_HIDDEN 0x1
#define UIELEMENT_FLAG_USE_CUSTOM_TEXT 0x2
#define UIELEMENT_FLAG_TEXT_CHANGED 0x400000

<span id='struct_UIElement'></span>struct UIElement {
        void *vtable;
        <a href='#struct_UIElement'>struct UIElement</a> *<span id='structUIElement_4'></span>nextSibling;
        int field_8;
        int field_C;
        unsigned int <span id='structUIElement_10'></span>hash;
        int field_14;
        int <span id='structUIElement_18'></span>type;
        int <span id='structUIElement_1C'></span>someFlags;
        int field_20;
        int field_24;
        int field_28;
        int ptrField_2C; /*maybe something size related*/
        int field_30;
        int field_34;
        int field_38;
        int field_3C;
        int field_40;
        int field_44;
        int field_48;
        int field_4C;
        int field_50;
        int field_54;
        void *<span id='structUIElement_58'></span>FERenderObject;
        /*TODO how big is this base struct??*/
};

<span id='struct_UIElementType1'></span>struct UIElementType1 {
        <a href='#struct_UIElement'>struct UIElement</a> __parent; /*__parent.type = 1*/
        /*TODO how big is the base struct?*/
};

<span id='struct_UILabel'></span>struct UILabel {
        <a href='#struct_UIElement'>struct UIElement</a> __parent; /*__parent.type = 2*/
        /*TODO how big is the base struct?*/
        /*+60*/
        unsigned int <span id='structUILabel_60'></span>textLanguageString;
        <a href='#struct_WideCharString'>struct WideCharString</a> <span id='structUILabel_64'></span>string; /*ignored when <a href='#structUILabel_60'>textLanguageString</a> is set*/
};

<span id='struct_UIElementType3'></span>struct UIElementType3 {
        <a href='#struct_UIElement'>struct UIElement</a> __parent; /*__parent.type = 3*/
        /*TODO how big is the base struct?*/
};

<span id='struct_UIElementType4'></span>struct UIElementType4 {
        <a href='#struct_UIElement'>struct UIElement</a> __parent; /*__parent.type = 4*/
        /*TODO how big is the base struct?*/
};

<span id='struct_UIContainer'></span>struct UIContainer {
        <a href='#struct_UIElement'>struct UIElement</a> __parent; /*__parent.type = 5*/
        /*TODO how big is the base struct?*/

        /*incomplete*/

        /*+0x60*/
        int <mkref=structUIContainer+60>numChildren</mkref=structUIContainer+60>;
        <a href='#struct_UIElement'>struct UIElement</a> *<span id='structUIContainer_64'></span>children;
};

<span id='struct_UIElementType6'></span>struct UIElementType6 {
        <a href='#struct_UIElement'>struct UIElement</a> __parent; /*__parent.type = 6*/
        /*TODO how big is the base struct?*/
};

<span id='struct_UIElementType7'></span>struct UIElementType7 {
        <a href='#struct_UIElement'>struct UIElement</a> __parent; /*__parent.type = 7*/
        /*TODO how big is the base struct?*/
};

<span id='struct_UIElementType8'></span>struct UIElementType8 {
        <a href='#struct_UIElement'>struct UIElement</a> __parent; /*__parent.type = 8*/
        /*TODO how big is the base struct?*/
};

<span id='struct_UIElementType9'></span>struct UIElementType9 {
        <a href='#struct_UIElement'>struct UIElement</a> __parent; /*__parent.type = 9*/
        /*TODO how big is the base struct?*/
};

<span id='struct_UIElementVisitor'></span>struct UIElementVisitor {
        <a href='#struct_UIElementVisitor_vtable'>struct UIElementVisitor$vtable</a> *<span id='structUIElementVisitor_0'></span>vtable;
};

<span id='struct_UIElementVisitor_vtable'></span>struct UIElementVisitor$vtable {
        void *<span id='structUIElementVisitor_vtable_0'></span>func_0;
        int (*<span id='structUIElementVisitor_vtable_4'></span>acceptElement)(<a href='#struct_UIElementVisitor'>struct UIElementVisitor</a>*,<a href='#struct_UIElement'>struct UIElement</a>*); /*return 0 to stop visiting*/
};

<span id='struct_UIElementVisitor_FindByHash'></span>struct UIElementVisitor_FindByHash {
        <a href='#struct_UIElementVisitor'>struct UIElementVisitor</a> <span id='structUIElementVisitor_FindByHash_0'></span>__parent;
        unsigned int <span id='structUIElementVisitor_FindByHash_4'></span>searchingHash;
        <a href='#struct_UIElement'>struct UIElement</a> *<span id='structUIElementVisitor_FindByHash_8'></span>foundUIelement;
};
</pre><p><strong>Symbols:</strong></p><ul><li><span class='func' id='4953C0'>4953C0 <a href='#struct_UILabel'>struct UILabel</a> *FindUILabelByName(char *fngName, char *str)</span>
  Hashes <code>str</code> and delegates to <a class='funcref' href='#537A10'>537A10:FindUILabelByHash()</a>.
</li><li><span class='func' id='4953E0'>4953E0 <a href='#struct_UIElementType1'>struct UIElementType1</a> *FindUIElementType1ByName(char *fngName, char *str)</span>
</li><li><span class='func' id='495460'>495460 int SetUILabelByHashLanguageString(char *fngName, unsigned int hash, unsigned int languageString)</span>
</li><li><span class='func' id='495490'>495490 int SetUILabelByNameLanguageString(char *fngName, char *name, unsigned int languageString)</span>
  Uses <a class='funcref' href='#505450'>505450:SomeHashCI505450()</a>.
</li><li><span class='func' id='4954C0'>4954C0 int HideUIElementAndChildrenByName(char *fngName, char *name)</span>
  Uses <a class='funcref' href='#505450'>505450:SomeHashCI505450()</a>.
</li><li><span class='func' id='4954E0'>4954E0 void HideUIElementAndChildrenByHash(char *fngName, unsigned int hash)</span>
</li><li><span class='func' id='495500'>495500 int ShowUIElementAndChildrenByName(char *fngName, char *name)</span>
  Uses <a class='funcref' href='#505450'>505450:SomeHashCI505450()</a>.
</li><li><span class='func' id='495520'>495520 void ShowUIElementAndChildrenByHash(char *fngName, unsigned int hash)</span>
</li><li><span class='func' id='4FDAD0'>4FDAD0 void __thiscall U2RECT::Add(<a href='#struct_U2RECT'>struct U2RECT</a> *this, <a href='#struct_U2RECT'>struct U2RECT</a> *rect)</span>
  Sums <code>this</code> and <code>rect</code> into <code>this</code>.
</li><li><span class='func' id='504830'>504830 int __thiscall FNGInfo::VisitContainerRecursively(<a href='#struct_FNGInfo'>struct FNGInfo</a> *this,
                                                            <a href='#struct_UIContainer'>struct UIContainer</a> *container,
                                                            <a href='#struct_UIElementVisitor'>struct UIElementVisitor</a> *visitor)</span>
  Starts at <code>container-&gt;<a href='#structUIContainer_64'>children</a></code>,
  iterates through all children by traversing <code><a href='#structUIElement_4'>nextSibling</a></code>,
  calls <code>visitor-&gt;<a href='#structUIElementVisitor_0'>vtable</a>-&gt;<a href='#structUIElementVisitor_vtable_4'>acceptElement</a></code> for every child,
  calls <a class='funcref' href='#504830'>504830:FNGInfo::VisitContainerRecursively()</a> (itself) for every child that is of type 5 (<code><a href='#struct_UIContainer'>struct UIContainer</a></code>),
  returns 0 when either calls return 0.
</li><li><span class='func' id='504880'>504880 int __thiscall FNGInfo::VisitUIRecursively(struct FNGInfo *this, <a href='#struct_UIElementVisitor'>struct UIElementVisitor</a> *visitor)</span>
  Starts at <code>this-&gt;<a href='#structFNGInfo_4C'>rootUIElement</a></code>,
  iterates through all children by traversing <code><a href='#structUIElement_4'>nextSibling</a></code>,
  calls <code>visitor-&gt;<a href='#structUIElementVisitor_0'>vtable</a>-&gt;<a href='#structUIElementVisitor_vtable_4'>acceptElement</a></code> for every child,
  calls <a class='funcref' href='#504830'>504830:FNGInfo::VisitContainerRecursively()</a> for every child that is of type 5 (<code><a href='#struct_UIContainer'>struct UIContainer</a></code>),
  returns 0 when either calls return 0.
</li><li><span class='func' id='5048D0'>5048D0 int __thiscall UIElementVisitor_FindByHash::acceptElement(<a href='#struct_UIElementVisitor_FindByHash'>struct UIElementVisitor_FindByHash</a> *this,
                                                                    <a href='#struct_UIElement'>struct UIElement</a> *element)</span>
  If <code>element-&gt;<a href='#structUIElement_10'>hash</a> == this-&gt;<a href='#structUIElementVisitor_FindByHash_4'>searchingHash</a></code>,
  set <code>this-&gt;<a href='#structUIElementVisitor_FindByHash_8'>foundUIelement</a></code> to <code>element</code> and return 0.
</li><li><span class='func' id='5048F0'>5048F0 int __thiscall UIElementVisitor_FindByFieldC::acceptElement(struct UIElementVisitor_FindByFieldC *this,
                                                                      <a href='#struct_UIElement'>struct UIElement</a> *element)</span>
</li><li><span class='func' id='50B460'>50B460 int RenderCursor(int x, int y)</span>
</li><li><span class='func' id='50C900'>50C900 int SetUILabelLanguageString(<a href='#struct_UILabel'>struct UILabel</a> *label, unsigned int languageString)</span>
</li><li><span class='func' id='50CA00'>50CA00 void HideUIElementAndChildren(<a href='#struct_UIElement'>struct UIElement</a> *uielement)</span>
</li><li><span class='func' id='50CA50'>50CA50 void ShowUIElementAndChildren(<a href='#struct_UIElement'>struct UIElement</a> *uielement)</span>
</li><li><span class='func' id='50CD00'>50CD00 int IsPointInRect(float x, float y, struct { float x; float y} *pos,
  struct { float width; float height; } *size)</span>
  Only seen this being called when there's a list on screen so far.
</li><li><span class='func' id='517F80'>517F80 <a href='#struct_UIElement'>struct UIElement</a> *__thiscall FNGInfo::FindUIElementByHash(<a href='#struct_FNGInfo'>struct FNGInfo</a> *this,
                                                                      unsigned int hash)</span>
<pre><a href='#struct_UIElementVisitor_FindByHash'>struct UIElementVisitor_FindByHash</a> visitor;

visitor.<a href='#structUIElementVisitor_FindByHash_0'>__parent</a>.<a href='#structUIElementVisitor_0'>vtable</a> = &amp;<a class='fieldref' href='#79AAF4'>vtable_UIElementVisitor_FindByHash</a>;
visitor.<a href='#structUIElementVisitor_FindByHash_4'>searchingHash</a> = hash;
visitor.<a href='#structUIElementVisitor_FindByHash_8'>foundUIelement</a> = 0;
<a class='funcref' href='#504880'>FNGInfo::VisitUIRecursively</a>(this, visitor);
return visitor.<a href='#structUIElementVisitor_FindByHash_8'>foundUIelement</a>;
</pre></li><li><span class='func' id='517FE0'>517FE0 int __thiscall FNGInfo::FindElementByFieldC(<a href='#struct_FNGInfo'>struct FNGInfo</a> *this, int searchingUIElementFieldC)</span>
</li><li><span class='func' id='51CF70'>51CF70 void SetUIElementAnimationByName(<a href='#struct_UIElement'>struct UIElement</a> *uielement, char *animationStr,
                                           char resetAnimationWhenThisAnimationAlreadyActive)</span>
</li><li><span class='func' id='51CFE0'>51CFE0 void SetUIElementAnimationByHash(<a href='#struct_UIElement'>struct UIElement</a> *element, unsigned int hash,
                                           char resetAnimationWhenThisAnimationAlreadyActive)</span>
</li><li><span class='func' id='51D070'>51D070 void GetUIElementTopLeft(<a href='#struct_UIElement'>struct UIElement</a> *element, float *top, float *left)</span>
  TODO
</li><li><span class='func' id='51D170'>51D170 void GetUIElementRightBottom(<a href='#struct_UIElement'>struct UIElement</a> *element, float *right, float *bottom)</span>
  TODO
</li><li><span class='func' id='51D9F0'>51D9F0 int GetUIElementRect(<a href='#struct_UIElement'>struct UIElement</a> *element, <a href='#struct_U2RECT'>struct U2RECT</a> *out)</span>
  Returns 1 on success.
</li><li><span class='func' id='52C570'>52C570 <a href='#struct_UIElement'>struct UIElement</a> *__thiscall GetUIElementByHashInFngName(<a href='#struct_UIData_Field8'>struct UIData_Field8</a> *this,
                                                                     unsigned int hash,
                                                                     char *fngName)</span>
  When <code>fngName</code> is null, searches every FNG in <code>this-&gt;<a href='#structUIData_Field8_E4'>topPackage</a></code> for the given hash.
  Otherwise, limit the search to the FNG that is in the hierarchy of <code>this-&gt;<a href='#structUIData_Field8_E4'>topPackage</a></code>
  (by using <a class='funcref' href='#519E50'>519E50:GetFNGInfoByNameByHierarchy()</a>).
</li><li><span class='func' id='52D020'>52D020 int IsPointInUIElement(float x, float y, <a href='#struct_UIElement'>struct UIElement</a> *element)</span>
</li><li><span class='func' id='535FE0'>535FE0 void __thiscall UILabel::setString(<a href='#struct_UILabel'>struct UILabel</a> *this, char *str)</span>
  Only seems to be used for dynamic things such as: money, player name, sms messages, track length...
</li><li><span class='func' id='5372E0'>5372E0 <a href='#struct_UIData'>struct UIData</a> *__thiscall UIData::ctor(<a href='#struct_UIData'>struct UIData</a> *this)</span>
  Called from <a class='funcref' href='#57ED10'>57ED10:??SetupPools()</a>.
</li><li><span class='func' id='537750'>537750 void __thiscall UIData::PopPackage(<a href='#struct_UIData'>struct UIData</a> *this, char *fngName)</span>
</li><li><span class='func' id='537830'>537830 void CreateUI()</span>
  Called from <a class='funcref' href='#57ED10'>57ED10:??SetupPools()</a>.
</li><li><span class='func' id='5379C0'>5379C0 <a href='#struct_UIElement'>struct UIElement</a> *FindUIElementByHash(char *fngName, unsigned int hash)</span>
</li><li><span class='func' id='537A10'>537A10 <a href='#struct_UILabel'>struct UILabel</a> *FindUILabelByHash(char *fngName, unsigned int hash)</span>
</li><li><span class='func' id='537A60'>537A60 <a href='#struct_UIElementType1'>struct UIElementType1</a> *FindUIElementType1ByHash(char *fngName, unsigned int hash)</span>
</li><li><span class='func' id='537B30'>537B30 int SetUILabelFormattedString(<a href='#struct_UILabel'>struct UILabel</a> *label, char *format, void *param)</span>
  Delegates to <a class='funcref' href='#535FE0'>535FE0:UILabel::setString()</a>. Also makes the element visible.
</li><li><span class='func' id='537B80'>537B80 int SetUILabelByHashFormattedString(char *fngName, unsigned int hash, char *format, int parameter)</span>
  Only used for a few things, such as: sms 'from', sms 'subject', part name in customize..
  Delegates to <a class='funcref' href='#537B30'>537B30:SetUILabelFormattedString()</a>
</li><li><span class='func' id='542600'>542600 int SetUILabelByNameFormattedString(char *fngName, char *uiElementName, char *format, int parameter)</span>
  Uses <a class='funcref' href='#4953C0'>4953C0:FindUILabelByName()</a>, then <a class='funcref' href='#537B30'>537B30:SetUILabelFormattedString()</a>.
</li><li><span class='func' id='537BE0'>537BE0 int SetNullableUILabelFormattedString(<a href='#struct_UILabel'>struct UILabel</a> *label, char *format, char param)</span>
  Same as <a class='funcref' href='#537B30'>537B30:SetUILabelFormattedString()</a> but checks if <code>label</code> is not null first.
</li><li><span class='func' id='5663B0'>5663B0 void DoUI()</span>
  TODO document this and go in the last unresolved func.
</li><li><span class='field' id='78DA30'>78DA30 float canvasHeight2</span>
  Canvas height divided by 2.
</li><li><span class='field' id='797D50'>797D50 float canvasWith2</span>
  Canvas width divided by 2.
</li><li><span class='field' id='797D54'>797D54 float canvasHeight</span>
</li><li><span class='field' id='797D58'>797D58 float canvasWidth</span>
</li><li><span class='field' id='79AAF4'>79AAF4 <a href='#struct_UIElementVisitor_FindByHash'>struct UIElementVisitor_FindByHash</a> vtable_UIElementVisitor_FindByHash</span>
  vtable for <a class='funcref' href='#517F80'>517F80:FNGInfo::FindUIElementByHash()</a>,
  <code>vtable-&gt;<a href='#structUIElementVisitor_vtable_0'>func_0</a> = <a class='funcref' href='#5047C0'>5047C0:sub_5047C0</a>;</code>
  <code>vtable-&gt;<a href='#structUIElementVisitor_vtable_4'>acceptElement</a> = <a class='funcref' href='#5048D0'>5048D0:UIElementVisitor_FindByHash::acceptElement()</a>;</code>
</li><li><span class='field' id='79BCD8'>79BCD8 vtable_UIData</span>
</li><li><span class='field' id='836494'>836494 char canUseQToExit</span>
  When 1, pressing Q is allowed to bring up a dialog to exit the game.
</li><li><span class='field' id='8384C4'>8384C4 <a href='#struct_UIData'>struct UIData</a> *pUIData</span>
</li><li><span class='field' id='838528'>838528 char someThingKeyboardInput</span>
  Seems keyboard related due to:
  <details><summary>collapsed code</summary>
<pre>//551E84
if (!strcmp(x,"UI_OLEAMessenger.fng") ||
        !strcmp(x, "GarageMain.fng") ||
        !strcmp(x, "Keyboard.fng") ||
        !strcmp(x, "UI_VirtualKeyboard.fng))
{
        <a class='fieldref' href='#838528'>someThingKeyboardInput</a> = 1;
} else {
        <a class='fieldref' href='#838528'>someThingKeyboardInput</a> = 0;
}
</pre>  </details>
</li></ul><p style='margin-bottom:0'><a href='#index'>Index</a></p></div><span id='input'></span><div><h2>Input <a href="#input">#</a></h2>
<p style='margin-bottom:0'><a href='#index'>Index</a></p></div><span id='mouseinput'></span><div class='indent' style='margin-left:5em'><p style='margin-top:0'><small><a href='#input'>Input</a> &gt; Mouse input</small></p><h3>Mouse input <a href="#mouseinput">#</a></h3>
<p>While the canvas is <code>640x480</code>, mouse position seems to be handled mostly
as <code>([-320,+320],[-240,+240])</code>.
</p><pre><span id='struct_MouseData'></span>struct MouseData {
	void /*DInputDevice8*/ *<span id='structMouseData_0'></span>dinputdevice;
	int cursorX; // on 640x480 canvas
	int cursorY; // on 640x480 canvas
	int previousCursorX; // on 640x480 canvas
	int previousCursorY; // on 640x480 canvas
	int deltaCursorX; // on 640x480 canvas
	int deltaCursorY; // on 640x480 canvas
	int mousestate_lZ; // scrollwheel data
	char areMouseButtonsSwapped; // result of GetSystemMetrics(SM_SWAPBUTTON);
	char button0State; // left mouse button
	char button0JustPressed;
	char button0JustReleased;
	char button1State; // right mouse button
	char button1JustPressed;
	char button1JustReleased;
	char button2State; // middle mouse button
	char button2JustPressed;
	char button2JustReleased;
};

struct MouseData *_mouseData = (struct MouseData*) 0x8763D0;
</pre><p><strong>Symbols:</strong></p><ul><li><span class='func' id='50CD70'>50CD70 void GetMousePositionFromMiddle(float *cursorX, float *cursorY)</span>
<pre>*cursorX = _mouseData.cursorX - canvasWidth/2;
*cursorY = _mouseData.cursorY - canvasHeight/2;
</pre></li><li><span class='func' id='50C860'>50C860 void StoreMousePosButtonsIntoArg(void *arg)</span>
<pre>*((short*) arg_0 + 0) = _mouseData.cursorX - canvasWidth / 2;
*((short*) arg_0 + 1) = _mouseData.cursorY - canvasHeight / 2;
*((short*) arg_0 + 2) = _mouseData.button0State &lt;&lt; 1 | _mouseData.button1State; (or swapped)
</pre></li><li><span class='func' id='50CDA0'>50CDA0 void GetMouseWheel(float *mouseWheelData)</span>
<pre>*mouseWheelData = _mouseData.mousestate.lz;
</pre></li><li><span class='func' id='50CDB0'>50CDB0 int DidCursorPressInRect(struct { float x; float y; } *pos,
  struct { float width; float height; } *size)</span>
  Gets called in one location, but still haven't actually seen it being called. TODO
</li><li><span class='func' id='52D090'>52D090 int IsCursorDownInUIElement(<a href='#struct_UIElement'>struct UIElement</a> *uiElement)</span>
  Checks if the primary mouse button is held down.
  Delegates to <a class='funcref' href='#52D020'>52D020:IsPointInUIElement()</a>
</li><li><span class='func' id='52D100'>52D100 int DidCursorPressInUIElement(<a href='#struct_UIElement'>struct UIElement</a> *element)</span>
  Checks is the primary mouse button is just down.
  Delegates to <a class='funcref' href='#52D020'>52D020:IsPointInUIElement()</a>
</li><li><span class='func' id='5BF6E0'>5BF6E0 int __thiscall CreateDinputDevice(<a href='#struct_MouseData'>struct MouseData</a> *this)</span>
  Creates and sets <code><a class='fieldref' href='#8763D0'>8763D0:_mouseData</a>.<a href='#structMouseData_0'>dinputdevice</a></code>
</li><li><span class='func' id='5BF750'>5BF750 int __thiscall UpdateCursorPosition(<a href='#struct_MouseData'>struct MouseData</a> *this)</span>
</li><li><span class='func' id='5BF860'>5BF860 void __thiscall UpdateMouseState(<a href='#struct_MouseData'>struct MouseData</a> *this)</span>
  Calls <a class='funcref' href='#5BF750'>5BF750:UpdateCursorPosition()</a> and then updates button states.
</li><li><span class='func' id='5BF940'>5BF940 int __thiscall HaveCursorActivity(<a href='#struct_MouseData'>struct MouseData</a> *this)</span>
  called once, from <a class='funcref' href='#5663B0'>5663B0:DoUI()</a>. returns 1 if position deltas or scrollwheel or
  any of the JustPressed/JustReleased fields are not zero. Always returning 0 here has the
  effect that ui hover does not work, left click acts as right click (go back) except when
  clicking on the active ui element (like main menu bar). Dialog box buttons still work
  somehow. The car showroom can still be rotated with mmb. Mouse still moves.
</li><li><span class='func' id='5C8600'>5C8600 int __thiscall MouseData::ctor(<a href='#struct_MouseData'>struct MouseData</a> *this)</span>
  Called once, from <a class='funcref' href='#77E580'>77E580:init_function_77E580_MouseData_ctor()</a>.
</li><li><span class='field' id='8763D0'>8763D0 struct MouseData _mouseData</span>
</li></ul><p style='margin-bottom:0'><a href='#index'>Index</a></p></div><span id='joyinput'></span><div class='indent' style='margin-left:5em'><p style='margin-top:0'><small><a href='#input'>Input</a> &gt; Key (Joy) input</small></p><h3>Key (Joy) input <a href="#joyinput">#</a></h3>
<pre><span id='struct_JoyData'></span>struct JoyData {
        int id;
        char *name;
};
</pre><p>List from <a class='fieldref' href='#7FABA8'>7FABA8:joydata</a>:
</p><pre>00 JOY_EVENT_NULL
01 JOY_EVENT_TYPE_CHANGED
02 JOY_EVENT_LIVE_TYPE_CHANGED
03 JOY_EVENT_EXIT_DEMO_DISC
04 JOY_EVENT_SCROLL_UP
05 JOY_EVENT_SCROLL_DOWN
06 JOY_EVENT_SCROLL_LEFT
07 JOY_EVENT_SCROLL_RIGHT
08 JOY_EVENT_START
09 JOY_EVENT_SELECT
0A JOY_EVENT_MENU_SELECT
0B JOY_EVENT_MENU_CANCEL
0C JOY_EVENT_MENU_BACK
0D JOY_EVENT_MENU_HELP
0E JOY_EVENT_MENU_L1
0F JOY_EVENT_MENU_L2
10 JOY_EVENT_MENU_R1
11 JOY_EVENT_MENU_R2
12 JOY_EVENT_MENU_SQUARE
13 JOY_EVENT_MENU_ANALOG_LEFT
14 JOY_EVENT_MENU_ANALOG_RIGHT
15 JOY_EVENT_MENU_ANALOG_UP
16 JOY_EVENT_MENU_ANALOG_DOWN
17 JOY_EVENT_DEBUG_MENU_ACTIVATE
1E JOY_EVENT_FENG_START
1F JOY_EVENT_FENG_BUTTON0
20 JOY_EVENT_FENG_BUTTON1
21 JOY_EVENT_FENG_BUTTON2
22 JOY_EVENT_FENG_BUTTON3
23 JOY_EVENT_FENG_LTRIGGER
24 JOY_EVENT_FENG_RTRIGGER
25 JOY_EVENT_FENG_SELECT
26 JOY_EVENT_FENG_SELECT_ALTERNATE
27 JOY_EVENT_FENG_CANCEL
28 JOY_EVENT_FENG_CANCEL_ALTERNATE
29 JOY_EVENT_FENG_HELP
2A JOY_EVENT_FENG_PAD_UP
2B JOY_EVENT_FENG_PAD_DOWN
2C JOY_EVENT_FENG_PAD_LEFT
2D JOY_EVENT_FENG_PAD_RIGHT
2E JOY_EVENT_FENG_PAD_UP_ALTERNATE
2F JOY_EVENT_FENG_PAD_DOWN_ALTERNATE
30 JOY_EVENT_FENG_PAD_LEFT_ALTERNATE
31 JOY_EVENT_FENG_PAD_RIGHT_ALTERNATE
32 JOY_EVENT_FENG_QUIT
33 JOY_EVENT_FENG_RACEOPTIONS
35 JOY_EVENT_SKIP_DEMO_MODE
36 JOY_EVENT_MAIN_MENU_SELECT_TRANSMISSION
37 JOY_EVENT_ANY
38 JOY_EVENT_EXIT_EDIT_TEXT
39 JOY_EVENT_CLEAR_TEXT
3A JOY_EVENT_CANCEL_EDIT_TEXT
3B JOY_EVENT_DELETE_CHAR
3C JOY_EVENT_ROTATE_LETTER_UP
3D JOY_EVENT_ROTATE_LETTER_DOWN
3E JOY_EVENT_PREV_CHAR
3F JOY_EVENT_NEXT_CHAR
40 JOY_EVENT_CARSEL_CHANGE_MODE
41 JOY_EVENT_CARSEL_UNLOCK
42 JOY_EVENT_CARSEL_ORBIT_LEFT
43 JOY_EVENT_CARSEL_ORBIT_RIGHT
44 JOY_EVENT_CARSEL_ORBIT_UP
45 JOY_EVENT_CARSEL_ORBIT_DOWN
46 JOY_EVENT_CARSEL_ORBIT_IN
47 JOY_EVENT_CARSEL_ORBIT_OUT
48 JOY_EVENT_CARSEL_ORBIT_LEFTRIGHT
49 JOY_EVENT_CARSEL_ORBIT_UPDOWN
4A JOY_EVENT_CARSEL_ORBIT_INOUT
4C JOY_EVENT_CHANGE_DEBUG_CAMERA
4D JOY_EVENT_DEBUG_CAMERA_ROTATE_RIGHT
4E JOY_EVENT_DEBUG_CAMERA_ROTATE_LEFT
4F JOY_EVENT_DEBUG_CAMERA_ROTATE_UP
50 JOY_EVENT_DEBUG_CAMERA_ROTATE_DOWN
51 JOY_EVENT_DEBUG_CAMERA_MOVE_CLOSER
52 JOY_EVENT_DEBUG_CAMERA_MOVE_FARTHER
53 JOY_EVENT_DEBUG_CAMERA_NEXT_CAR
54 JOY_EVENT_DEBUG_CAMERA_PREV_CAR
55 JOY_EVENT_DEBUG_CAMERA_FOLLOW_CHOPPER
56 JOY_EVENT_DEBUG_CAMERA_TURN_LEFT
57 JOY_EVENT_DEBUG_CAMERA_TURN_RIGHT
58 JOY_EVENT_DEBUG_CAMERA_TURN_DOWN
59 JOY_EVENT_DEBUG_CAMERA_TURN_UP
5A JOY_EVENT_DEBUG_CAMERA_MOVE_DOWN
5B JOY_EVENT_DEBUG_CAMERA_MOVE_UP
5C JOY_EVENT_DEBUG_CAMERA_MOVE_FWD
5D JOY_EVENT_DEBUG_CAMERA_MOVE_BACK
5E JOY_EVENT_DEBUG_CAMERA_MOVE_LEFT
5F JOY_EVENT_DEBUG_CAMERA_MOVE_RIGHT
60 JOY_EVENT_DEBUG_CAMERA_TURBO
61 JOY_EVENT_DEBUG_CAMERA_SUPER_TURBO
62 JOY_EVENT_DEBUG_CAMERA_SLOW
63 JOY_EVENT_DEBUG_CAMERA_FORWARD_BLINK
64 JOY_EVENT_DEBUG_CAMERA_BACKWARD_BLINK
65 JOY_EVENT_DEBUG_CAMERA_DROP_CAR
66 JOY_EVENT_DEBUG_CAMERA_ROTATE_LEFTRIGHT
67 JOY_EVENT_DEBUG_CAMERA_ROTATE_UPDOWN
68 JOY_EVENT_DEBUG_CAMERA_STRAFE_LEFTRIGHT
69 JOY_EVENT_DEBUG_CAMERA_INOUT
6A JOY_EVENT_TRACKROUTE_EDITOR_TURN_LEFTRIGHT
6B JOY_EVENT_TRACKROUTE_EDITOR_TURN_UPDOWN
6C JOY_EVENT_TRACKROUTE_EDITOR_DRIVE_FORWARDBACKWARD
6D JOY_EVENT_TRACKROUTE_EDITOR_DRIVE_LEFTRIGHT
6E JOY_EVENT_TRACKROUTE_EDITOR_DRIVE_TURBO
6F JOY_EVENT_TRACKROUTE_EDITOR_MOVE_UP
70 JOY_EVENT_TRACKROUTE_EDITOR_MOVE_DOWN
71 JOY_EVENT_TRACKROUTE_EDITOR_DPAD_UP
72 JOY_EVENT_TRACKROUTE_EDITOR_DPAD_DOWN
73 JOY_EVENT_TRACKROUTE_EDITOR_DPAD_LEFT
74 JOY_EVENT_TRACKROUTE_EDITOR_DPAD_RIGHT
75 JOY_EVENT_TRACKROUTE_EDITOR_NEXT_ROUTE
76 JOY_EVENT_TRACKROUTE_EDITOR_NEXT_POINT
77 JOY_EVENT_TRACKROUTE_EDITOR_PREV_POINT
78 JOY_EVENT_TRACKROUTE_EDITOR_RESET_POS
79 JOY_EVENT_TRACKROUTE_EDITOR_EDIT_RIGHT_WIDTH
7A JOY_EVENT_TRACKROUTE_EDITOR_EDIT_LEFT_WIDTH
7B JOY_EVENT_TRACKROUTE_EDITOR_EDIT_POSITION
7C JOY_EVENT_TOGGLE_TRACK_MARKER
7D JOY_EVENT_CAMERA_POV_CHANGE
7E JOY_EVENT_CAMERA_LOOKBACK
7F JOY_EVENT_ZONE_FREEZE
80 JOY_EVENT_ZONE_PREVIEW
81 JOY_EVENT_ZONE_SLOMO
82 JOY_EVENT_ZONE_WARP
83 JOY_EVENT_REPLAY_SKIP
84 JOY_EVENT_REPLAY_PAUSE
85 JOY_EVENT_REPLAY_PREVIOUS_MARKER
86 JOY_EVENT_REPLAY_NEXT_MARKER
87 JOY_EVENT_REPLAY_PLAYBACK_SPEED
88 JOY_EVENT_REPLAY_CAMERA_ANGLE
89 JOY_EVENT_REPLAY_CAMERA_TARGET
8A JOY_EVENT_REPLAY_HELP
8B JOY_EVENT_REPLAY_HIDE_TIMELINE
8C JOY_EVENT_REPLAY_MARK_DEMO
8D JOY_EVENT_REPLAY_TEST_DEMO
8E JOY_EVENT_REPLAY_ERASE_DEMO
8F JOY_EVENT_STEER
90 JOY_EVENT_STEER_ANALOG
91 JOY_EVENT_THROTTLE
92 JOY_EVENT_THROTTLE_ANALOG
93 JOY_EVENT_THROTTLE_ANALOG_ALTERNATE
94 JOY_EVENT_BRAKE
95 JOY_EVENT_BRAKE_ANALOG
96 JOY_EVENT_BRAKE_ANALOG_ALTERNATE
97 JOY_EVENT_REVERSE
98 JOY_EVENT_REVERSE_ANALOG
99 JOY_EVENT_EBRAKE
9A JOY_EVENT_EBRAKE_ANALOG
9B JOY_EVENT_SHIFTUP
9C JOY_EVENT_SHIFTDOWN
9D JOY_EVENT_SHIFTUP_ALTERNATE
9E JOY_EVENT_SHIFTDOWN_ALTERNATE
9F JOY_EVENT_DISENGAGE_CLUTCH
A0 JOY_EVENT_DISENGAGE_CLUTCH_ANALOG
A1 JOY_EVENT_RESET_CAR
A2 JOY_EVENT_HONK_HORN
A3 JOY_EVENT_NITRO_BOOST
A4 JOY_EVENT_NITRO_BOOST_ALTERNATE
A5 JOY_EVENT_HYDRAULIC_BOUNCE
A6 JOY_EVENT_HYDRAULIC_BOUNCE_SELX
A7 JOY_EVENT_HYDRAULIC_BOUNCE_SELY
A8 JOY_EVENT_HYDRAULIC_BOUNCE_ANALOG_UD
A9 JOY_EVENT_HYDRAULIC_BOUNCE_ANALOG_LR
AA JOY_EVENT_HYDRAULIC_PRESSURIZE
AB JOY_EVENT_HYDRAULIC_PRESSURIZE_SELX
AC JOY_EVENT_HYDRAULIC_PRESSURIZE_SELY
AD JOY_EVENT_HYDRAULIC_PRESSURIZE_ANALOG_UD
AE JOY_EVENT_HYDRAULIC_PRESSURIZE_ANALOG_LR
AF JOY_EVENT_REQUEST_ROADBLOCK
B0 JOY_EVENT_REQUEST_HELICOPTER
B1 JOY_EVENT_FIRE_ROCKET
B2 JOY_EVENT_AIM_ROCKET_LR
B3 JOY_EVENT_AIM_ROCKET_UD
B4 JOY_EVENT_AIM_ZOOM
B5 JOY_EVENT_AUTO_PILOT
B8 JOY_EVENT_DRAG_RACE_CHANGE_LANE_LEFT
B9 JOY_EVENT_DRAG_RACE_CHANGE_LANE_RIGHT
BA JOY_EVENT_DRAG_RACE_CHANGE_LANE_LEFT_ANALOG
BB JOY_EVENT_DRAG_RACE_CHANGE_LANE_RIGHT_ANALOG
BC JOY_EVENT_CYCLE_HUD
BD JOY_EVENT_PAUSE
BE JOY_EVENT_SKIP
BF JOY_EVENT_REQUEST_ENGAGE_INFO
C0 JOY_EVENT_REQUEST_WORLD_MAP
C1 JOY_EVENT_REQUEST_LEGEND
C2 JOY_EVENT_REQUEST_MESSAGE_SYSTEM
D3 JOY_EVENT_CAMERA_EDITOR_HOLD_LEFT
D4 JOY_EVENT_CAMERA_EDITOR_HOLD_RIGHT
D5 JOY_EVENT_CAMERA_EDITOR_UP
D6 JOY_EVENT_CAMERA_EDITOR_DOWN
D7 JOY_EVENT_CAMERA_EDITOR_LEFT
D8 JOY_EVENT_CAMERA_EDITOR_RIGHT
D9 JOY_EVENT_CAMERA_EDITOR_HELP
DA JOY_EVENT_CAMERA_EDITOR_HIDE
DB JOY_EVENT_CAMERA_EDITOR_SCREENSHOT
DC JOY_EVENT_CAMERA_EDITOR_CUT,
DD JOY_EVENT_CAMERA_EDITOR_COPY
DE JOY_EVENT_CAMERA_EDITOR_UNDO
DF JOY_EVENT_CAMERA_EDITOR_PLAY_ANIMATION
E0 JOY_EVENT_CAMERA_EDITOR_PASTE
E1 JOY_EVENT_CAMERA_EDITOR_INSERT
E2 JOY_EVENT_CAMERA_EDITOR_SELECT
E3 JOY_EVENT_CAMERA_EDITOR_CANCEL
E4 JOY_EVENT_CAMERA_EDITOR_ALT_1
E5 JOY_EVENT_CAMERA_EDITOR_CLIP_IN
E6 JOY_EVENT_CAMERA_EDITOR_CLIP_OUT
E7 JOY_EVENT_CAMERA_EDITOR_ZOOM_IN
E8 JOY_EVENT_CAMERA_EDITOR_ZOOM_OUT
E9 JOY_EVENT_CAMERA_EDITOR_APERTURE_INC
EA JOY_EVENT_CAMERA_EDITOR_APERTURE_DEC
EB JOY_EVENT_CAMERA_EDITOR_LETTERBOX_IN
EC JOY_EVENT_CAMERA_EDITOR_LETTERBOX_OUT
ED JOY_EVENT_CAMERA_EDITOR_BUBBLE_IN
EE JOY_EVENT_CAMERA_EDITOR_BUBBLE_OUT
EF JOY_EVENT_CAMERA_EDITOR_BUBBLE_UP
F0 JOY_EVENT_CAMERA_EDITOR_BUBBLE_DOWN
F1 JOY_EVENT_CAMERA_EDITOR_BUBBLE_TILT
F2 JOY_EVENT_CAMERA_EDITOR_BUBBLE_SPIN
F3 JOY_EVENT_CAMERA_EDITOR_BUBBLE_LEFT_RIGHT
F4 JOY_EVENT_CAMERA_EDITOR_BUBBLE_BACK_FORTH
F5 JOY_EVENT_CAMERA_EDITOR_SHAKE_MAG
F6 JOY_EVENT_CAMERA_EDITOR_SHAKE_FRQ
F7 JOY_EVENT_CAMERA_EDITOR_SHUTTLE_LEFT_RIGHT
F8 JOY_EVENT_CAMERA_EDITOR_SHUTTLE_SPEED
</pre><p>Patching in the <code>B5 JOY_EVENT_AUTO_PILOT</code> id (by for example replacing the world-map key in career
to this key), makes it so the player's car starts driving like an AI car. Example in
<code><a href='https://github.com/yugecin/nfsu2-re/blob/master/nfsu2-re-hooks/switch-joyids-in-career.c'>nfsu2-re-hooks/switch-joyids-in-career.c</a></code>.
</p><p><strong>Symbols:</strong></p><ul><li><span class='field' id='7FABA8'>7FABA8 <a href='#struct_JoyData'>struct JoyData</a> joydata[223]</span>
</li></ul><p style='margin-bottom:0'><a href='#index'>Index</a></p></div><span id='cheats'></span><div><h2>Cheats <a href="#cheats">#</a></h2>
<pre><span id='struct_CheatScreenData'></span>struct CheatScreenData {
	void **ppFunc;
	char <span id='structCheatScreenData_4'></span>doCheatCheck; // only 1 when in the 'press enter key' screen
	char field5;
	char field6;
	char field7;
	int field2CofLastCheatActivated;
	struct CheatData *cheats; /*0x7FB960*/
	int numCheats; // 20
	char cheatString[32]; // typed string
	int typedCheatLength; // characters typed
	int field38;
};

#define CHEAT_TYPE_VISUALS 1
#define CHEAT_TYPE_PERFORMANCE 2
#define CHEAT_TYPE_CAREER 5
#define CHEAT_TYPE_SPONSOR_CAR 6 // shows up when doing quick race
#define CHEAT_TYPE_VINYL 7

<span id='struct_CheatData'></span>struct CheatData {
	char cheat[32];
	int cheatType;
	int cheatData; // hash when cheatType is sponsor car or vinyl
	int <span id='structCheatData_28'></span>field28;
	int field2C;
	char <span id='structCheatData_30'></span>hasBeenTriggered;
	char field31;
	char cheatEnabled;
	char field33;
};
EXPECT_SIZE(struct CheatData, 0x34);

struct CheatScreenData <a class='fieldref' href='#865930'>865930:cheatScreenData</a>; // partially initialized by <a class='funcref' href='#575770'>575770:InitCheats_()</a>
struct CheatData <a class='fieldref' href='#7FB960'>7FB960:cheatData</a>[20] = {
	{ "needperformance1",	2, 1, 0, 0, 0, 1, 1, 0 }, // 0
	{ "needperformance2",	2, 2, 0, 0, 0, 1, 1, 0 }, // 1
	{ "gimmevisual1",	1, 2, 0, 0, 0, 1, 1, 0 }, // 2
	{ "gimmevisual2"	1, 2, 0, 0, 0, 1, 1, 0 }, // 3
	{ "gimmechingy"		6, 0, 0, 0, 0, 0, 0, 0 }, // 4
	{ ""			0, 0, 0, 0, 0, 0, 0, 0 }, // 5
	{ ""			0, 0, 0, 0, 0, 0, 0, 0 }, // 6
	{ ""			0, 0, 0, 0, 0, 0, 0, 0 }, // 7
	{ ""			0, 0, 0, 0, 0, 0, 0, 0 }, // 8
	{ ""			0, 0, 0, 0, 0, 0, 0, 0 }, // 9
	{ ""			0, 0, 0, 0, 0, 0, 0, 0 }, // 10
	{ ""			0, 0, 0, 0, 0, 0, 0, 0 }, // 11
	{ ""			0, 0, 0, 0, 0, 0, 0, 0 }, // 12
	{ ""			0, 0, 0, 0, 0, 0, 0, 0 }, // 13
	{ ""			0, 0, 0, 0, 0, 0, 0, 0 }, // 14
	{ ""			0, 0, 0, 0, 0, 0, 0, 0 }, // 15
	{ ""			0, 0, 0, 0, 0, 0, 0, 0 }, // 16
	{ ""			0, 0, 0, 0, 0, 0, 0, 0 }, // 17
	{ ""			0, 0, 0, 0, 0, 0, 0, 0 }, // 18
	{ ""			0, 0, 0, 0, 0, 0, 0, 0 }, // 19
};
// after <a class='funcref' href='#575770'>575770:InitCheats_()</a> was called, it looks like this:
// hashes are done with case sensitive hash
struct CheatData <a class='fieldref' href='#7FB960'>7FB960:cheatData</a>[20] = {
	{ "needperformance1",	2, 0x00000001, 0, 0, 0, 1, 1, 0 }, //
	{ "needperformance2",	2, 0x00000002, 0, 0, 0, 1, 1, 0 }, //
	{ "gimmevisual1",	1, 0x00000002, 0, 0, 0, 1, 1, 0 }, //
	{ "gimmevisual2"	1, 0x00000002, 0, 0, 0, 1, 1, 0 }, //
	{ "gimmechingy"		6, 0x3EE7D094, 0, 0, 0, 1, 1, 0 }, // "SPONSOR_CHINGY"
	{ "wannacapone"		6, 0x3E6D00C8, 0, 0, 0, 1, 1, 0 }, // "SPONSOR_CAPONE"
	{ "wantmyd3"		6, 0x54E32D29, 0, 0, 0, 1, 1, 0 }, // "SPONSOR_D3"
	{ "shinestreetbright"	6, 0xE57B6400, 0, 0, 0, 1, 1, 0 }, // "SPONSOR_SHINESTREET"
	{ "davidchoeart"	6, 0x7760C479, 0, 0, 0, 1, 1, 0 }, // "SPONSOR_DAVIDCHOE"
	{ "tunejapantuning"	6, 0x002F98F1, 0, 0, 0, 1, 1, 0 }, // "SPONSOR_JAPANTUNING"
	{ "yodogg"		6, 0x007090A1, 0, 0, 0, 1, 1, 0 }, // "SPONSOR_SNOOP_DOGG"
	{ "opendoors"		6, 0x4BAECE79, 0, 0, 0, 1, 1, 0 }, // "SPONSOR_THE_DOORS"
	{ "needmybestbuy"	7, 0x9E52EAC1, 0, 0, 0, 1, 1, 0 }, // "AD_BESTBUY"
	{ "goforoldspice"	7, 0x5FD7B956, 0, 0, 0, 1, 1, 0 }, // "AD_OLDSPICE"
	{ "gottaedge"		7, 0x44C47B98, 0, 0, 0, 1, 1, 0 }, // "AD_EDGE"
	{ "gottahavebk"		7, 0xCF5F6873, 0, 0, 0, 1, 1, 0 }, // "AD_BURGERKING"
	{ "gotmycingular"	7, 0x7C504338, 0, 0, 0, 1, 1, 0 }, // "AD_CINGULAR"
	{ "regmybank"		5, 0x00000002, 0, 0, 0, 1, 1, 0 }, //
	{ "regmebaby"		5, 0x00000003, 0, 0, 0, 1, 1, 0 }, //
	{ "ordermebaby"		5, 0x00000004, 0, 0, 0, 1, 1, 0 }, //
};

void __thiscall <a class='funcref' href='#575770'>575770:InitCheats_()</a>(struct CheatScreenData *data)
{
	int i;

	cheatScreenData.ppFunc = (void*) 0x7A0604;
	cheatScreenData.doCheatCheck = 0;
	cheatScreenData.cheats = cheatData;
	cheatScreenData.numCheats = 20;
	cheatScreenData.typedCheatLength = 0;
	cheatScreenData.field38 = 0;

	for (i = 0; i &lt; 20; i++) {
		if (cheatData[i].cheatType == CHEAT_TYPE_VINYL &amp;&amp;
			cheatData[i].someHash == hashCS43DB50("AD_BESTBUY") &amp;&amp;
			_gameRegion != 0 /*REGION_US*/)
		{
			cheatData[i].cheatEnabled = 0;
		}
	}
}
</pre><p>Cheats can only be inserted at the 'press enter key' screen at boot. (I remember
this from looking up cheats in my childhood), but toggling sponsor car cheats when
ingame has immediate effect.
</p><p><strong>Symbols:</strong></p><ul><li><span class='func' id='575770'>575770 void __thiscall InitCheats_(<a href='#struct_CheatScreenData'>struct CheatScreenData</a> *this)</span>
  Initializes <a class='fieldref' href='#865930'>865930:cheatScreenData</a> and <a class='fieldref' href='#7FB960'>7FB960:cheatData</a>.
</li><li><span class='func' id='576050'>576050 void __thiscall UndoCheat__(<a href='#struct_CheatScreenData'>struct CheatScreenData</a> *this, int cheatdata_field28)</span>
  Weird one, is called on each cheat entry and all cheats with a matching
  <code><a href='#structCheatData_28'>field28</a></code> has zero written to its <code><a href='#structCheatData_30'>hasBeenTriggered</a></code> field.
</li><li><span class='func' id='576090'>576090 int GetExtraCheatedCareerMoney()</span>
  Basically <code>return <a class='fieldref' href='#86512C'>cheatExtraCareerMoney200</a> + <a class='fieldref' href='#865130'>cheatExtraCareerMoney1000</a>;</code>
</li><li><span class='func' id='5760A0'>5760A0 int __thiscall DoCareerCheat(<a href='#struct_CheatScreenData'>struct CheatScreenData</a> *this, int careerCheatIdx)</span>
</li><li><span class='func' id='579CB0'>579CB0 void __thiscall CheatMatched(<a href='#struct_CheatScreenData'>struct CheatScreenData</a> *this, int cheat_index)</span>
  Called from <a class='funcref' href='#57B8B0'>57B8B0:CheatCheck()</a> when a cheat matched.
</li><li><span class='func' id='57B8B0'>57B8B0 void __thiscall CheatCheck(void *this, int keyCode)</span>
  Called from <a class='funcref' href='#55DBD0'>55DBD0:UIHandleKey()</a> when <code><a class='fieldref' href='#865930'>865930:cheatScreenData</a>.<a href='#structCheatScreenData_4'>doCheatCheck</a></code> is non-zero.
</li><li><span class='field' id='7FB960'>7FB960 <a href='#struct_CheatData'>struct CheatData</a> cheatData[20]</span>
</li><li><span class='field' id='8383C8'>8383C8 cheatCareerNeverPossible</span>
  This gets only set to one when a career cheat with <a class='fieldref' href='#7FB960'>7FB960:cheatData</a> zero is entered,
  but all career cheats have a value of 2-4.
  It has one XREF, surrounded by some language stuff? TODO
</li><li><span class='field' id='86512C'>86512C cheatExtraCareerMoney200</span>
  Set to 200 when the <em>regmybank</em> cheat was entered.
</li><li><span class='field' id='865130'>865130 cheatExtraCareerMoney1000</span>
  Set to 1000 when the <em>ordermebaby</em> cheat was entered.
</li><li><span class='field' id='865930'>865930 <a href='#struct_CheatScreenData'>struct CheatScreenData</a> cheatScreenData</span>
</li></ul><p style='margin-bottom:0'><a href='#index'>Index</a></p></div><span id='carmodeldata'></span><div><h2>Car model data <a href="#carmodeldata">#</a></h2>
<p>When jumping around XREFs I stumbled upon a function that I named <a class='funcref' href='#511E60'>511E60:GetLogoForCarModel()</a>.
It uses a lot of strings that are manufacturers and stuff like <code>CARSELECT_MANUFACTURER_%s</code>.
There are two parameters, the first seems to be the index of the car and the second is if
the caller wants the manufacturer logo or the brand logo.
The function gave some nice information:
</p><ul><li><a class='fieldref' href='#8A1CCC'>8A1CCC:ptrCarData</a> is a pointer to something that's probably car model data
</li><li>That data is an array with component size <code>0x890</code>
</li><li>At <code>+0x0</code>, there is a brand name
</li><li>At <code>+0xC0</code>, there is a manufacturer name
</li><li>(returning zero from this func will show a star image for the manufacturer/brand)
</li></ul><p>After hooking and printing addresses, some more obvious data could be seen:
</p><ul><li>At <code>+0x20</code> is a the brand name again
</li><li>At <code>+0x40</code> is a geometry path (example <code>CARS\A3\GEOMETRY.BIN</code>)
</li><li>At <code>+0x60</code> is a geometry path (example <code>CARS\A3\GEOMETRY.LZC</code>)
</li></ul><p><strong>Symbols:</strong></p><ul><li><span class='func' id='511E60'>511E60 void *GetLogoForCarModel(int car_model_index, char get_manufacturer_logo)</span>
  TODO: what is the return type?
</li></ul><p style='margin-bottom:0'><a href='#index'>Index</a></p></div><span id='sound'></span><div><h2>Sound <a href="#sound">#</a></h2>
<p><strong>Symbols:</strong></p><ul><li><span class='func' id='458520'>458520 void __thiscall PlaySound_(void *this, void *sound)</span>
</li><li><span class='func' id='51DE60'>51DE60 int PlayUISoundEffect(void *unknownUnused, int soundID)</span>
  Discovered when looking at cheats. 8 is some choose sound, 9 too, .. TODO other IDs.
</li><li><span class='field' id='82B884'>82B884 pSoundEffectSystem?</span>
  pointer to what is used as <code>this</code> for calls to <a class='funcref' href='#458520'>458520:PlaySound_()</a>
</li></ul><p style='margin-bottom:0'><a href='#index'>Index</a></p></div><span id='career'></span><div><h2>Career <a href="#career">#</a></h2>
<p><a class='fieldref' href='#83648C'>83648C:autoLoadLastProfileIntoCareer?</a> is a weird variable. It changes the boot process so when <code>UI_Main.fng</code> is loaded,
the game immediately goes in career freeroam after loading a profile.
Except, you're in Rachel's car. When entering a shop, you're back in your own car,
but when exiting the GPS is set to the crib. When arriving at the crib though, you can't
enter it. However, you can enter the crib if that first shop you entered was the car lot.
</p><p>Doing this on a finished career profile will put you in Rachel's car at the airport parking,
just like when starting a new career. The end of game sms will be open. When driving, the
phonecalls from the start of the game come in (friends telling Rachel where the races are
going on), but they don't appear on the map.
</p><p>My best guess is that this 'load into career' option is a cut/unfinished feature.
</p><p style='margin-bottom:0'><a href='#index'>Index</a></p></div><span id='markers'></span><div class='indent' style='margin-left:5em'><p style='margin-top:0'><small><a href='#career'>Career</a> &gt; Markers</small></p><h3>Markers <a href="#markers">#</a></h3>
<p>The money pickup/info pickup(engage sms messages)/race/shop/garage markers.
They are in bin section <code>0x3414A</code>, which is in bin section <code>0x80034147</code>, in <code>TRACKS\ROUTESL4R%c\Paths%d.bin</code>.
Bin section <code>0x80034147</code> is loaded in <a class='funcref' href='#5D9A90'>5D9A90:Markers::InitFromBinData()</a>.
</p><p>Not loading bin section <code>0x3414A</code> results in no career markers at all, and no traffic (but other racers do still spawn).
</p><pre><span id='struct_Markers'></span>struct Markers {

};

#define MARKER_TYPE_BODYSHOP_AREA 0x4 /*marks the entrance, ie where the road goes into private property, not the entrace aura itself*/
#define MARKER_TYPE_NEIGHBOURHOOD 0x10
#define MARKER_TYPE_ENGAGE_TIP 0x12
#define MARKER_TYPE_MONEY_PICKUP 0x13

<span id='struct_Marker'></span>struct Marker {
        char <span id='structMarker_0'></span>type;
        char field_1;
        char field_2;
        char field_3;
        int field_4;
        int field_8;
        int field_C;
        int field_10;
        int field_14;
        int field_18;
        int field_1C;
        int field_20;
        int field_24;
        int field_28;
        int field_2C;
        unsigned int <span id='structMarker_30'></span>hash; /*for neighbourhood: hash of name, for engage: hash of sms name*/
        int field_34;
        int field_38;
        int field_3C;
        short <span id='structMarker_40'></span>radius?;
        short <span id='structMarker_42'></span>markerStructSize;
        float <span id='structMarker_44'></span>pos_x;
        float <span id='structMarker_48'></span>pos_y;
};

<span id='struct_NeighbourhoodName'></span>struct NeighbourhoodName {
        char *<span id='structNeighbourhoodName_0'></span>name;
        unsigned int <span id='structNeighbourhoodName_4'></span>hash;
};
</pre><p><strong>Symbols:</strong></p><ul><li><span class='func' id='5D3DE0'>5D3DE0 <a href='#struct_NeighbourhoodName'>struct NeighbourhoodName</a> *GetNeighbourhoodNameForHash(unsigned int hash)</span>
  On first call (checked with <a class='fieldref' href='#883D9C'>883D9C:neighbourhoodHashesCalculatedAlready</a>), calculate all the hashes in <a class='fieldref' href='#800C38'>800C38:neighbourhoodNames</a>.
</li><li><span class='func' id='5D9A90'>5D9A90 int __thiscall Markers::InitFromBinData(<a href='#struct_Markers'>struct Markers</a> *this, <a href='#struct_BinSection'>struct BinSection</a> *binsection)</span>
</li><li><span class='func' id='5D9BF0'>5D9BF0 <a href='#struct_Marker'>struct Marker</a> *__thiscall Markers::FindAtPosWithTypeAfterIndex(<a href='#struct_Markers'>struct Markers</a> *this,
                                                                           float *atPosition,
                                                                           int type,
                                                                           <a href='#struct_Marker'>struct Marker</a> *after)</span>
  <code>atPosition</code> can be null, then it'll just return the first marker. When <code>after</code> is not null, the search starts
  after that specific marker.
</li><li><span class='field' id='88F298'>88F298 <a href='#struct_Markers'>struct Markers</a> markerData</span>
</li><li><span class='field' id='800C38'>800C38 struct NeighbourhoodName neighbourhoodNames[13]</span>
</li><li><span class='field' id='883D9C'>883D9C char neighbourhoodHashesCalculatedAlready</span>
</li></ul><p style='margin-bottom:0'><a href='#index'>Index</a></p></div><span id='sms_stuff'></span><div class='indent' style='margin-left:5em'><p style='margin-top:0'><small><a href='#career'>Career</a> &gt; SMS stuff</small></p><h3>SMS stuff <a href="#sms_stuff">#</a></h3>
<p>Dump of all sms message data: <a href="smsdump.txt">smsdump.txt</a>.
This data is in bin section <code>0x34A17</code> (which is inside bin section <code>0x80034A10</code>,
which is in file <code>GLOBAL/GLOBALB.BUN</code>).
</p><pre>#define <span id='SMS_TYPE_END_OF_GAME'></span>SMS_TYPE_END_OF_GAME 1
/*      ^ 1 msg:
        SMS_END_OF_GAME_MESSAGE
*/
#define <span id='SMS_TYPE_CAREER_START'></span>SMS_TYPE_CAREER_START 2
/*      ^ 3 msgs:
        SMS_LOC_GO_TO_GARAGE
        SMS_LOC_EVENTS_OUT_THERE
        SMS_GPS_INTRO
*/
#define <span id='SMS_TYPE_INSTRUCTIONS'></span>SMS_TYPE_INSTRUCTIONS 3
/*      ^ 4 msgs:
        SMS_INSTRUCTION
        SMS_MINIMAP_INTRUCTION
        SMS_MINIMAP_LEGEND_BLURB
        SMS_STEERING_CONTROLS
*/
#define <span id='SMS_TYPE_OUTRUN_INFO'></span>SMS_TYPE_OUTRUN_INFO 4
/*      ^ 1 msg:
        SMS_OUTRUN_INFO
*/
#define <span id='SMS_TYPE_OUTRUN_VICTORY'></span>SMS_TYPE_OUTRUN_VICTORY 5
/*      ^ 1 msg:
        SMS_OUTRUN_VICTORY
*/
#define <span id='SMS_TYPE_OUTRUN_DEFEAT'></span>SMS_TYPE_OUTRUN_DEFEAT 6
/*      ^ 1 msg:
        SMS_OUTRUN_DEFEAT
*/
#define <span id='SMS_TYPE_UNLOCK_9'></span>SMS_TYPE_UNLOCK_9 9
/*      ^ 5 part unlock msgs*/
#define <span id='SMS_TYPE_UNLOCK_10'></span>SMS_TYPE_UNLOCK_10 10
/*      ^ part unlock/region unlock/car unlock msgs
        SMS_LOC_TEXT_JACKSON_HEIGHTS
        SMS_LOC_TEXT_COAL_HARBOR
        SMS_LOC_TEXT_COAL_HARBOR_WEST
*/
#define <span id='SMS_TYPE_UNLOCK_12'></span>SMS_TYPE_UNLOCK_12 12
/*      ^ part unlock/region unlock/angry Rachel/sponsor msgs
        SMS_LOC_TEXT_BEACON_HILL
        SMS_LOC_GO_TO_CAR_LOT_NOW
        SMS_LOC_X_SPONSOR
*/
#define <span id='SMS_TYPE_MAGS_AND_UNIQUES'></span>SMS_TYPE_MAGS_AND_UNIQUES 13
/*      ^ magazine/unqiue parts msgs*/
#define <span id='SMS_TYPE_DVD_COVER'></span>SMS_TYPE_DVD_COVER 14
/*      ^ 10 dvd cover msgs*/
#define <span id='SMS_TYPE_ENGAGE_TIP'></span>SMS_TYPE_ENGAGE_TIP 15
/*      ^ 42 tip msgs, from the ingame markers you have to drive through*/
</pre><pre><span id='struct_Mailbox'></span>struct Mailbox {
        int field_0;
        int field_4;
        int field_8;
        int field_C;
        int field_10;
        int field_14;
        int <span id='structMailbox_18'></span>mailboxId; /*1 inbox, 2 game tips, 3 special events, 4 Rachel, 5 unlocks*/
};

<span id='struct_MailboxFNGObject'></span>struct MailboxFNGObject {
        /*TODO*/

        /*+0x120*/
        <a href='#struct_Mailbox'>struct Mailbox</a> *<span id='structMailboxFNGObject_120'></span>currentBrowsingMailbox;
};

<span id='struct_SmsData'></span>struct SmsData {
	/*offset in language table <a class='fieldref' href='#838428'>ptr838428</a>*/
	short <span id='structSmsData_0'></span>careerTextLanguageTableOffset;
	char <span id='structSmsData_2'></span>type;
	char <span id='structSmsData_3'></span>mailboxId; /*1 inbox, 2 game tips, 3 special events, 4 Rachel, 5 unlocks*/
	int field_4;
	int <span id='structSmsData_8'></span>field_8;
	int <span id='structSmsData_C'></span>moneyReward;
	unsigned int <span id='structSmsData_10'></span>senderLanguageLabel;
};

<span id='struct_SmsMessage'></span>struct SmsMessage {
	<a href='#struct_SmsData'>struct SmsData</a> *<span id='structSmsMessage_0'></span>data;
	char <span id='structSmsMessage_4'></span>read;
	char field_5;
	char <span id='structSmsMessage_6'></span>deleted;
	char <span id='structSmsMessage_7'></span>movedToCorrectInbox;
	unsigned int <span id='structSmsMessage_8'></span>bodyFormatLanguageLabel;
	unsigned int <span id='structSmsMessage_C'></span>subjectAndBodyParameterLanguageLabel;
	unsigned int <span id='structSmsMessage_10'></span>subjectFormatLanguageLabel;
};

<span id='struct_SmsMessageList'></span>struct SmsMessageList {
        <a href='#struct_SmsMessage'>struct SmsMessage</a> <span id='structSmsMessageList_0'></span>messages[256];
        int <span id='structSmsMessageList_1400'></span>numMessages;
        int <span id='structSmsMessageList_1404'></span>numUnreadMessages;
        int field_1408;
        char field_140C;
        char field_140D;
        char field_140E;
        char field_140F;
        int field_1410;
};

<span id='struct_SmsListEntry'></span>struct SmsListEntry {
        void *vtable;
        int field_4;
        int field_8;
        <a href='#struct_ObjectLink'>struct ObjectLink</a> *<span id='structSmsListEntry_C'></span>link;
        char field_14;
        char field_15;
        char field_16;
        char field_17;
        <a href='#struct_SmsMessage'>struct SmsMessage</a> *<span id='structSmsListEntry_18'></span>sms;
};
</pre><p><strong>Symbols:</strong></p><ul><li><span class='func' id='4976B0'>4976B0 void __cdecl ShowMailboxOrSingleUnreadSms()</span>
  TODO check where this is called, it will be the carreer game state's keyhandler.
  TODO has some references to unknown fields
  When <a class='funcref' href='#514D30'>514D30:GetNumUnreadSmsMessages()</a> returns <code>1</code>, immediately open that message. Show mailbox otherwise.
</li><li><span class='func' id='497760'>497760 void GetSmsMessageSubjectHeader(<a href='#struct_SmsMessage'>struct SmsMessage</a> *sms, char *dest, int maxLength)</span>
  Gets the subject from <a class='funcref' href='#5149C0'>5149C0:GetSmsMessageSubject()</a> and prepends <code>Subject: </code> to it (based on language).
  Used by <a class='funcref' href='#4CC7C0'>4CC7C0:SmsListEntry::ctor()</a> and <a class='funcref' href='#497850'>497850:ShowSmsMessage()</a>.
  <details><summary>Implementation <code><a href='https://github.com/yugecin/nfsu2-re/blob/master/nfsu2-re-hooks/replace-497760-GetSmsMessageSubjectHeader.c'>nfsu2-re-hooks/replace-497760-GetSmsMessageSubjectHeader.c</a></code></summary>
<pre>char *subjectFormat;
char subject[100];

subjectFormat = <a class='funcref' href='#4FF9D0'>GetLanguageStringOrNull</a>(0x4B5DE3E9/*SMS_SUBJECT_HEADER*/);
<a class='funcref' href='#5149C0'>GetSmsMessageSubject</a>(sms, subject, sizeof(subject));
sprintf(dest, subjectFormat, subject);
</pre>  </details>
</li><li><span class='func' id='4977C0'>4977C0 void HideSmsMailbox()</span>
</li><li><span class='func' id='497850'>497850 int __thiscall ShowSmsMessage(void *this, void *arg)</span>
  TODO, called from <a class='funcref' href='#4B2240'>4B2240:FNGINIT_UI_EngageMessageDialog_fng()</a>
</li><li><span class='func' id='4CBB60'>4CBB60 void __thiscall SmsListEntry::dtor(<a href='#struct_SmsListEntry'>struct SmsListEntry</a> *this, char doFreeMem)</span>
</li><li><span class='func' id='4CC7C0'>4CC7C0 <a href='#struct_SmsListEntry'>struct SmsListEntry</a> *__thiscall SmsListEntry::ctor(<a href='#struct_SmsListEntry'>struct SmsListEntry</a> *this,
                                                               <a href='#struct_SmsMessage'>struct SmsMessage</a> *sms)</span>
</li><li><span class='func' id='4CC900'>4CC900 void __thiscall ShowSmsList(<a href='#struct_MailboxFNGObject'>struct MailboxFNGObject</a> *this)</span>
</li><li><span class='func' id='4E1BF0'>4E1BF0 void __thiscall MailboxFNGObject::ctor(struct MailboxFNGObject *this, void *fnginitarg)</span>
</li><li><span class='func' id='4E2050'>4E2050 FNGINIT_UI_SMS_Mailbox_fng</span>
  Allocates memory and calls <a class='funcref' href='#4E1BF0'>4E1BF0:MailboxFNGObject::ctor()</a>.
  TODO
</li><li><span class='func' id='5012F0'>5012F0 void storeSmsDatas(char *data, int size)</span>
  Called from <a class='funcref' href='#512C00'>512C00:LoadBinSection80034A10()</a>. Data is a bin section with magic <code>0x34A17</code> (which is inside bin section
  <code>80034A10</code>).
<pre><a class='fieldref' href='#838454'>smsDatas</a> = (void*) data;
<a class='fieldref' href='#838450'>numSmsDatas</a> = size / 20;
</pre></li><li><span class='func' id='501310'>501310 <a href='#struct_SmsData'>struct SmsData</a> *__cdecl GetSmsDataForHash(int hash)</span>
  Goes through all <a class='fieldref' href='#838454'>838454:smsDatas</a> and returns the one that has a matching
  <code>cshash(<a class='fieldref' href='#838428'>ptr838428</a> + <a href='#structSmsData_0'>careerTextLanguageTableOffset</a>)</code>.
</li><li><span class='func' id='501470'>501470 unsigned int __thiscall GetSmsSenderLanguageHash(<a href='#struct_SmsMessage'>struct SmsMessage</a> *this)</span>
  Returns the hash for the language string that is the sms sender.
  Used once in <a class='funcref' href='#497850'>497850:ShowSmsMessage()</a>.
<pre>return this-&gt;<a href='#structSmsMessage_0'>data</a>.<a href='#structSmsData_10'>senderLanguageLabel</a>;
</pre></li><li><span class='func' id='5014A0'>5014A0 <a href='#struct_SmsMessage'>struct SmsMessage</a> *__thiscall SmsMessageList::GetAtIndex(<a href='#struct_SmsMessageList'>struct SmsMessageList</a> *this,
                                                                     int index)</span>
  TODO: check xrefs
</li><li><span class='func' id='5014C0'>5014C0 void __thiscall SmsMessageList::MarkMessageDeletedAndRead(<a href='#struct_SmsMessageList'>struct SmsMessageList</a> *this,
                                                                    <a href='#struct_SmsMessage'>struct SmsMessage</a> *sms)</span>
<pre>if (!sms-&gt;<a href='#structSmsMessage_6'>deleted</a> &amp;&amp; !sms-&gt;<a href='#structSmsMessage_4'>read</a>) {
      this-&gt;<a href='#structSmsMessageList_1404'>numUnreadMessages</a>--;
}
sms-&gt;<a href='#structSmsMessage_6'>deleted</a> = 1;
sms-&gt;<a href='#structSmsMessage_4'>read</a> = 1;
</pre></li><li><span class='func' id='5149C0'>5149C0 void __thiscall GetSmsMessageSubject(<a href='#struct_SmsMessage'>struct SmsMessage</a> *this, char *dest, int maxlen)</span>
  <details><summary>Implementation <code><a href='https://github.com/yugecin/nfsu2-re/blob/master/nfsu2-re-hooks/replace-5149C0-GetSmsMessageSubject.c'>nfsu2-re-hooks/replace-5149C0-GetSmsMessageSubject.c</a></code></summary>
<pre>char *format;
char *parameter;
char *str;
char buffer[50];

if (this-&gt;<a href='#structSmsMessage_10'>subjectFormatLanguageLabel</a>) {
        format = <a class='funcref' href='#4FFA80'>GetLanguageString</a>(this-&gt;<a href='#structSmsMessage_10'>subjectFormatLanguageLabel</a>);
        parameter = <a class='funcref' href='#4FFA80'>GetLanguageString</a>(this-&gt;<a href='#structSmsMessage_C'>subjectAndBodyParameterLanguageLabel</a>);
        sprintf(dest, format, parameter);
        // example format: %s cover opportunity
        // example param: AutoMaxx Magazine
        return;
}

str = getCareerString(this-&gt;<a href='#structSmsMessage_0'>data</a>.<a href='#structSmsData_0'>careerTextLanguageTableOffset</a>);
if (!<a class='funcref' href='#43DC60'>strncmp</a>(str, "SMS_CAR_UNLOCK_", <a class='funcref' href='#43DBB0'>strlenWithNullcheck</a>("SMS_CAR_UNLOCK_"))) {
        str = <a class='funcref' href='#4FFA80'>GetLanguageString</a>(0xF81E6031/*SMS_CAR_UNLOCK_1_SUBJECT*/);
        <a class='funcref' href='#43DBD0'>strcpy</a>(dest, str);
        // example: SMS_CAR_UNLOCK_17
        // example: SMS_CAR_UNLOCK_16
        return;
}

<a class='funcref' href='#50B990'>FormatWithSinglePlaceholderAndHashCS43DB50</a>(dest, "%s_SUBJECT", str);
// example: ENGAGE_TIP_CAREER_PROG_SUBJECT
// example: SMS_DVD_COVER_10_SUBJECT
</pre>  </details>
</li><li><span class='func' id='514B00'>514B00 void __thiscall GetSmsMessageBody(<a href='#struct_SmsMessage'>struct SmsMessage</a> *this, char *dest, int maxlen)</span>
  Used once in <a class='funcref' href='#497850'>497850:ShowSmsMessage()</a>.
  <details><summary>Implementation <code><a href='https://github.com/yugecin/nfsu2-re/blob/master/nfsu2-re-hooks/replace-514B00-GetSmsMessageBody.c'>nfsu2-re-hooks/replace-514B00-GetSmsMessageBody.c</a></code></summary>
<pre>char *format;
char *parameter;
char *str;
char buffer[128];

if (this-&gt;<a href='#structSmsMessage_8'>bodyFormatLanguageLabel</a>) {
        format = <a class='funcref' href='#4FFA80'>GetLanguageString</a>(this-&gt;<a href='#structSmsMessage_8'>bodyFormatLanguageLabel</a>);
        parameter = <a class='funcref' href='#4FFA80'>GetLanguageString</a>(this-&gt;<a href='#structSmsMessage_C'>subjectAndBodyParameterLanguageLabel</a>);
        sprintf(dest, format, parameter);
        // example format: One of my contacts has just called to let me know that a photographer
                           from %s is in town looking for hot cars for next month's cover.
                           Head to the star on the map and I'll call you with more details when
                           you get there.
        // example param: Street Tuner
        return;
}

str = getCareerString(this-&gt;<a href='#structSmsMessage_0'>data</a>.<a href='#structSmsData_0'>careerTextLanguageTableOffset</a>);
if (!<a class='funcref' href='#43DC60'>strncmp</a>(str, "SMS_CAR_UNLOCK_", strlen("SMS_CAR_UNLOCK_"))) {
        str = <a class='funcref' href='#4FFA80'>GetLanguageString</a>(cihash("SMS_CAR_UNLOCK_1_BODY"));
        <a class='funcref' href='#43DBD0'>strcpy</a>(dest, str);
        // example: SMS_CAR_UNLOCK_17
        // example: SMS_CAR_UNLOCK_16
        return;
}

if (!<a class='funcref' href='#43DC60'>strncmp</a>(str, "ENGAGE_TIPS_AUTO", strlen("ENGAGE_TIPS_AUTO"))) {
        str = <a class='funcref' href='#4FFA80'>GetLanguageString</a>(cihash("ENGAGE_TIPS_AUTO_BODY"));
        <a class='funcref' href='#43DBD0'>strcpy</a>(dest, str);
        // Could not find any of these?
        // This is a single message about the autosave feature
        // This func probably prevents ENGAGE_TIPS_AUTO_XBOX from showing
        return;
}

sprintf(buffer, "%s_BODY", str);
str = <a class='funcref' href='#4FFA80'>GetLanguageString</a>(cihash(buffer));
<a class='funcref' href='#43DBD0'>strcpy</a>(dest, str);
// example: SMS_OUTRUN_DEFEAT_BODY
// example: SMS_END_OF_GAME_MESSAGE_BODY
</pre>  </details>
</li><li><span class='func' id='514CB0'>514CB0 int __thiscall SmsMessageList::IsMessageAlreadyReceived(<a href='#struct_SmsMessageList'>struct SmsMessageList</a> *this,
                                                                  <a href='#struct_SmsData'>struct SmsData</a> *smsdata)</span>
</li><li><span class='func' id='514CF0'>514CF0 <a href='#struct_SmsMessage'>struct SmsMessage</a> *__thiscall GetFirstUnreadSmsMessage(<a href='#struct_SmsMessageList'>struct SmsMessageList</a> *this)</span>
</li><li><span class='func' id='514D30'>514D30 int __thiscall GetNumUnreadSmsMessages(<a href='#struct_SmsMessageList'>struct SmsMessageList</a> *this, int useCachedFlag)</span>
  When <code>useCachedFlag</code>, just return <code><a class='funcref' href='#860A60'>smsMessages</a>.<a href='#structSmsMessageList_1404'>numUnreadMessages</a></code>, otherwise count all
  <code><a class='funcref' href='#860A60'>smsMessages</a>.<a href='#structSmsMessageList_0'>messages</a></code> that have both <code><a href='#structSmsMessage_4'>read</a></code> and
  <code><a href='#structSmsMessage_6'>deleted</a></code> on <code>0</code>.
  TODO check other xref, probably for displaying icon ingame
</li><li><span class='func' id='514D80'>514D80 void __thiscall SetReadMessagesMovedToCorrectInbox(<a href='#struct_SmsMessageList'>struct SmsMessageList</a> *this)</span>
  For every message, set flag <code><a href='#structSmsMessage_7'>movedToCorrectInbox</a></code> when flag <code><a href='#structSmsMessage_4'>read</a></code> is set.
</li><li><span class='func' id='514E10'>514E10 int __thiscall SmsMessageList::IsEngageTipUncollected(<a href='#struct_SmsMessageList'>struct SmsMessageList</a> *this, void *engageTip)</span>
</li><li><span class='func' id='5295F0'>5295F0 <a href='#struct_SmsMessage'>struct SmsMessage</a> *__thiscall SmsMessageList::SendMessage(<a href='#struct_SmsMessageList'>struct SmsMessageList</a> *this,
                                                                      <a href='#struct_SmsData'>struct SmsData</a> *smsdata)</span>
  Checks with <a class='funcref' href='#514CB0'>514CB0:SmsMessageList::IsMessageAlreadyReceived()</a> first.
</li><li><span class='func' id='529670'>529670 <a href='#struct_SmsMessage'>struct SmsMessage</a> *__thiscall SmsMessageList::SendMessageFormatted(<a href='#struct_SmsMessageList'>struct SmsMessageList</a> *this,
                                                                               <a href='#struct_SmsData'>struct SmsData</a> *smsdata,
                                                                               unsigned int bodyFormatLanguageLabel,
                                                                               unsigned int subjectFormatLanguageLabel,
                                                                               unsigned int subjectParameterLanguageLabel)</span>
  Checks with <a class='funcref' href='#514CB0'>514CB0:SmsMessageList::IsMessageAlreadyReceived()</a> first.
</li><li><span class='func' id='529860'>529860 int __thiscall SmsMessageList::SendSomeCareerStartMsgs?(<refoto>struct SmsMessageList</refoto> *this, void *arg0)</span>
  Goes through all <a class='fieldref' href='#838454'>838454:smsDatas</a> and send all unreceived messages with <code><a href='#structSmsData_2'>type</a></code> 8 (My game files do not have any messages
  with that type)? Also checks for type <code><a href='#SMS_TYPE_CAREER_START'>SMS_TYPE_CAREER_START</a></code>, then does more checks with <code>arg0</code> before sending.
</li><li><span class='func' id='5299B0'>5299B0 void __thiscall SmsMessageList::SendDVDCoverSmsWithIndex(<a href='#struct_SmsMessageList'>struct SmsMessageList</a> *this, int index)</span>
  Goes through all <a class='fieldref' href='#838454'>838454:smsDatas</a> and send every one that hasn't been received yet and has <code><a href='#structSmsData_2'>type</a> ==
  <a href='#SMS_TYPE_DVD_COVER'>SMS_TYPE_DVD_COVER</a></code> and <code><a href='#structSmsData_8'>field_8</a> == index</code> by using <a class='funcref' href='#5295F0'>5295F0:SmsMessageList::SendMessage()</a>
  (which already has a check for if it was already received...).
</li><li><span class='func' id='529B50'>529B50 void __thiscall SmsMessageList::SendOutrunInfoSms(<a href='#struct_SmsMessageList'>struct SmsMessageList</a> *this)</span>
  Goes through all <a class='fieldref' href='#838454'>838454:smsDatas</a> and send every one that hasn't been received yet and has <code><a href='#structSmsData_2'>type</a> ==
  <a href='#SMS_TYPE_OUTRUN_INFO'>SMS_TYPE_OUTRUN_INFO</a></code> by using <a class='funcref' href='#5295F0'>5295F0:SmsMessageList::SendMessage()</a> when it wasn't received yet.
  (which already has a check for if it was already received...).
  This only matches the <code>SMS_OUTRUN_INTRO</code> SMS.
</li><li><span class='func' id='529BD0'>529BD0 void __thiscall SmsMessageList::SendOutrunVictoryOrDefeatSms(<a href='#struct_SmsMessageList'>struct SmsMessageList</a> *this, int didWin)</span>
  Goes through all <a class='fieldref' href='#838454'>838454:smsDatas</a>. When <code>didWin</code> is 1, send all with <code><a href='#structSmsData_2'>type</a> == <a href='#SMS_TYPE_OUTRUN_VICTORY'>SMS_TYPE_OUTRUN_VICTORY</a></code>, else send
  all with <code><a href='#structSmsData_2'>type</a> == <a href='#SMS_TYPE_OUTRUN_DEFEAT'>SMS_TYPE_OUTRUN_DEFEAT</a></code>. Uses <a class='funcref' href='#5295F0'>5295F0:SmsMessageList::SendMessage()</a>.
</li><li><span class='func' id='529C40'>529C40 <a href='#struct_SmsData'>struct SmsData</a> *__thiscall SmsMessageList::SendEngageTipSmsMessage(<a href='#struct_SmsMessageList'>struct SmsMessageList</a> *this,
                                                                               void *engageMarker)</span>
  Returns null when it was already received.
</li><li><span class='func' id='533890'>533890 <a href='#struct_SmsMessage'>struct SmsMessage</a> *__thiscall SmsMessageList::SendMessageByHash(<a href='#struct_SmsMessageList'>struct SmsMessageList</a> *this,
                                                                            int hash)</span>
  Combines <a class='funcref' href='#501310'>501310:GetSmsDataForHash()</a>, <a class='funcref' href='#514CB0'>514CB0:SmsMessageList::IsMessageAlreadyReceived()</a> and <a class='funcref' href='#5295F0'>5295F0:SmsMessageList::SendMessage()</a>.
</li><li><span class='func' id='5338C0'>5338C0 void __thiscall SmsMessageList::SendMagOrUnlockMessage(<a href='#struct_SmsMessageList'>struct SmsMessageList</a> *this, ?)</span>
  Uses <a class='funcref' href='#529670'>529670:SmsMessageList::SendMessageFormatted()</a>.
  TODO
</li><li><span class='field' id='83632C'>83632C int smsOpenType</span>
  0 = mailbox is not on screen.
  1 = mailbox opened from tab straight into sms (when one sms is unread),
  then esc goes to the category of the msg.
  2 = mailbox opened from tab into inbox, then esc goes to the index again.
</li><li><span class='field' id='838450'>838450 numSmsDatas</span>
  Number of stuffs in <a class='fieldref' href='#838454'>838454:smsDatas</a>.
  Loaded in <a class='funcref' href='#5012F0'>5012F0:storeSmsDatas()</a>.
</li><li><span class='field' id='838454'>838454 <a href='#struct_SmsData'>struct SmsData</a> *smsDatas</span>
  Loaded in <a class='funcref' href='#5012F0'>5012F0:storeSmsDatas()</a>.
</li><li><span class='func' id='860A60'>860A60 <a href='#struct_SmsMessageList'>struct SmsMessageList</a> smsMessages</span>
  This is <code><a class='fieldref' href='#85AD40'>careerData</a>.<a href='#structCareerData_5D20'>smsMessages</a></code>.
</li></ul><p style='margin-bottom:0'><a href='#index'>Index</a></p></div><div><p style='margin-top:0'><small><a href='#career'>Career</a> (continuation)</small></p><p>Need text here or my parser breaks.
</p><pre><span id='struct_CareerMoney'></span>struct CareerMoney {
	int money;
};

<span id='struct_CareerData'></span>struct CareerData {
        /*5D20*/
        <a href='#struct_SmsMessageList'>struct SmsMessageList</a> <span id='structCareerData_5D20'></span>smsMessages;
	/*7134*/
	<a href='#struct_CareerMoney'>struct CareerMoney</a> <span id='structCareerData_7134'></span>money;
};
</pre><p>The career money cheat is mildly interesting, as it seems to work in two different
ways. It adds the amount to a variable that is used when a new career is started and
it adds the amount to the current career data if the loaded profile didn't start
career yet.
</p><pre>/*from <a class='funcref' href='#5760A0'>5760A0:DoCareerCheat()</a>*/
/*ordermebaby ($1000 career start bonus)*/
<a class='fieldref' href='#865130'>cheatExtraCareerMoney1000</a> = 1000;
// ^ used when starting a new career from a profile that
// was loaded from the profile menu
if (!<a class='fieldref' href='#86347C'>isProfileWithStartedCareerLoaded</a>)  {
	if (<a class='funcref' href='#500F90'>CareerGetMoney</a>() == 0)  {
		<a class='funcref' href='#500F80'>CareerGiveMoney</a>(1000);
		// ^ This only has an effect when the profile was
		// loaded from the loading screen
	}
}
</pre><p><strong>Symbols:</strong></p><ul><li><span class='func' id='495D30'>495D30 CareerShowSponsorSelectScreen?()</span>
</li><li><span class='func' id='500F90'>500F90 int __thiscall CareerGetMoney(<a href='#struct_CareerMoney'>struct CareerMoney</a> *this)</span>
</li><li><span class='func' id='500180'>500180 char* __thiscall GetCareerLanguageString(short *this)</span>
  Uses <a class='fieldref' href='#838428'>838428:ptr838428</a> along with offset passed in <code>this</code> to return a string.
</li><li><span class='func' id='500F80'>500F80 void __thiscall CareerGiveMoney(<a href='#struct_CareerMoney'>struct CareerMoney</a> *this, int amount)</span>
  Only used in the career money cheats.
</li><li><span class='func' id='5129F0'>5129F0 int __thiscall GetCareerSponsorLanguageKey(short *this)</span>
  Uses <a class='fieldref' href='#838428'>838428:ptr838428</a> along with offset passed in <code>this</code> to format a string <code>SPONSOR_%s</code> and
  return the hash result to use for getting a language string.
</li><li><span class='func' id='528980'>528980 void __thiscall Career::RemoveAllReceivedTipEngageMarkers(<a href='#struct_CareerData'>struct CareerData</a> *this)</span>
</li><li><span class='func' id='532830'>532830 void MaybeStartCareer?()</span>
  It's the only func that calls <a class='funcref' href='#576090'>576090:GetExtraCheatedCareerMoney()</a>.
</li><li><span class='func' id='532D40'>532D40 void __thiscall Career::EngageTipMarkerHit(<a href='#struct_CareerData'>struct CareerData</a> *this, void *engageMarker)</span>
  <details><summary>Imlementation</summary>
<pre><a href='#struct_SmsData'>struct SmsData</a> *smsdata;

smsdata = this-&gt;<a href='#structCareerData_5D20'>smsMessages</a>-&gt;<a class='funcref' href='#529C40'>SmsMessageList::SendEngageTipSmsMessage</a>(engageMarker);
if (smsdata) {
        this-&gt;<a href='#structCareerData_7134'>money</a> += smsdata-&gt;<a href='#structSmsData_C'>moneyReward</a>;
        this-&gt;<a class='funcref' href='#528980'>Career::RemoveAllReceivedTipEngageMarkers</a>();
}
</pre>  </details>
</li><li><span class='field' id='83648C'>83648C char autoLoadLastProfileIntoCareer?</span>
</li><li><span class='field' id='83840C'>83840C ptr83840C</span>
  Pointer to some struct with DVD/SHOW related stuff.
</li><li><span class='field' id='838428'>838428 ptr838428</span>
  Pointer to career related labels/keys.
</li><li><span class='field' id='86347C'>86347C int isProfileWithStartedCareerLoaded</span>
  Fun fact: when creating a new profile,
  this value is set to 0 when the textbox to enter a name appears.
  When canceling at that point, it's set back to 1
  (if the loaded profile already had career started).
</li><li><span class='field' id='85AD40'>85AD40 <a href='#struct_CareerData'>struct CareerData</a> careerData</span>
</li><li><span class='field' id='862838'>862838 int _currentStage</span>
  Maybe this is part of <a href='#struct_CareerData'>struct CareerData</a>?
</li></ul><p style='margin-bottom:0'><a href='#index'>Index</a></p></div><span id='networkstuff'></span><div><h2>LAN/OL <a href="#networkstuff">#</a></h2>
<pre><span id='struct_SocketWrapper'></span>struct SocketWrapper {
        <a href='#struct_SocketWrapper'>struct SocketWrapper</a> *<span id='structSocketWrapper_0'></span>previousSocketWrapper
        int field_4;
        int socket_af;
        int socket_type;
        int socket_protocol;
        int field_14;
        SOCKET socket;
        int field_1C;
        int field_20;
        int field_24;
        int field_28;
        int field_2C;
        int field_30;
        int field_34;
        int field_38;
        int field_3C;
        int field_40;
        int field_44;
        <a href='#struct_SocketWrapperWrapper'>struct SocketWrapperWrapper</a> *socketWrapperWrapper;
        int (*func)(void*,void*,void*); /*actual number of parameters is unknown*/
};

<span id='struct_CriticalSectionWrapper_3'></span>struct CriticalSectionWrapper_3 {
        int lastAccessedThreadId;
        int numActiveLocks;
        int isInCriticalSection;
        CRITICAL_SECTION criticalSection
};
EXPECT_SIZE(struct CriticalSectionWrapper_3, 0x24);

<span id='struct_SocketWrapperWrapper'></span>struct SocketWrapperWrapper {
        <a href='#struct_SocketWrapper'>struct SocketWrapper</a> *socketWrapper;
        int field_4;
        int field_8;
        struct CriticalSectionWrapper_3 criticalSectionWrapper;
        int ptrField_30;
        int field_34;
        int field_38;
};
</pre><p><strong>Symbols:</strong></p><ul><li><span class='func' id='74A220'>74A220 <a href='#struct_SocketWrapper'>struct SocketWrapper</a> *CreateNonBlockingSocket(int af, int type, int protocol)</span>
  Calls Winsock's <code>socket</code>, set it nonblocking (with <code>ioctlsocket</code>).
  In case of <code>type == SOCK_RAW</code>, call <code>setsockopt(s, SOL_SOCKET, SO_BROADCAST, (ptr to 1), 4)</code>.
  Returned value is stored in <a class='fieldref' href='#8B7C9C'>8B7C9C:socketWrapper</a> and the previous value is put in its <code><a href='#structSocketWrapper_0'>previousSocketWrapper</a></code> (this seems to be
  an atomic operation).
</li><li><span class='func' id='74A2D0'>74A2D0 int CloseSocketWrapper(<a href='#struct_SocketWrapper'>struct SocketWrapper</a> *socketWrapper)</span>
  Calls Winsock's <code>shutdown</code> and <code>closesocket</code>. Some critical section stuff.
</li><li><span class='func' id='74A380'>74A380 int BindWrapper(<a href='#struct_SocketWrapper'>struct SocketWrapper</a> *socketWrapper, int name, int namelen)</span>
  Calls Winsock's <code>bind</code>.
  0 on success or <code>WSAEWOULDBLOCK</code>/<code>WSAECONNRESET</code>,
  -2 on <code>WSAENOTCONN</code>,
  -5 on <code>WSAENETUNREACH</code>/<code>WSAEHOSTDOWN</code>,
  -6 on <code>WSAECONNREFUSED</code>,
  -7 on other err.
</li><li><span class='field' id='8B7C9C'>8B7C9C <a href='#struct_SocketWrapper'>struct SocketWrapper</a> *socketWrapper</span>
  Contains latest created socket.
</li></ul><p style='margin-bottom:0'><a href='#index'>Index</a></p></div><span id='d3d9stuff'></span><div><h2>D3D9 Stuff <a href="#d3d9stuff">#</a></h2>
<p><strong>Symbols:</strong></p><ul><li><span class='field' id='86C120'>86C120 struct D3DADAPTER_IDENTIFIER9 _d3d9AdapterIdentifier</span>
</li><li><span class='field' id='870970'>870970 IDirect3D9 *_IDirect3D9ptr</span>
</li><li><span class='field' id='870974'>870974 IDirect3DDevice9 *_IDirect3DDevice9Ptr</span>
</li><li><span class='field' id='8709AC'>8709AC int _displayAdapter</span>
  <em>Ordinal number that denotes the display adapter.
  <code>D3DADAPTER_DEFAULT(0)</code> is always the primary display adapter.</em>
</li></ul><p style='margin-bottom:0'><a href='#index'>Index</a></p></div><span id='other_symbols'></span><div><h2>Other symbols <a href="#other_symbols">#</a></h2>
<pre class='ida'><span class='comment'>.rdata:0079B9F0</span> <span class='ident'>aDDecodercaptur</span> db <span class='str'>'d:\decodercapture%04d.fss'</span>,<span class='num'>0</span>

<span class='comment'>.rdata:007A1344</span> <span class='ident'>a__IndepSrcOnli</span> db <span class='str'>'..\indep\src\online/LobbyCore.cpp'</span>,<span class='num'>0</span>

<span class='comment'>.rdata:007A5BF8</span> <span class='ident'>aHotpositionSHo</span> db <span class='str'>'//'</span>,<span class='num'>0Ah</span>
<span class='comment'>.rdata:007A5BF8</span>                 db <span class='str'>'// HotPosition - %s'</span>,<span class='num'>0Ah</span>
<span class='comment'>.rdata:007A5BF8</span>                 db <span class='str'>'//'</span>,<span class='num'>0Ah</span>
<span class='comment'>.rdata:007A5BF8</span>                 db <span class='str'>'HOTPOSITION: %8.2f,%8.2f,%8.2f  Angle=0x%04x'</span>,<span class='num'>0Ah</span>,<span class='num'>0</span>

<span class='comment'>.rdata:00787568</span> <span class='ident'>aSeeulator</span>      db <span class='str'>'Seeulator'</span>,<span class='num'>0</span>
<span class='comment'>.rdata:00787574</span> <span class='ident'>aJr2server</span>      db <span class='str'>'JR2Server'</span>,<span class='num'>0</span>
</pre><pre><span id='struct_ObjectLink'></span>struct ObjectLink {
        <a href='#struct_ObjectLink'>struct ObjectLink</a> *<span id='structObjectLink_0'></span>next;
        <a href='#struct_ObjectLink'>struct ObjectLink</a> *<span id='structObjectLink_4'></span>prev;
};

<span id='struct_WideCharString'></span>struct WideCharString {
        wchar_t *<span id='structWideCharString_0'></span>ptrString;
        int <span id='structWideCharString_4'></span>allocatedWcharLength; /*amount of wchars that can fit, excluding zero term*/
};

<span id='struct_WorldAnimStuff'></span>struct WorldAnimStuff {
        struct Pool *<span id='structWorldAnimStuff_0'></span>worldAnimEntityPool;
        struct Pool *<span id='structWorldAnimStuff_4'></span>worldAnimEntityTreePool;
        struct Pool *<span id='structWorldAnimStuff_8'></span>worldAnimEntityTreeInfoPool;
        struct Pool *<span id='structWorldAnimStuff_C'></span>worldAnimCtrlPool;
        struct Pool *<span id='structWorldAnimStuff_10'></span>worldAnimInstanceEntryPool;
        char poolsCreated?;
        char field_15;
        char field_16;
        char field_17;
        int field_18;
        int field_1C;
        int field_20;
        int field_24;
        int field_28;
        int field_2C;
        int field_30;
        int field_34;
        int field_38;
        int field_3C;
        int field_40;
        int field_44;
        int field_48;
};
EXPECT_SIZE(struct WorldAnimStuff, 0x4C);
</pre><p><strong>Symbols:</strong></p><ul><li><span class='func' id='4035D0'>4035D0 void LoadAIStuff()</span>
</li><li><span class='func' id='4385B0'>4385B0 void __thiscall WorldAnimStuff::CreatePools?(<a href='#struct_WorldAnimStuff'>struct WorldAnimStuff</a> *this)</span>
</li><li><span class='func' id='439EA0'>439EA0 void __thiscall WorldAnimStuff::ctor(<a href='#struct_WorldAnimStuff'>struct WorldAnimStuff</a> *this)</span>
</li><li><span class='func' id='43DBB0'>43DBB0 int strlenWithNullcheck(char *str)</span>
</li><li><span class='func' id='43DBD0'>43DBD0 int strcpy(char *dest, char *src)</span>
</li><li><span class='func' id='43DC00'>43DC00 void strncpy(char *dst, char *src, int maxlen)</span>
</li><li><span class='func' id='43DC30'>43DC30 int strcmp(char *a, char *b)</span>
</li><li><span class='func' id='43DC60'>43DC60 int strncmp(char *a, char *b, int maxlen)</span>
</li><li><span class='func' id='43DCC0'>43DCC0 int stricmp(char *a, char *b)</span>
</li><li><span class='func' id='43DDA0'>43DDA0 void strcpycat(char *dest, char *src1, char *src2)</span>
  Functionally equivalent to <code>strcpy(dest, src1); strcpy(dest + strlen(src1), src2);</code>.
</li><li><span class='func' id='43E000'>43E000 void *NaiveStrcpyCharToWchar(wchar_t *dest, char *src)</span>
  Uses sign extension. See also <a class='funcref' href='#50D3C0'>50D3C0:LanguageConversionStrcpyCharToWchar()</a> and <a class='funcref' href='#512530'>512530:LanguageAwareStrcpyCharToWchar()</a>.
</li><li><span class='func' id='43E950'>43E950 int FormatWithSinglePlaceholderPtr(char *dst, char *format, void *parameter)</span>
  This does a bunch of things that I don't want to figure out,
  but the the result is that it formats.
</li><li><span class='func' id='43FBC0'>43FBC0 int FormatWithSinglePlaceholderPtrTimed(char *dst, char *format, void *parameter)</span>
  Calls <a class='funcref' href='#43E950'>43E950:FormatWithSinglePlaceholderPtr()</a> but does some stuff with <code>QueryPerformanceCounter</code> before and after,
  I'm assuming it times. Seems to add the time spent to <a class='fieldref' href='#828518'>828518:_TimeSpentInFormatWithSinglePlaceholder</a>, and increments <a class='fieldref' href='#82851C'>82851C:_FormatWithSinglePlaceholderCallCount</a>
  every time this func is called.
</li><li><span class='func' id='5047C0'>5047C0 sub_5047C0</span>
</li><li><span class='func' id='50D510'>50D510 void sub_50D510_DebugPrint(?)</span>
  A nop function.
  It seems like many calls to different functions that got nopped all redirect here.
  Some of the calls are used as a debug print, see <a href='#debugprint'>Debug print</a>.
</li><li><span class='func' id='50DC70'>50DC70 wchar_t *__thiscall FindNewlineW(void *this, wchar_t *str)</span>
  Doesn't actually use <code>this</code>, so can be treated as a <code>__stdcall</code>.
  Returns a ptr to the first occurrence of <code>^</code> or <code>\n</code>, nullptr otherwise.
</li><li><span class='func' id='50DCB0'>50DCB0 wchar_t *__thiscall GetEndOfStringW(void *this, wchar_t *str)</span>
  Doesn't actually use <code>this</code>, so can be treated as a <code>__stdcall</code>.
  Returns a ptr to the zero terminator.
</li><li><span class='func' id='511630'>511630 void strcpyW(wchar_t *dest, wchar_t *src)</span>
  Checks if <code>dest</code> is NULL first.
</li><li><span class='func' id='51DE90'>51DE90 int __thiscall WideCharString::EnsureAllocatedSize(<a href='#struct_WideCharString'>struct WideCharString</a> *this, int length)</span>
  If it's already allocated and long enough, NOP.
  Otherwise allocate new memory, copy existing string, free previous memory.
  Does not actually check the <code><a href='#structWideCharString_4'>allocatedWcharLength</a></code> field, but does a strlen to check if
  the existing string length is less than required.
</li><li><span class='func' id='532670'>532670 struct WideCharString *__thiscall WideCharString::SetFromCharString(<a href='#struct_WideCharString'>struct WideCharString</a> *this, char *str)</span>
  Converts language aware, like <a class='funcref' href='#512530'>512530:LanguageAwareStrcpyCharToWchar()</a> does. Calls <a class='funcref' href='#51DE90'>51DE90:WideCharString::EnsureAllocatedSize()</a>.
  Returns itself.
</li><li><span class='func' id='575620'>575620 void * j_HeapAllocWrapper75C6C8(int bytes)</span>
</li><li><span class='func' id='575630'>575630 void j_HeapFreeWrapper75C6DA(void *mem)</span>
</li><li><span class='func' id='577AB0'>577AB0 sub_577AB0</span>
</li><li><span class='func' id='5B7A70'>5B7A70 void LoadPaths()</span>
  TODO
</li><li><span class='func' id='5CCD60'>5CCD60 LPRESULT MainWndProc(HWND hwnd, UINT uMsg, WPARAM wParam, LPARAM lParam)</span>
</li><li><span class='func' id='741650'>741650 int strncpy_0(char *dest, int maxlen, char *src)</span>
  Returns amount of chars written?
</li><li><span class='func' id='75BCC7'>75BCC7 start</span>
</li><li><span class='func' id='75D45B'>75D45B sub_75D45B()</span>
  Invoked once at boot, does things (todo) and calls all functions in <a class='fieldref' href='#7E8000'>7E8000:someInitFunctions</a>.
</li><li><span class='func' id='75D65B'>75D65B sub_75D65B</span>
</li><li><span class='func' id='75DD6F'>75DD6F sub_75DD6F</span>
</li><li><span class='func' id='77B5E0'>77B5E0 void init_function_77B5E0()</span>
  Calls <a class='funcref' href='#439EA0'>439EA0:WorldAnimStuff::ctor()</a>.
</li><li><span class='func' id='77E580'>77E580 init_function_77E580_MouseData_ctor()</span>
  Calls <a class='funcref' href='#5C8600'>5C8600:MouseData::ctor()</a> to initialize mouse data.
</li><li><span class='field' id='7E8000'>7E8000 void (*someInitFunctions)()[821]</span>
  Array of functions that are called at boot, by <a class='funcref' href='#75D45B'>75D45B:sub_75D45B()</a>.
  Some of them are constructors being called.
</li><li><span class='field' id='7F91C4'>7F91C4 int drawHud</span>
</li><li><span class='field' id='827EF0'>827EF0 <a href='#struct_WorldAnimStuff'>struct WorldAnimStuff</a> worldAnimStuff</span>
  TODO usages and stuff
</li><li><span class='field' id='828518'>828518 int _TimeSpentInFormatWithSinglePlaceholder</span>
  Used in <a class='funcref' href='#43FBC0'>43FBC0:FormatWithSinglePlaceholderPtrTimed()</a>.
</li><li><span class='field' id='82851C'>82851C int _FormatWithSinglePlaceholderCallCount</span>
  Used in <a class='funcref' href='#43FBC0'>43FBC0:FormatWithSinglePlaceholderPtrTimed()</a>.
</li><li><span class='field' id='864F4C'>864F4C int _isGameClosing</span>
</li><li><span class='field' id='8709D8'>8709D8 int _isCTRLKeyDown</span>
  Set in <a class='funcref' href='#5CCD60'>5CCD60:MainWndProc()</a>, but seemingly never read from? REVISIT
</li><li><span class='field' id='8A1CCC'>8A1CCC void *ptrCarData</span>
</li><li><span class='field' id='835BB8'>835BB8 wchar_t loadedProfileName[32]</span>
</li><li><span class='field' id='83A9E0'>83A9E0 char loadedProfileName[32]</span>
</li><li><span class='field' id='850078'>850078 int someOLState</span>
  Related to LAN/OL.
</li><li><span class='field' id='8654A4'>8654A4 int _??gameStateSomething</span>
  3 in menus, 4 5 loading, 6 in race
</li><li><span class='field' id='89E7E6'>89E7E6 char isInPerformanceTuning</span>
</li></ul><p style='margin-bottom:0'><a href='#index'>Index</a></p></div></body>
</html>
